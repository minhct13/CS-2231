{"topic": "<ul class=\"tags\">\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#Neural-nets\">Neural-nets</a>\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#Supervised-learning\">Supervised-learning</a>\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#Regression\">Regression</a>\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#Multi-class\">Multi-class</a>\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#MNIST\">MNIST</a>\n</ul>", "title": "<h1 class=\"post-title\" itemprop=\"name\">Bài 13: Softmax Regression</h1>", "introduction": {"title": "<h2 id=\"1-giới-thiệu\">1. Giới thiệu</h2>", "content": "<p>Tôi xin phép được bắt đầu từ mô hình <a href=\"https://machinelearningcoban.com/2017/02/11/binaryclassifiers/#one-vs-rest-hay-one-hot-coding\"><strong>one-vs-rest</strong></a> được trình bày trong bài trước. Output layer (màu đỏ nhạt) có thể phân tách thành hai <em>sublayer</em> như hình dưới đây:</p><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex9_files/onevsrest.png\" width=\"600\"/>\n<div class=\"thecap\">Hình 1: Multi-class classification với Logistic Regression và one-vs-rest.</div>\n</div><p>Dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-1-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2\"><span class=\"mjx-texatom\" id=\"MJXc-Node-3\"><span class=\"mjx-mrow\" id=\"MJXc-Node-4\"><span class=\"mjx-mi\" id=\"MJXc-Node-5\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-1\" type=\"math/tex\">\\mathbf{x}</script> có số chiều là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-2-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-6\"><span class=\"mjx-mrow\" id=\"MJXc-Node-7\"><span class=\"mjx-mo\" id=\"MJXc-Node-8\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-9\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.003em;\">d</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-10\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-11\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-12\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>d</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-2\" type=\"math/tex\">(d +1)</script> vì có phần tử 1 được thêm vào phía trước, thể hiện hệ số tự do trong hàm tuyến tính. Hệ số tự do <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-3-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-13\"><span class=\"mjx-mrow\" id=\"MJXc-Node-14\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-15\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-16\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">w</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-17\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-18\"><span class=\"mjx-mn\" id=\"MJXc-Node-19\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-20\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>w</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>0</mn><mi>j</mi></mrow></msub></math></span></span><script id=\"MathJax-Element-3\" type=\"math/tex\">w_{0j}</script> còn được gọi là bias.</p><p>Giả sử số classes là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-4-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-21\"><span class=\"mjx-mrow\" id=\"MJXc-Node-22\"><span class=\"mjx-mi\" id=\"MJXc-Node-23\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi></math></span></span><script id=\"MathJax-Element-4\" type=\"math/tex\">C</script>. Với one-vs-rest, chúng ta cần xây dựng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-5-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-24\"><span class=\"mjx-mrow\" id=\"MJXc-Node-25\"><span class=\"mjx-mi\" id=\"MJXc-Node-26\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi></math></span></span><script id=\"MathJax-Element-5\" type=\"math/tex\">C</script> Logistic Regression khác nhau. Các <em>đầu ra dự đoán</em> được tính theo hàm sigmoid:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;sigmoid&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;sigmoid&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-6-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-27\"><span class=\"mjx-mrow\" id=\"MJXc-Node-28\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-29\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-30\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-31\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-32\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mtext MJXc-space3\" id=\"MJXc-Node-33\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">sigmoid</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-34\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-35\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-36\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-37\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-38\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-39\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mtext MJXc-space3\" id=\"MJXc-Node-40\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">sigmoid</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-41\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-42\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-43\"><span class=\"mjx-mrow\" id=\"MJXc-Node-44\"><span class=\"mjx-mi\" id=\"MJXc-Node-45\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-47\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-46\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-48\"><span class=\"mjx-mrow\" id=\"MJXc-Node-49\"><span class=\"mjx-mi\" id=\"MJXc-Node-50\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-51\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mtext>sigmoid</mtext><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>sigmoid</mtext><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>i</mi><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-6\" type=\"math/tex; mode=display\">\na_i = \\text{sigmoid}(z_i) = \\text{sigmoid}(\\mathbf{w}_i^T\\mathbf{x})\n</script>\nTrong kỹ thuật này, các phần tử <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-7-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-52\"><span class=\"mjx-mrow\" id=\"MJXc-Node-53\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-54\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-55\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-56\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-57\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-58\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-59\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-60\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-61\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-62\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-63\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-64\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-65\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-66\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>C</mi></math></span></span><script id=\"MathJax-Element-7\" type=\"math/tex\">a_i, i = 1, 2, \\dots, C</script> được suy ra trực tiếp chỉ với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-8-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-67\"><span class=\"mjx-mrow\" id=\"MJXc-Node-68\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-69\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-70\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-71\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-8\" type=\"math/tex\">z_i</script>. Vì vậy, không có mối quan hệ chặt chẽ nào giữa các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-9-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-72\"><span class=\"mjx-mrow\" id=\"MJXc-Node-73\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-74\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-75\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-76\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-9\" type=\"math/tex\">a_i</script>, tức tổng của chúng có thể nhỏ hơn hoặc lớn hơn 1. Nếu ta có thể khai thác được mỗi quan hệ giữa các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-10-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-77\"><span class=\"mjx-mrow\" id=\"MJXc-Node-78\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-79\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-80\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-81\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-10\" type=\"math/tex\">z_i</script> thì kết quả của bài toán classification có thể tốt hơn.</p><p>Chú ý rằng các mô hình Linear Regression, PLA, Logistic Regression chỉ có 1 node ở output layer. Trong các trường hợp đó, tham số mô hình chỉ là 1 vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-11-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-82\"><span class=\"mjx-mrow\" id=\"MJXc-Node-83\"><span class=\"mjx-texatom\" id=\"MJXc-Node-84\"><span class=\"mjx-mrow\" id=\"MJXc-Node-85\"><span class=\"mjx-mi\" id=\"MJXc-Node-86\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow></math></span></span><script id=\"MathJax-Element-11\" type=\"math/tex\">\\mathbf{w}</script>. Trong trường hợp output layer có nhiều hơn 1 node, tham số mô hình sẽ là tập hợp \ntham số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-12-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-87\"><span class=\"mjx-mrow\" id=\"MJXc-Node-88\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-89\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-90\"><span class=\"mjx-mrow\" id=\"MJXc-Node-91\"><span class=\"mjx-mi\" id=\"MJXc-Node-92\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-93\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-12\" type=\"math/tex\">\\mathbf{w}_i</script> ứng với từng node. Lúc này, ta có <em>ma trận trọng số</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-13-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-94\"><span class=\"mjx-mrow\" id=\"MJXc-Node-95\"><span class=\"mjx-texatom\" id=\"MJXc-Node-96\"><span class=\"mjx-mrow\" id=\"MJXc-Node-97\"><span class=\"mjx-mi\" id=\"MJXc-Node-98\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-99\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-100\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-101\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-102\"><span class=\"mjx-mrow\" id=\"MJXc-Node-103\"><span class=\"mjx-mi\" id=\"MJXc-Node-104\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-105\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-106\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-107\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-108\"><span class=\"mjx-mrow\" id=\"MJXc-Node-109\"><span class=\"mjx-mi\" id=\"MJXc-Node-110\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-111\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-112\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-113\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-114\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-115\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-116\"><span class=\"mjx-mrow\" id=\"MJXc-Node-117\"><span class=\"mjx-mi\" id=\"MJXc-Node-118\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-119\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-120\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>C</mi></msub><mo stretchy=\"false\">]</mo></math></span></span><script id=\"MathJax-Element-13\" type=\"math/tex\">\\mathbf{W} = [\\mathbf{w}_1, \\mathbf{w}_2, \\dots, \\mathbf{w}_C]</script>.</p><p><a name=\"-softmax-function\"></a></p>"}, "formulas": {"title": "<h2 id=\"2-softmax-function\">2. Softmax function</h2>", "content": "<p><a name=\"-cong-thuc-cua-softmax-function\"></a></p><h3 id=\"21-công-thức-của-softmax-function\">2.1. Công thức của Softmax function</h3><p>Chúng ta cần một mô hình xác suất sao cho với mỗi input <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-14-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-121\"><span class=\"mjx-mrow\" id=\"MJXc-Node-122\"><span class=\"mjx-texatom\" id=\"MJXc-Node-123\"><span class=\"mjx-mrow\" id=\"MJXc-Node-124\"><span class=\"mjx-mi\" id=\"MJXc-Node-125\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-14\" type=\"math/tex\">\\mathbf{x}</script>, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-15-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-126\"><span class=\"mjx-mrow\" id=\"MJXc-Node-127\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-128\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-129\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-130\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-15\" type=\"math/tex\">a_i</script> thể hiện xác suất để input đó rơi vào class <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-16-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-131\"><span class=\"mjx-mrow\" id=\"MJXc-Node-132\"><span class=\"mjx-mi\" id=\"MJXc-Node-133\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script id=\"MathJax-Element-16\" type=\"math/tex\">i</script>. Vậy điều kiện cần là các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-17-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-134\"><span class=\"mjx-mrow\" id=\"MJXc-Node-135\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-136\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-137\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-138\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-17\" type=\"math/tex\">a_i</script> phải dương và tổng của chúng bằng 1. Để có thể thỏa mãn điều kiện này, chúng ta cần <em>nhìn vào</em> mọi giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-18-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-139\"><span class=\"mjx-mrow\" id=\"MJXc-Node-140\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-141\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-142\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-143\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-18\" type=\"math/tex\">z_i</script> và dựa trên quan hệ giữa các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-19-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-144\"><span class=\"mjx-mrow\" id=\"MJXc-Node-145\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-146\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-147\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-148\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-19\" type=\"math/tex\">z_i</script> này để tính toán giá trị của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-20-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-149\"><span class=\"mjx-mrow\" id=\"MJXc-Node-150\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-151\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-152\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-153\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-20\" type=\"math/tex\">a_i</script>. Ngoài các điều kiện <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-21-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-154\"><span class=\"mjx-mrow\" id=\"MJXc-Node-155\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-156\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-157\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-158\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-21\" type=\"math/tex\">a_i</script> lớn hơn 0 và có tổng bằng 1, chúng ta sẽ thêm một điều kiện cũng rất tự nhiên nữa, đó là: giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-22-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-159\"><span class=\"mjx-mrow\" id=\"MJXc-Node-160\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-161\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-162\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-163\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-164\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-165\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-166\"><span class=\"mjx-mrow\" id=\"MJXc-Node-167\"><span class=\"mjx-mi\" id=\"MJXc-Node-168\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-170\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-169\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-171\"><span class=\"mjx-mrow\" id=\"MJXc-Node-172\"><span class=\"mjx-mi\" id=\"MJXc-Node-173\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub><mo>=</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>i</mi><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-22\" type=\"math/tex\">z_i = \\mathbf{w}_i^T\\mathbf{x}</script> càng lớn thì xác suất dữ liệu rơi vào class <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-23-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-174\"><span class=\"mjx-mrow\" id=\"MJXc-Node-175\"><span class=\"mjx-mi\" id=\"MJXc-Node-176\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script id=\"MathJax-Element-23\" type=\"math/tex\">i</script> càng cao. Điều kiện cuối này chỉ ra rằng chúng ta cần một hàm đồng biến ở đây.</p><p>Chú ý rằng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-24-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-177\"><span class=\"mjx-mrow\" id=\"MJXc-Node-178\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-179\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-180\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-181\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-24\" type=\"math/tex\">z_i </script> có thể nhận giá trị cả âm và dương. Một hàm số <em>mượt</em> đơn giản có thể chắc chắn biến  <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-25-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-182\"><span class=\"mjx-mrow\" id=\"MJXc-Node-183\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-184\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-185\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-186\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-25\" type=\"math/tex\">z_i </script> thành một giá trị dương, và hơn nữa, đồng biến, là hàm <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-26-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-187\"><span class=\"mjx-mrow\" id=\"MJXc-Node-188\"><span class=\"mjx-mi\" id=\"MJXc-Node-189\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-190\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-191\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-192\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-193\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-194\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-195\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-196\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-197\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-198\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-199\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-200\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-201\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-202\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-203\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>z</mi><mi>i</mi></msub></mrow></msup></math></span></span><script id=\"MathJax-Element-26\" type=\"math/tex\">\\exp(z_i) = e^{z_i}</script>. Điều kiện <em>mượt</em> để thuận lợi hơn trong việc tính đạo hàm sau này. Điều kiện cuối cùng, tổng các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-27-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-204\"><span class=\"mjx-mrow\" id=\"MJXc-Node-205\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-206\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-207\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-208\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-27\" type=\"math/tex\">a_i</script> bằng 1 có thể được đảm bảo nếu:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-28-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-209\"><span class=\"mjx-mrow\" id=\"MJXc-Node-210\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-211\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-212\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-213\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-214\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mfrac MJXc-space3\" id=\"MJXc-Node-215\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 5.751em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 5.751em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-216\"><span class=\"mjx-mi\" id=\"MJXc-Node-217\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-218\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-219\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-220\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-221\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-222\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-223\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 5.751em; bottom: -1.467em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-224\"><span class=\"mjx-munderover\" id=\"MJXc-Node-225\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-226\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.411em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-232\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-227\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-228\"><span class=\"mjx-mi\" id=\"MJXc-Node-229\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-230\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-231\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-233\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-234\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-235\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-236\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-237\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-238\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-239\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 5.751em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.994em; vertical-align: -1.467em;\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-240\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mtext MJXc-space1\" id=\"MJXc-Node-241\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-242\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mi\" id=\"MJXc-Node-243\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">∀</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-244\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-245\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-246\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-247\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-248\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-249\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-250\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-251\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-252\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>,</mo><mtext> </mtext><mtext> </mtext><mi mathvariant=\"normal\">∀</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>C</mi></math></span></span></span><script id=\"MathJax-Element-28\" type=\"math/tex; mode=display\">\na_i = \\frac{\\exp(z_i)}{\\sum_{j=1}^C \\exp(z_j)}, ~~ \\forall i = 1, 2, \\dots, C\n</script></p><p>Hàm số này, tính tất cả các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-29-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-253\"><span class=\"mjx-mrow\" id=\"MJXc-Node-254\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-255\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-256\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-257\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-29\" type=\"math/tex\">a_i</script> dựa vào tất cả các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-30-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-258\"><span class=\"mjx-mrow\" id=\"MJXc-Node-259\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-260\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-261\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-262\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-30\" type=\"math/tex\">z_i</script>, thõa mãn tất cả các điều kiện đã xét: dương, tổng bằng 1, giữ được <em>thứ tự</em> của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-31-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-263\"><span class=\"mjx-mrow\" id=\"MJXc-Node-264\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-265\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-266\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-267\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-31\" type=\"math/tex\">z_i</script>. Hàm số này được gọi là <em>softmax function</em>. Chú ý rằng với cách định nghĩa này, không có xác suất <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-32-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-268\"><span class=\"mjx-mrow\" id=\"MJXc-Node-269\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-270\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-271\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-272\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-32\" type=\"math/tex\">a_i</script> nào tuyệt đối bằng 0 hoặc tuyệt đối bằng 1, mặc dù chúng có thể rất gần 0 hoặc 1 khi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-33-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-273\"><span class=\"mjx-mrow\" id=\"MJXc-Node-274\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-275\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-276\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-277\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-33\" type=\"math/tex\">z_i</script> rất nhỏ hoặc rất lớn khi so sánh với các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-34-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-278\"><span class=\"mjx-mrow\" id=\"MJXc-Node-279\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-280\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-281\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-282\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-283\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-284\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-285\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-286\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>j</mi></msub><mo>,</mo><mi>j</mi><mo>≠</mo><mi>i</mi></math></span></span><script id=\"MathJax-Element-34\" type=\"math/tex\">z_j, j \\neq i</script>.</p><p>Lúc này, ta có thể giả sử rằng:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-35-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-287\"><span class=\"mjx-mrow\" id=\"MJXc-Node-288\"><span class=\"mjx-mi\" id=\"MJXc-Node-289\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.109em;\">P</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-290\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-291\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-292\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-293\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-294\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-295\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-296\"><span class=\"mjx-mrow\" id=\"MJXc-Node-297\"><span class=\"mjx-mo\" id=\"MJXc-Node-298\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-299\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-300\"><span class=\"mjx-mrow\" id=\"MJXc-Node-301\"><span class=\"mjx-mi\" id=\"MJXc-Node-302\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.219em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-303\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-304\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-305\"><span class=\"mjx-mrow\" id=\"MJXc-Node-306\"><span class=\"mjx-mi\" id=\"MJXc-Node-307\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-308\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-309\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-310\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-311\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-312\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mi>i</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>k</mi></msub><mo>;</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span></span><script id=\"MathJax-Element-35\" type=\"math/tex; mode=display\">\nP(y_k = i | \\mathbf{x}_k; \\mathbf{W}) = a_i\n</script></p><p>Trong đó, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-36-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-313\"><span class=\"mjx-mrow\" id=\"MJXc-Node-314\"><span class=\"mjx-mi\" id=\"MJXc-Node-315\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.109em;\">P</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-316\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-317\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-318\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-319\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-320\"><span class=\"mjx-mrow\" id=\"MJXc-Node-321\"><span class=\"mjx-mo\" id=\"MJXc-Node-322\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-323\"><span class=\"mjx-mrow\" id=\"MJXc-Node-324\"><span class=\"mjx-mi\" id=\"MJXc-Node-325\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-326\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-327\"><span class=\"mjx-mrow\" id=\"MJXc-Node-328\"><span class=\"mjx-mi\" id=\"MJXc-Node-329\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-330\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>P</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo>=</mo><mi>i</mi><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo>;</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-36\" type=\"math/tex\">P(y = i | \\mathbf{x}; \\mathbf{W})</script> được hiểu là xác suất để một điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-37-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-331\"><span class=\"mjx-mrow\" id=\"MJXc-Node-332\"><span class=\"mjx-texatom\" id=\"MJXc-Node-333\"><span class=\"mjx-mrow\" id=\"MJXc-Node-334\"><span class=\"mjx-mi\" id=\"MJXc-Node-335\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-37\" type=\"math/tex\">\\mathbf{x}</script> rơi vào class thứ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-38-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-336\"><span class=\"mjx-mrow\" id=\"MJXc-Node-337\"><span class=\"mjx-mi\" id=\"MJXc-Node-338\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script id=\"MathJax-Element-38\" type=\"math/tex\">i</script> nếu biết tham số mô hình (ma trận trọng số) là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-39-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-339\"><span class=\"mjx-mrow\" id=\"MJXc-Node-340\"><span class=\"mjx-texatom\" id=\"MJXc-Node-341\"><span class=\"mjx-mrow\" id=\"MJXc-Node-342\"><span class=\"mjx-mi\" id=\"MJXc-Node-343\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-39\" type=\"math/tex\">\\mathbf{W}</script>.</p><p>Hình vẽ dưới đây thể hiện mạng Softmax Regression dưới dạng neural network:</p><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex9_files/softmax_nn.png\" width=\"800\"/>\n<div class=\"thecap\">Hình 2: Mô hình Softmax Regression dưới dạng Neural network.</div>\n</div><p>Ở phần bên phải, hàm tuyến tính <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x03A3;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-40-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-344\"><span class=\"mjx-mrow\" id=\"MJXc-Node-345\"><span class=\"mjx-mi\" id=\"MJXc-Node-346\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">Σ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Σ</mi></math></span></span><script id=\"MathJax-Element-40\" type=\"math/tex\">\\Sigma</script> và hàm softmax (activation function) được tách riêng ra để phục vụ cho mục đích minh họa. Dạng <em>short form</em> ở bên phải là dạng hay được sử dụng trong các Neural Networks, lớp <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-41-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-347\"><span class=\"mjx-mrow\" id=\"MJXc-Node-348\"><span class=\"mjx-texatom\" id=\"MJXc-Node-349\"><span class=\"mjx-mrow\" id=\"MJXc-Node-350\"><span class=\"mjx-mi\" id=\"MJXc-Node-351\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow></math></span></span><script id=\"MathJax-Element-41\" type=\"math/tex\">\\mathbf{a}</script> được ngầm hiểu là bao gồm cả lớp <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-42-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-352\"><span class=\"mjx-mrow\" id=\"MJXc-Node-353\"><span class=\"mjx-texatom\" id=\"MJXc-Node-354\"><span class=\"mjx-mrow\" id=\"MJXc-Node-355\"><span class=\"mjx-mi\" id=\"MJXc-Node-356\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script id=\"MathJax-Element-42\" type=\"math/tex\">\\mathbf{z}</script>.</p><p><a name=\"-softmax-function-trong-python\"></a></p><h3 id=\"22-softmax-function-trong-python\">2.2. Softmax function trong Python</h3><p>Dưới đây là một đoạn code viết hàm softmax. Đầu vào là một ma trận với mỗi cột là một vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-43-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-357\"><span class=\"mjx-mrow\" id=\"MJXc-Node-358\"><span class=\"mjx-texatom\" id=\"MJXc-Node-359\"><span class=\"mjx-mrow\" id=\"MJXc-Node-360\"><span class=\"mjx-mi\" id=\"MJXc-Node-361\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script id=\"MathJax-Element-43\" type=\"math/tex\">\\mathbf{z}</script>, đầu ra cũng là một ma trận mà mỗi cột có giá trị là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-44-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-362\"><span class=\"mjx-mrow\" id=\"MJXc-Node-363\"><span class=\"mjx-texatom\" id=\"MJXc-Node-364\"><span class=\"mjx-mrow\" id=\"MJXc-Node-365\"><span class=\"mjx-mi\" id=\"MJXc-Node-366\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-367\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mtext MJXc-space3\" id=\"MJXc-Node-368\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">softmax</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-369\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-370\"><span class=\"mjx-mrow\" id=\"MJXc-Node-371\"><span class=\"mjx-mi\" id=\"MJXc-Node-372\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-373\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow><mo>=</mo><mtext>softmax</mtext><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-44\" type=\"math/tex\">\\mathbf{a} = \\text{softmax}(\\mathbf{z})</script>. Các giá trị của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-45-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-374\"><span class=\"mjx-mrow\" id=\"MJXc-Node-375\"><span class=\"mjx-texatom\" id=\"MJXc-Node-376\"><span class=\"mjx-mrow\" id=\"MJXc-Node-377\"><span class=\"mjx-mi\" id=\"MJXc-Node-378\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script id=\"MathJax-Element-45\" type=\"math/tex\">\\mathbf{z}</script> còn được gọi là <strong>scores</strong>.</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span> \n\n<span class=\"k\">def</span> <span class=\"nf\">softmax</span><span class=\"p\">(</span><span class=\"n\">Z</span><span class=\"p\">):</span>\n    <span class=\"s\">\"\"\"\n    Compute softmax values for each sets of scores in V.\n    each column of V is a set of score.    \n    \"\"\"</span>\n    <span class=\"n\">e_Z</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">exp</span><span class=\"p\">(</span><span class=\"n\">Z</span><span class=\"p\">)</span>\n    <span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"n\">e_Z</span> <span class=\"o\">/</span> <span class=\"n\">e_Z</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">A</span>\n</code></pre></div></div><p><a name=\"-mot-vai-vi-du\"></a></p><h3 id=\"23-một-vài-ví-dụ\">2.3. Một vài ví dụ</h3><p>Hình 3 dưới đây là một vài ví dụ về mối quan hệ giữa đầu vào và đầu ra của hàm softmax. Hàng trên màu xanh nhạt thể hiện các scores <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-46-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-379\"><span class=\"mjx-mrow\" id=\"MJXc-Node-380\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-381\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-382\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-383\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-46\" type=\"math/tex\">z_i</script> với giả sử rằng số classes là 3. Hàng dưới màu đỏ nhạt thể hiện các giá trị đầu ra <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-47-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-384\"><span class=\"mjx-mrow\" id=\"MJXc-Node-385\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-386\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-387\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-388\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-47\" type=\"math/tex\">a_i</script> của hàm softmax.</p><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex9_files/softmax_ex.png\" width=\"600\"/>\n<div class=\"thecap\">Hình 3: Một số ví dụ về đầu vào và đầu ra của hàm softmax.</div>\n</div><p>Có một vài quan sát như sau:</p><ul>\n<li>\n<p>Cột 1: Nếu các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-48-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-389\"><span class=\"mjx-mrow\" id=\"MJXc-Node-390\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-391\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-392\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-393\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-48\" type=\"math/tex\">z_i</script> bằng nhau, thì các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-49-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-394\"><span class=\"mjx-mrow\" id=\"MJXc-Node-395\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-396\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-397\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-398\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-49\" type=\"math/tex\">a_i</script> cũng bằng nhau và bằng 1/3.</p>\n</li>\n<li>\n<p>Cột 2: Nếu giá trị lớn nhất trong các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-50-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-399\"><span class=\"mjx-mrow\" id=\"MJXc-Node-400\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-401\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-402\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-403\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-50\" type=\"math/tex\">z_i</script> là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-51-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-404\"><span class=\"mjx-mrow\" id=\"MJXc-Node-405\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-406\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-407\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-408\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-51\" type=\"math/tex\">z_1</script> vẫn bằng 2, nhưng các giá trị khác thay đổi, thì mặc dù xác suất tương ứng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-52-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-409\"><span class=\"mjx-mrow\" id=\"MJXc-Node-410\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-411\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-412\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-413\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-52\" type=\"math/tex\">a_1</script> vẫn là lớn nhất, nhưng nó đã thay đổi lên hơn 0.5. Đây chính là một lý do mà tên của hàm này có từ <em>soft</em>. (<em>max</em> vì phẩn từ lớn nhất vẫn là phần tử lớn nhất).</p>\n</li>\n<li>\n<p>Cột 3: Khi các giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-53-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-414\"><span class=\"mjx-mrow\" id=\"MJXc-Node-415\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-416\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-417\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-418\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-53\" type=\"math/tex\">z_i</script> là âm thì các giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-54-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-419\"><span class=\"mjx-mrow\" id=\"MJXc-Node-420\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-421\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-422\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-423\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-54\" type=\"math/tex\">a_i</script> vẫn là dương và thứ tự vẫn được đảm bảo.</p>\n</li>\n<li>\n<p>Cột 4: Nếu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-55-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-424\"><span class=\"mjx-mrow\" id=\"MJXc-Node-425\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-426\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-427\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-428\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-429\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-430\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-431\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-432\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mn>1</mn></msub><mo>=</mo><msub><mi>z</mi><mn>2</mn></msub></math></span></span><script id=\"MathJax-Element-55\" type=\"math/tex\">z_1 = z_2</script>, thì <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-56-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-433\"><span class=\"mjx-mrow\" id=\"MJXc-Node-434\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-435\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-436\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-437\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-438\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-439\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-440\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-441\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>2</mn></msub></math></span></span><script id=\"MathJax-Element-56\" type=\"math/tex\">a_1 = a_2</script>.</p>\n</li>\n</ul><p>Bạn đọc có thể thử với các giá trị khác trực tiếp trên trình duyệt trong <a href=\"http://neuralnetworksanddeeplearning.com/chap3.html\">link này</a>, kéo xuống phần Softmax.</p><p><a name=\"-phien-ban-on-dinh-hon-cua-softmax-function\"></a></p><h3 id=\"24-phiên-bản-ổn-định-hơn-của-softmax-function\">2.4. Phiên bản ổn định hơn của softmax function</h3><p>Khi một trong các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-57-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-442\"><span class=\"mjx-mrow\" id=\"MJXc-Node-443\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-444\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-445\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-446\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-57\" type=\"math/tex\">z_i</script> quá lớn, việc tính toán <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-58-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-447\"><span class=\"mjx-mrow\" id=\"MJXc-Node-448\"><span class=\"mjx-mi\" id=\"MJXc-Node-449\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-450\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-451\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-452\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-453\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-454\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-455\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-58\" type=\"math/tex\">\\exp(z_i)</script> có thể gây ra hiện tượng tràn số (overflow), ảnh hưởng lớn tới kết quả của hàm softmax. Có một cách khắc phục hiện tượng này bằng cách dựa trên quan sát sau:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtable columnalign=\"right center left\" rowspacing=\"3pt\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;' id=\"MathJax-Element-59-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-456\"><span class=\"mjx-mrow\" id=\"MJXc-Node-457\"><span class=\"mjx-mtable\" id=\"MJXc-Node-458\" style=\"vertical-align: -2.894em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-459\" style=\"height: 3.144em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-460\" style=\"padding: 0px; text-align: right; width: 5.991em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-461\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-462\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 5.751em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 5.751em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-463\"><span class=\"mjx-mi\" id=\"MJXc-Node-464\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-465\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-466\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-467\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-468\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-469\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-470\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 5.751em; bottom: -1.467em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-471\"><span class=\"mjx-munderover\" id=\"MJXc-Node-472\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-473\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.411em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-479\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-474\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-475\"><span class=\"mjx-mi\" id=\"MJXc-Node-476\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-477\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-478\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-480\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-481\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-482\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-483\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-484\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-485\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-486\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 5.751em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.994em; vertical-align: -1.467em;\"></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-487\" style=\"padding: 0px 0.139em 0px 0px; width: 1.056em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-488\" style=\"margin-top: 0.527em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-489\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-490\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-491\" style=\"padding: 0px 0px 0px 0.139em; text-align: left; width: 9.674em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-492\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-493\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 9.434em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 9.434em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-494\"><span class=\"mjx-mi\" id=\"MJXc-Node-495\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-496\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-497\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-498\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-499\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">c</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-500\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-501\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-502\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-503\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-504\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-505\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-506\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-507\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 9.434em; bottom: -1.467em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-508\"><span class=\"mjx-mi\" id=\"MJXc-Node-509\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-510\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-511\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-512\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-513\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">c</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-514\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-515\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-516\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.411em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-522\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-517\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-518\"><span class=\"mjx-mi\" id=\"MJXc-Node-519\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-520\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-521\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-523\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-524\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-525\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-526\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-527\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-528\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-529\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 9.434em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.994em; vertical-align: -1.467em;\"></span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-530\" style=\"height: 3.144em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-531\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-532\" style=\"margin-top: 0.527em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-533\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-534\" style=\"margin-top: 0.527em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-535\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-536\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-537\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-538\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-539\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 7.406em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 7.406em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-540\"><span class=\"mjx-mi\" id=\"MJXc-Node-541\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-542\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-543\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-544\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-545\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-546\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-547\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-548\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">c</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-549\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 7.406em; bottom: -1.467em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-550\"><span class=\"mjx-munderover\" id=\"MJXc-Node-551\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-552\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.411em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-558\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-553\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-554\"><span class=\"mjx-mi\" id=\"MJXc-Node-555\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-556\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-557\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-559\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-560\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-561\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-562\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-563\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-564\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-565\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-566\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">c</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-567\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 7.406em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.994em; vertical-align: -1.467em;\"></span></span><span class=\"mjx-strut\"></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtable columnalign=\"right center left\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\" rowspacing=\"3pt\"><mtr><mtd><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mi>c</mi><mo stretchy=\"false\">)</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>i</mi></msub><mo>−</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo>−</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mtd></mtr></mtable></math></span></span></span><script id=\"MathJax-Element-59\" type=\"math/tex; mode=display\">\n\\begin{eqnarray}\n\\frac{\\exp(z_i)}{\\sum_{j=1}^C \\exp(z_j)} &=& \\frac{\\exp(-c)\\exp(z_i)}{\\exp(-c)\\sum_{j=1}^C \\exp(z_j)}\\newline\n&=& \\frac{\\exp(z_i-c)}{\\sum_{j=1}^C \\exp(z_j-c)}\n\\end{eqnarray}\n</script>\nvới <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-60-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-568\"><span class=\"mjx-mrow\" id=\"MJXc-Node-569\"><span class=\"mjx-mi\" id=\"MJXc-Node-570\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">c</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi></math></span></span><script id=\"MathJax-Element-60\" type=\"math/tex\">c</script> là một hằng số bất kỳ.</p><p>Vậy một phương pháp đơn giản giúp khắc phục hiện tượng overflow là trừ tất cả các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-61-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-571\"><span class=\"mjx-mrow\" id=\"MJXc-Node-572\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-573\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-574\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-575\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-61\" type=\"math/tex\">z_i</script> đi một giá trị đủ lớn. Trong thực nghiệm, giá trị đủ lớn này thường được chọn là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-62-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-576\"><span class=\"mjx-mrow\" id=\"MJXc-Node-577\"><span class=\"mjx-mi\" id=\"MJXc-Node-578\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">c</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-579\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-munderover MJXc-space3\" id=\"MJXc-Node-580\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-581\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-582\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-583\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-584\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-585\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>c</mi><mo>=</mo><munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mi>i</mi></munder><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-62\" type=\"math/tex\">c = \\max_i z_i</script>. Vậy chúng ta có thể sửa đoạn code cho hàm <code class=\"language-plaintext highlighter-rouge\">softmax</code> phía trên bằng cách trừ mỗi cột của ma trận đầu vào <code class=\"language-plaintext highlighter-rouge\">Z</code> đi giá trị lớn nhất trong cột đó. Ta có phiên bản ổn định hơn là <code class=\"language-plaintext highlighter-rouge\">softmax_stable</code>:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">softmax_stable</span><span class=\"p\">(</span><span class=\"n\">Z</span><span class=\"p\">):</span>\n    <span class=\"s\">\"\"\"\n    Compute softmax values for each sets of scores in Z.\n    each column of Z is a set of score.    \n    \"\"\"</span>\n    <span class=\"n\">e_Z</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">exp</span><span class=\"p\">(</span><span class=\"n\">Z</span> <span class=\"o\">-</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">Z</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">keepdims</span> <span class=\"o\">=</span> <span class=\"bp\">True</span><span class=\"p\">))</span>\n    <span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"n\">e_Z</span> <span class=\"o\">/</span> <span class=\"n\">e_Z</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">A</span>\n</code></pre></div></div><p>trong đó <code class=\"language-plaintext highlighter-rouge\">axis = 0</code> nghĩa là lấy <code class=\"language-plaintext highlighter-rouge\">max</code> theo cột (<code class=\"language-plaintext highlighter-rouge\">axis = 1</code> sẽ lấy max theo hàng), <code class=\"language-plaintext highlighter-rouge\">keepdims = True</code> để đảm bảo phép trừ giữa ma trận <code class=\"language-plaintext highlighter-rouge\">Z</code> và vector  thực hiện được.</p><p><a name=\"-ham-mat-mat-va-phuong-phap-toi-uu\"></a></p><p><a name=\"-one-hot-coding\"></a></p><h3 id=\"31-one-hot-coding\">3.1. One hot coding</h3><p>Với cách biểu diễn network như trên, mỗi output sẽ không còn là một giá trị tương ứng với mỗi class nữa mà sẽ là một vector có đúng 1 phần tử bằng 1, các phần tử còn lại bằng 0. Phần tử bằng 1 năm ở vị trí tương ứng với class đó, thể hiện rằng điểm dữ liệu đang xét rơi vào class này với xác suất bằng 1 (<em>sự thật</em> là như thế, không cần dự đoán). Cách <em>mã hóa</em> output này chính là <em>one-hot coding</em> mà tôi đã đề cập trong bài <a href=\"https://machinelearningcoban.com/2017/01/01/kmeans/\">K-means clustering</a> và <a href=\"https://machinelearningcoban.com/2017/02/11/binaryclassifiers/#one-vs-rest-hay-one-hot-coding\">bài trước</a>.</p><p>Khi sử dụng mô hình Softmax Regression, với mỗi đầu vào <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-63-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-586\"><span class=\"mjx-mrow\" id=\"MJXc-Node-587\"><span class=\"mjx-texatom\" id=\"MJXc-Node-588\"><span class=\"mjx-mrow\" id=\"MJXc-Node-589\"><span class=\"mjx-mi\" id=\"MJXc-Node-590\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-63\" type=\"math/tex\">\\mathbf{x}</script>, ta sẽ có <em>đầu ra dự đoán</em> là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;softmax&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-64-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-591\"><span class=\"mjx-mrow\" id=\"MJXc-Node-592\"><span class=\"mjx-texatom\" id=\"MJXc-Node-593\"><span class=\"mjx-mrow\" id=\"MJXc-Node-594\"><span class=\"mjx-mi\" id=\"MJXc-Node-595\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-596\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mtext MJXc-space3\" id=\"MJXc-Node-597\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">softmax</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-598\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-599\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-600\"><span class=\"mjx-mrow\" id=\"MJXc-Node-601\"><span class=\"mjx-mi\" id=\"MJXc-Node-602\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.619em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-603\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-604\"><span class=\"mjx-mrow\" id=\"MJXc-Node-605\"><span class=\"mjx-mi\" id=\"MJXc-Node-606\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-607\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow><mo>=</mo><mtext>softmax</mtext><mo stretchy=\"false\">(</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-64\" type=\"math/tex\">\\mathbf{a} = \\text{softmax}(\\mathbf{W}^T\\mathbf{x})</script>. Trong khi đó, <em>đầu ra thực sự</em> chúng ta có là vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-65-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-608\"><span class=\"mjx-mrow\" id=\"MJXc-Node-609\"><span class=\"mjx-texatom\" id=\"MJXc-Node-610\"><span class=\"mjx-mrow\" id=\"MJXc-Node-611\"><span class=\"mjx-mi\" id=\"MJXc-Node-612\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow></math></span></span><script id=\"MathJax-Element-65\" type=\"math/tex\">\\mathbf{y}</script> được biểu diễn dưới dạng one-hot coding.</p><p>Hàm mất mát sẽ được xây dựng để tối thiểu sự khác nhau giữa <em>đầu ra dự đoán</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-66-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-613\"><span class=\"mjx-mrow\" id=\"MJXc-Node-614\"><span class=\"mjx-texatom\" id=\"MJXc-Node-615\"><span class=\"mjx-mrow\" id=\"MJXc-Node-616\"><span class=\"mjx-mi\" id=\"MJXc-Node-617\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow></math></span></span><script id=\"MathJax-Element-66\" type=\"math/tex\">\\mathbf{a}</script> và <em>đầu ra thực sự</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-67-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-618\"><span class=\"mjx-mrow\" id=\"MJXc-Node-619\"><span class=\"mjx-texatom\" id=\"MJXc-Node-620\"><span class=\"mjx-mrow\" id=\"MJXc-Node-621\"><span class=\"mjx-mi\" id=\"MJXc-Node-622\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow></math></span></span><script id=\"MathJax-Element-67\" type=\"math/tex\">\\mathbf{y}</script>. Một lựa chọn đầu tiên ta có thể nghĩ tới là:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/math&gt;' id=\"MathJax-Element-68-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-623\"><span class=\"mjx-mrow\" id=\"MJXc-Node-624\"><span class=\"mjx-mi\" id=\"MJXc-Node-625\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-626\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-627\"><span class=\"mjx-mrow\" id=\"MJXc-Node-628\"><span class=\"mjx-mi\" id=\"MJXc-Node-629\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-630\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-631\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-munderover MJXc-space3\" id=\"MJXc-Node-632\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-639\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-633\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-634\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-635\"><span class=\"mjx-mi\" id=\"MJXc-Node-636\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-637\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-638\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-640\"><span class=\"mjx-mrow\" id=\"MJXc-Node-641\"><span class=\"mjx-mo\" id=\"MJXc-Node-642\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-643\"><span class=\"mjx-mrow\" id=\"MJXc-Node-644\"><span class=\"mjx-mo\" id=\"MJXc-Node-645\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-646\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-647\"><span class=\"mjx-mrow\" id=\"MJXc-Node-648\"><span class=\"mjx-mi\" id=\"MJXc-Node-649\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-650\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-651\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-652\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-653\"><span class=\"mjx-mrow\" id=\"MJXc-Node-654\"><span class=\"mjx-mi\" id=\"MJXc-Node-655\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-656\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-657\"><span class=\"mjx-mrow\" id=\"MJXc-Node-658\"><span class=\"mjx-mo\" id=\"MJXc-Node-659\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-660\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-661\"><span class=\"mjx-mrow\" id=\"MJXc-Node-662\"><span class=\"mjx-mo\" id=\"MJXc-Node-663\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.309em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.431em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-665\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-664\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow><mi>i</mi></msub><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mn>2</mn><mn>2</mn></msubsup></math></span></span></span><script id=\"MathJax-Element-68\" type=\"math/tex; mode=display\">\nJ(\\mathbf{W}) = \\sum_{i=1}^N ||\\mathbf{a}_i - \\mathbf{y}_i||_2^2\n</script>\n<strong>Tuy nhiên đây chưa phải là một lựa chọn tốt</strong>. Khi đánh giá sự khác nhau (hay khoảng cách) giữa hai phân bố xác suất (probability distributions), chúng ta có một đại lượng đo đếm khác hiệu quả hơn. Đại lượng đó có tên là <a href=\"https://en.wikipedia.org/wiki/Cross_entropy\"><strong>cross entropy</strong></a>.</p><p><a name=\"-cross-entropy\"></a></p><h3 id=\"32-cross-entropy\">3.2. Cross Entropy</h3><p>Cross entropy giữa hai phân phối <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-69-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-666\"><span class=\"mjx-mrow\" id=\"MJXc-Node-667\"><span class=\"mjx-texatom\" id=\"MJXc-Node-668\"><span class=\"mjx-mrow\" id=\"MJXc-Node-669\"><span class=\"mjx-mi\" id=\"MJXc-Node-670\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow></math></span></span><script id=\"MathJax-Element-69\" type=\"math/tex\">\\mathbf{p}</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-70-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-671\"><span class=\"mjx-mrow\" id=\"MJXc-Node-672\"><span class=\"mjx-texatom\" id=\"MJXc-Node-673\"><span class=\"mjx-mrow\" id=\"MJXc-Node-674\"><span class=\"mjx-mi\" id=\"MJXc-Node-675\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow></math></span></span><script id=\"MathJax-Element-70\" type=\"math/tex\">\\mathbf{q}</script> được định nghĩa là:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi mathvariant=\"bold\"&gt;E&lt;/mi&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-71-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-676\"><span class=\"mjx-mrow\" id=\"MJXc-Node-677\"><span class=\"mjx-mi\" id=\"MJXc-Node-678\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.057em;\">H</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-679\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-680\"><span class=\"mjx-mrow\" id=\"MJXc-Node-681\"><span class=\"mjx-mi\" id=\"MJXc-Node-682\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-683\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-684\"><span class=\"mjx-mrow\" id=\"MJXc-Node-685\"><span class=\"mjx-mi\" id=\"MJXc-Node-686\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-687\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-688\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-texatom MJXc-space3\" id=\"MJXc-Node-689\"><span class=\"mjx-mrow\" id=\"MJXc-Node-690\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-691\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-692\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">E</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-693\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-694\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-695\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-696\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-697\"><span class=\"mjx-char\"></span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-698\"><span class=\"mjx-mrow\" id=\"MJXc-Node-699\"><span class=\"mjx-mi\" id=\"MJXc-Node-700\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-701\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi mathvariant=\"bold\">E</mi><mi mathvariant=\"bold\">p</mi></msub></mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo stretchy=\"false\">]</mo></math></span></span></span><script id=\"MathJax-Element-71\" type=\"math/tex; mode=display\">\nH(\\mathbf{p}, \\mathbf{q}) = \\mathbf{E_p}[-\\log \\mathbf{q}]\n</script></p><p>Với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-72-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-702\"><span class=\"mjx-mrow\" id=\"MJXc-Node-703\"><span class=\"mjx-texatom\" id=\"MJXc-Node-704\"><span class=\"mjx-mrow\" id=\"MJXc-Node-705\"><span class=\"mjx-mi\" id=\"MJXc-Node-706\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow></math></span></span><script id=\"MathJax-Element-72\" type=\"math/tex\">\\mathbf{p}</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-73-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-707\"><span class=\"mjx-mrow\" id=\"MJXc-Node-708\"><span class=\"mjx-texatom\" id=\"MJXc-Node-709\"><span class=\"mjx-mrow\" id=\"MJXc-Node-710\"><span class=\"mjx-mi\" id=\"MJXc-Node-711\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow></math></span></span><script id=\"MathJax-Element-73\" type=\"math/tex\">\\mathbf{q}</script> là rời rạc (như <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-74-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-712\"><span class=\"mjx-mrow\" id=\"MJXc-Node-713\"><span class=\"mjx-texatom\" id=\"MJXc-Node-714\"><span class=\"mjx-mrow\" id=\"MJXc-Node-715\"><span class=\"mjx-mi\" id=\"MJXc-Node-716\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow></math></span></span><script id=\"MathJax-Element-74\" type=\"math/tex\">\\mathbf{y}</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-75-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-717\"><span class=\"mjx-mrow\" id=\"MJXc-Node-718\"><span class=\"mjx-texatom\" id=\"MJXc-Node-719\"><span class=\"mjx-mrow\" id=\"MJXc-Node-720\"><span class=\"mjx-mi\" id=\"MJXc-Node-721\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow></math></span></span><script id=\"MathJax-Element-75\" type=\"math/tex\">\\mathbf{a}</script> trong bài toán của chúng ta), công thức này được viết dưới dạng:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-76-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-722\"><span class=\"mjx-mrow\" id=\"MJXc-Node-723\"><span class=\"mjx-mi\" id=\"MJXc-Node-724\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.057em;\">H</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-725\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-726\"><span class=\"mjx-mrow\" id=\"MJXc-Node-727\"><span class=\"mjx-mi\" id=\"MJXc-Node-728\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-729\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-730\"><span class=\"mjx-mrow\" id=\"MJXc-Node-731\"><span class=\"mjx-mi\" id=\"MJXc-Node-732\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-733\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-734\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-735\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-736\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-743\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-737\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-738\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-739\"><span class=\"mjx-mi\" id=\"MJXc-Node-740\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-741\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-742\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-744\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-745\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em;\">p</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-746\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-747\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-748\"><span class=\"mjx-char\"></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-749\"><span class=\"mjx-base\" style=\"margin-right: -0.014em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-750\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.014em;\">q</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-751\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-752\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-753\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-754\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-755\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-756\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-757\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>p</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>q</mi><mi>i</mi></msub><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-76\" type=\"math/tex; mode=display\">\nH(\\mathbf{p}, \\mathbf{q}) =-\\sum_{i=1}^C p_i \\log q_i ~~~ (1)\n</script></p><p>Để hiểu rõ hơn ưu điểm của hàm cross entropy và hàm bình phương khoảng cách thông thường, chúng ta cùng xem Hình 4 dưới đây. Đây là ví dụ trong trường hợp <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-77-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-758\"><span class=\"mjx-mrow\" id=\"MJXc-Node-759\"><span class=\"mjx-mi\" id=\"MJXc-Node-760\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-761\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-762\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo>=</mo><mn>2</mn></math></span></span><script id=\"MathJax-Element-77\" type=\"math/tex\">C = 2</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-78-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-763\"><span class=\"mjx-mrow\" id=\"MJXc-Node-764\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-765\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-766\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em;\">p</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-767\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>p</mi><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-78\" type=\"math/tex\">p_1</script> lần lượt nhận các giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;0.5&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0.1&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-79-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-768\"><span class=\"mjx-mrow\" id=\"MJXc-Node-769\"><span class=\"mjx-mn\" id=\"MJXc-Node-770\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0.5</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-771\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-772\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0.1</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0.5</mn><mo>,</mo><mn>0.1</mn></math></span></span><script id=\"MathJax-Element-79\" type=\"math/tex\">0.5, 0.1</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;0.8&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-80-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-773\"><span class=\"mjx-mrow\" id=\"MJXc-Node-774\"><span class=\"mjx-mn\" id=\"MJXc-Node-775\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0.8</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>0.8</mn></math></span></span><script id=\"MathJax-Element-80\" type=\"math/tex\">0.8</script>.</p><div>\n<table style=\"border: 0px solid white\" width=\"100%\">\n<tbody><tr>\n<td style=\"border: 0px solid white\" width=\"30%\">\n<img src=\"./ex9_files/crossentropy1.png\" style=\"display:block;\" width=\"100%\"/>\n</td>\n<td style=\"border: 0px solid white\" width=\"30%\">\n<img src=\"./ex9_files/crossentropy2.png\" style=\"display:block;\" width=\"100%\"/>\n</td>\n<td style=\"border: 0px solid white\" width=\"30%\">\n<img src=\"./ex9_files/crossentropy3.png\" style=\"display:block;\" width=\"100%\"/>\n</td>\n</tr>\n</tbody></table>\n<div class=\"thecap\"> Hình 4: So sánh giữa hàm cross entropy và hàm bình phương khoảng cách. Các điểm màu xanh lục thể hiện các giá trị nhỏ nhất của mỗi hàm. </div>\n</div><p>Có hai nhận xét quan trọng sau đây:</p><ul>\n<li>\n<p>Giá trị nhỏ nhất của cả hai hàm số đạt được khi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-81-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-776\"><span class=\"mjx-mrow\" id=\"MJXc-Node-777\"><span class=\"mjx-mi\" id=\"MJXc-Node-778\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.014em;\">q</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-779\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-780\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em;\">p</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi><mo>=</mo><mi>p</mi></math></span></span><script id=\"MathJax-Element-81\" type=\"math/tex\">q = p</script> tại hoành độ của các điểm màu xanh lục.</p>\n</li>\n<li>\n<p>Quan trọng hơn, hàm cross entropy nhận giá trị rất cao (tức loss rất cao) khi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-82-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-781\"><span class=\"mjx-mrow\" id=\"MJXc-Node-782\"><span class=\"mjx-mi\" id=\"MJXc-Node-783\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.014em;\">q</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>q</mi></math></span></span><script id=\"MathJax-Element-82\" type=\"math/tex\">q</script> ở xa <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-83-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-784\"><span class=\"mjx-mrow\" id=\"MJXc-Node-785\"><span class=\"mjx-mi\" id=\"MJXc-Node-786\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em;\">p</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script id=\"MathJax-Element-83\" type=\"math/tex\">p</script>. Trong khi đó, sự chênh lệch giữa các loss ở gần hay xa nghiệm của hàm bình phương khoảng cách <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-84-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-787\"><span class=\"mjx-mrow\" id=\"MJXc-Node-788\"><span class=\"mjx-mo\" id=\"MJXc-Node-789\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-790\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.014em;\">q</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-791\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-792\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em;\">p</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-793\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-794\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-795\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mi>q</mi><mo>−</mo><mi>p</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></math></span></span><script id=\"MathJax-Element-84\" type=\"math/tex\">(q - p)^2</script> là không đáng kể. Về mặt tối ưu, hàm cross entropy sẽ cho nghiệm <em>gần</em> với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-85-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-796\"><span class=\"mjx-mrow\" id=\"MJXc-Node-797\"><span class=\"mjx-mi\" id=\"MJXc-Node-798\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em;\">p</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>p</mi></math></span></span><script id=\"MathJax-Element-85\" type=\"math/tex\">p</script> hơn vì những nghiệm ở xa bị <em>trừng phạt</em> rất nặng.</p>\n</li>\n</ul><p>Hai tính chất trên đây khiến cho cross entropy được sử dụng rộng rãi khi tính khoảng cách giữa hai phân phối xác suất.</p><p><strong>Chú ý:</strong> Hàm cross entropy không có tính đối xứng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;H&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-86-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-799\"><span class=\"mjx-mrow\" id=\"MJXc-Node-800\"><span class=\"mjx-mi\" id=\"MJXc-Node-801\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.057em;\">H</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-802\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-803\"><span class=\"mjx-mrow\" id=\"MJXc-Node-804\"><span class=\"mjx-mi\" id=\"MJXc-Node-805\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-806\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-807\"><span class=\"mjx-mrow\" id=\"MJXc-Node-808\"><span class=\"mjx-mi\" id=\"MJXc-Node-809\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-810\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-811\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-812\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.057em;\">H</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-813\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-814\"><span class=\"mjx-mrow\" id=\"MJXc-Node-815\"><span class=\"mjx-mi\" id=\"MJXc-Node-816\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-817\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-818\"><span class=\"mjx-mrow\" id=\"MJXc-Node-819\"><span class=\"mjx-mi\" id=\"MJXc-Node-820\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-821\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>H</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo stretchy=\"false\">)</mo><mo>≠</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-86\" type=\"math/tex\">H(\\mathbf{p}, \\mathbf{q}) \\neq H(\\mathbf{q}, \\mathbf{p})</script>. Điều này có thể dễ dàng nhận ra ở việc các thành phần của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-87-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-822\"><span class=\"mjx-mrow\" id=\"MJXc-Node-823\"><span class=\"mjx-texatom\" id=\"MJXc-Node-824\"><span class=\"mjx-mrow\" id=\"MJXc-Node-825\"><span class=\"mjx-mi\" id=\"MJXc-Node-826\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow></math></span></span><script id=\"MathJax-Element-87\" type=\"math/tex\">\\mathbf{p}</script> trong công thức <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-88-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-827\"><span class=\"mjx-mrow\" id=\"MJXc-Node-828\"><span class=\"mjx-mo\" id=\"MJXc-Node-829\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-830\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-831\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-88\" type=\"math/tex\">(1)</script> có thể nhận giá trị bằng 0, trong khi đó các thành phần của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-89-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-832\"><span class=\"mjx-mrow\" id=\"MJXc-Node-833\"><span class=\"mjx-texatom\" id=\"MJXc-Node-834\"><span class=\"mjx-mrow\" id=\"MJXc-Node-835\"><span class=\"mjx-mi\" id=\"MJXc-Node-836\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow></math></span></span><script id=\"MathJax-Element-89\" type=\"math/tex\">\\mathbf{q}</script> phải là dương vì <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-90-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-837\"><span class=\"mjx-mrow\" id=\"MJXc-Node-838\"><span class=\"mjx-mi\" id=\"MJXc-Node-839\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-840\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-841\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-842\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-843\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-90\" type=\"math/tex\">\\log(0)</script> không xác định. Chính vì vậy, khi sử dụng cross entropy trong các bài toán supervised learning, <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;p&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-91-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-844\"><span class=\"mjx-mrow\" id=\"MJXc-Node-845\"><span class=\"mjx-texatom\" id=\"MJXc-Node-846\"><span class=\"mjx-mrow\" id=\"MJXc-Node-847\"><span class=\"mjx-mi\" id=\"MJXc-Node-848\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">p</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">p</mi></mrow></math></span></span><script id=\"MathJax-Element-91\" type=\"math/tex\">\\mathbf{p}</script> thường là <em>đầu ra thực sự</em> vì đầu ra thực sự chỉ có 1 thành phần bằng 1, còn lại bằng 0 (one-hot), <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;q&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-92-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-849\"><span class=\"mjx-mrow\" id=\"MJXc-Node-850\"><span class=\"mjx-texatom\" id=\"MJXc-Node-851\"><span class=\"mjx-mrow\" id=\"MJXc-Node-852\"><span class=\"mjx-mi\" id=\"MJXc-Node-853\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em; padding-right: 0.002em;\">q</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">q</mi></mrow></math></span></span><script id=\"MathJax-Element-92\" type=\"math/tex\">\\mathbf{q}</script> thường là <em>đầu ra dự đoán</em>, khi mà không có xác suất nào tuyệt đối bằng 1 hoặc tuyệt đối bằng 0 cả.</p><p>Trong <a href=\"https://machinelearningcoban.com/2017/01/27/logisticregression/\">Logistic Regression</a>, chúng ta cũng có hai phân phối đơn giản. (i) <em>Đầu ra thực sự</em> của điểm dữ liệu đầu vào <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-93-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-854\"><span class=\"mjx-mrow\" id=\"MJXc-Node-855\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-856\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-857\"><span class=\"mjx-mrow\" id=\"MJXc-Node-858\"><span class=\"mjx-mi\" id=\"MJXc-Node-859\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-860\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-93\" type=\"math/tex\">\\mathbf{x}_i</script> có phân phối xác suất là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-94-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-861\"><span class=\"mjx-mrow\" id=\"MJXc-Node-862\"><span class=\"mjx-mo\" id=\"MJXc-Node-863\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-864\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-865\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-866\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-867\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-868\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-869\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-870\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-871\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-872\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-873\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mi>i</mi></msub><mo>;</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">]</mo></math></span></span><script id=\"MathJax-Element-94\" type=\"math/tex\">[y_i; 1 - y_i]</script> với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-95-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-874\"><span class=\"mjx-mrow\" id=\"MJXc-Node-875\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-876\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-877\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-878\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-95\" type=\"math/tex\">y_i</script> là xác suất để điểm dữ liệu đầu vào rơi vào class thứ nhất (bằng 1 nếu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-96-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-879\"><span class=\"mjx-mrow\" id=\"MJXc-Node-880\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-881\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-882\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-883\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-884\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-885\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></math></span></span><script id=\"MathJax-Element-96\" type=\"math/tex\">y_i = 1</script>, bằng 0 nếu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-97-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-886\"><span class=\"mjx-mrow\" id=\"MJXc-Node-887\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-888\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-889\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-890\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-891\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-892\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script id=\"MathJax-Element-97\" type=\"math/tex\">y_i = 0</script>). (ii). <em>Đầu ra dự đoán</em> của điểm dữ liệu đó là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;sigmoid&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-98-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-893\"><span class=\"mjx-mrow\" id=\"MJXc-Node-894\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-895\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-896\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-897\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-898\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mtext MJXc-space3\" id=\"MJXc-Node-899\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">sigmoid</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-900\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-901\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-902\"><span class=\"mjx-mrow\" id=\"MJXc-Node-903\"><span class=\"mjx-mi\" id=\"MJXc-Node-904\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-905\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-906\"><span class=\"mjx-mrow\" id=\"MJXc-Node-907\"><span class=\"mjx-mi\" id=\"MJXc-Node-908\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-909\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mi>i</mi></msub><mo>=</mo><mtext>sigmoid</mtext><mo stretchy=\"false\">(</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-98\" type=\"math/tex\">a_i = \\text{sigmoid}(\\mathbf{w}^T\\mathbf{x})</script> là xác suất để điểm đó rơi vào class thứ nhất. Xác suất để điểm đó rơi vào class thứ hai có thể được dễ dàng suy ra lf <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-99-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-910\"><span class=\"mjx-mrow\" id=\"MJXc-Node-911\"><span class=\"mjx-mn\" id=\"MJXc-Node-912\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-913\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-914\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-915\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-916\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>−</mo><msub><mi>a</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-99\" type=\"math/tex\">1 - a_i</script>. Vì vậy, hàm mất mát trong Logistic Regression:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-100-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-917\"><span class=\"mjx-mrow\" id=\"MJXc-Node-918\"><span class=\"mjx-mi\" id=\"MJXc-Node-919\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-920\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-921\"><span class=\"mjx-mrow\" id=\"MJXc-Node-922\"><span class=\"mjx-mi\" id=\"MJXc-Node-923\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-924\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-925\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-926\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-927\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-934\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-928\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-929\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-930\"><span class=\"mjx-mi\" id=\"MJXc-Node-931\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-932\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-933\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-935\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-936\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-937\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-938\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-939\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-940\"><span class=\"mjx-char\"></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-941\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-942\"><span class=\"mjx-mrow\" id=\"MJXc-Node-943\"><span class=\"mjx-mi\" id=\"MJXc-Node-944\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-945\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-946\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-947\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-948\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-949\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-950\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-951\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-952\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-953\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-954\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-955\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-956\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-957\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-958\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-959\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-960\"><span class=\"mjx-mrow\" id=\"MJXc-Node-961\"><span class=\"mjx-mi\" id=\"MJXc-Node-962\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-963\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-964\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-965\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mi>log</mi><mo>⁡</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi>a</mi></mrow><mi>i</mi></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi>a</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-100\" type=\"math/tex; mode=display\">\nJ(\\mathbf{w}) = -\\sum_{i=1}^N(y_i \\log {a}_i + (1-y_i) \\log (1 - {a}_i))\n</script>\nchính là một trường hợp đặc biệt của Cross Entropy. (<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-101-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-966\"><span class=\"mjx-mrow\" id=\"MJXc-Node-967\"><span class=\"mjx-mi\" id=\"MJXc-Node-968\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi></math></span></span><script id=\"MathJax-Element-101\" type=\"math/tex\">N</script> được dùng để thể hiện số điểm dữ liệu trong tập training).</p><p>Với Softmax Regression, trong trường hợp có <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-102-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-969\"><span class=\"mjx-mrow\" id=\"MJXc-Node-970\"><span class=\"mjx-mi\" id=\"MJXc-Node-971\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi></math></span></span><script id=\"MathJax-Element-102\" type=\"math/tex\">C</script> classes, <em>loss</em> giữa đầu ra dự đoán và đầu ra thực sự của một điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-103-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-972\"><span class=\"mjx-mrow\" id=\"MJXc-Node-973\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-974\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-975\"><span class=\"mjx-mrow\" id=\"MJXc-Node-976\"><span class=\"mjx-mi\" id=\"MJXc-Node-977\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-978\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-103\" type=\"math/tex\">\\mathbf{x}_i</script> được tính bằng:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-104-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-979\"><span class=\"mjx-mrow\" id=\"MJXc-Node-980\"><span class=\"mjx-mi\" id=\"MJXc-Node-981\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-982\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-983\"><span class=\"mjx-mrow\" id=\"MJXc-Node-984\"><span class=\"mjx-mi\" id=\"MJXc-Node-985\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-986\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-987\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-988\"><span class=\"mjx-mrow\" id=\"MJXc-Node-989\"><span class=\"mjx-mi\" id=\"MJXc-Node-990\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-991\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-992\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-993\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-994\"><span class=\"mjx-mrow\" id=\"MJXc-Node-995\"><span class=\"mjx-mi\" id=\"MJXc-Node-996\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-997\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-998\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-999\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1000\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-1001\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1008\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1002\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1003\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1004\"><span class=\"mjx-mi\" id=\"MJXc-Node-1005\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1006\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1007\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1009\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1010\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1011\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1012\"><span class=\"mjx-mi\" id=\"MJXc-Node-1013\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1014\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1015\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1016\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1017\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1018\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1019\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1020\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1021\"><span class=\"mjx-mi\" id=\"MJXc-Node-1022\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1023\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1024\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>J</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>;</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-104\" type=\"math/tex; mode=display\">\nJ(\\mathbf{W};\\mathbf{x}_i, \\mathbf{y}_i) = -\\sum_{j=1}^C y_{ji}\\log(a_{ji})\n</script>\nVới <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-105-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1025\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1026\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1027\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1028\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1029\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1030\"><span class=\"mjx-mi\" id=\"MJXc-Node-1031\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1032\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub></math></span></span><script id=\"MathJax-Element-105\" type=\"math/tex\">y_{ji}</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-106-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1033\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1034\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1035\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1036\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1037\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1038\"><span class=\"mjx-mi\" id=\"MJXc-Node-1039\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1040\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub></math></span></span><script id=\"MathJax-Element-106\" type=\"math/tex\"> a_{ji}</script> lần lượt là là phần tử thứ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-107-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1041\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1042\"><span class=\"mjx-mi\" id=\"MJXc-Node-1043\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>j</mi></math></span></span><script id=\"MathJax-Element-107\" type=\"math/tex\">j</script> của vector (xác suất) <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-108-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1044\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1045\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1046\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1047\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1048\"><span class=\"mjx-mi\" id=\"MJXc-Node-1049\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1050\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-108\" type=\"math/tex\">\\mathbf{y}_i</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-109-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1051\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1052\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1053\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1054\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1055\"><span class=\"mjx-mi\" id=\"MJXc-Node-1056\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1057\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-109\" type=\"math/tex\">\\mathbf{a}_i</script>. Nhắc lại rằng đầu ra <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-110-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1058\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1059\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1060\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1061\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1062\"><span class=\"mjx-mi\" id=\"MJXc-Node-1063\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1064\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-110\" type=\"math/tex\">\\mathbf{a}_i</script> phụ thuộc vào đầu vào <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-111-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1065\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1066\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1067\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1068\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1069\"><span class=\"mjx-mi\" id=\"MJXc-Node-1070\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1071\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-111\" type=\"math/tex\">\\mathbf{x}_i</script> và ma trận trọng số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-112-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1072\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1073\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1074\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1075\"><span class=\"mjx-mi\" id=\"MJXc-Node-1076\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-112\" type=\"math/tex\">\\mathbf{W}</script>.</p><p><a name=\"-ham-mat-mat-cho-softmax-regression\"></a></p><h3 id=\"33-hàm-mất-mát-cho-softmax-regression\">3.3. Hàm mất mát cho Softmax Regression</h3><p>Kết hợp tất cả các cặp dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-113-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1077\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1078\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1079\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1080\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1081\"><span class=\"mjx-mi\" id=\"MJXc-Node-1082\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1083\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1084\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1085\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1086\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1087\"><span class=\"mjx-mi\" id=\"MJXc-Node-1088\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1089\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1090\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1091\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1092\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1093\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1094\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1095\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1096\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1097\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1098\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1099\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi></math></span></span><script id=\"MathJax-Element-113\" type=\"math/tex\">\\mathbf{x}_i, \\mathbf{y}_i, i = 1, 2, \\dots, N</script>, chúng ta sẽ có hàm mất mát cho Softmax Regression như sau:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtable columnalign=\"right center left\" rowspacing=\"3pt\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;' id=\"MathJax-Element-114-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1100\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1101\"><span class=\"mjx-mtable\" id=\"MJXc-Node-1102\" style=\"vertical-align: -3.097em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-1103\" style=\"height: 3.333em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1104\" style=\"padding: 0px; text-align: right; width: 16.504em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1105\"><span class=\"mjx-mi\" id=\"MJXc-Node-1106\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1107\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1108\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1109\"><span class=\"mjx-mi\" id=\"MJXc-Node-1110\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1111\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-1112\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1113\"><span class=\"mjx-mi\" id=\"MJXc-Node-1114\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1115\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-1116\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1117\"><span class=\"mjx-mi\" id=\"MJXc-Node-1118\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">Y</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1119\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1120\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1121\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-1122\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1129\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1123\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1124\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1125\"><span class=\"mjx-mi\" id=\"MJXc-Node-1126\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1127\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1128\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-1130\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1137\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1131\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1132\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1133\"><span class=\"mjx-mi\" id=\"MJXc-Node-1134\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1135\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1136\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1138\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1139\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1140\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1141\"><span class=\"mjx-mi\" id=\"MJXc-Node-1142\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1143\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1144\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1145\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1146\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1147\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1148\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1149\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1150\"><span class=\"mjx-mi\" id=\"MJXc-Node-1151\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1152\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1153\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1154\" style=\"height: 3.36em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1155\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1156\"><span class=\"mjx-mo\" id=\"MJXc-Node-1157\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1158\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-1159\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1166\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1160\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1161\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1162\"><span class=\"mjx-mi\" id=\"MJXc-Node-1163\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1164\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1165\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-1167\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1174\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1168\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1169\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1170\"><span class=\"mjx-mi\" id=\"MJXc-Node-1171\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1172\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1173\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1175\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1176\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1177\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1178\"><span class=\"mjx-mi\" id=\"MJXc-Node-1179\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1180\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1181\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1182\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1183\"><span class=\"mjx-mo\" id=\"MJXc-Node-1184\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">(</span></span><span class=\"mjx-mfrac\" id=\"MJXc-Node-1185\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 7.287em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 7.287em; top: -1.818em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1186\"><span class=\"mjx-mi\" id=\"MJXc-Node-1187\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1188\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1189\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1190\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1191\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1192\"><span class=\"mjx-mi\" id=\"MJXc-Node-1193\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1195\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1194\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1196\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1197\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1198\"><span class=\"mjx-mi\" id=\"MJXc-Node-1199\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1200\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1201\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 7.287em; bottom: -1.355em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1202\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1203\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1204\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.383em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1210\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1205\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1206\"><span class=\"mjx-mi\" id=\"MJXc-Node-1207\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1208\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1209\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1211\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1212\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1213\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1214\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1215\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1216\"><span class=\"mjx-mi\" id=\"MJXc-Node-1217\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.335em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1219\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1218\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1220\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1221\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1222\"><span class=\"mjx-mi\" id=\"MJXc-Node-1223\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1224\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1225\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 7.287em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 3.173em; vertical-align: -1.355em;\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1226\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">)</span></span></span><span class=\"mjx-strut\"></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtable columnalign=\"right center left\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\" rowspacing=\"3pt\"><mtr><mtd><mi>J</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>;</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">Y</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>k</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></span><script id=\"MathJax-Element-114\" type=\"math/tex; mode=display\">\n\\begin{eqnarray}\nJ(\\mathbf{W}; \\mathbf{X}, \\mathbf{Y}) = -\\sum_{i = 1}^N \\sum_{j = 1}^C y_{ji}\\log(a_{ji}) \\newline\n= -\\sum_{i = 1}^N \\sum_{j = 1}^C y_{ji}\\log\\left(\\frac{\\exp(\\mathbf{w}_j^T\\mathbf{x}_i)}{\\sum_{k=1}^C \\exp(\\mathbf{w}_k^T\\mathbf{x}_i)}\\right)\n\\end{eqnarray}\n</script></p><p>Với ma trận trọng số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-115-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1227\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1228\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1229\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1230\"><span class=\"mjx-mi\" id=\"MJXc-Node-1231\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-115\" type=\"math/tex\">\\mathbf{W}</script> là biến cần tối ưu. Hàm mất mát này trông <em>có vẻ đáng sợ</em>, nhưng đừng sợ, đọc tiếp các bạn sẽ thấy đạo hàm của nó rất đẹp (<em>và đáng yêu</em>).</p><p><a name=\"-toi-uu-ham-mat-mat\"></a></p><h3 id=\"34-tối-ưu-hàm-mất-mát\">3.4. Tối ưu hàm mất mát</h3><p>Một lần nữa, chúng ta lại sử dụng <a href=\"https://machinelearningcoban.com/2017/01/16/gradientdescent2/#-stochastic-gradient-descent\">Stochastic Gradient Descent (SGD)</a> ở đây.</p><p>Với chỉ một cặp dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-116-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1232\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1233\"><span class=\"mjx-mo\" id=\"MJXc-Node-1234\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1235\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1236\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1237\"><span class=\"mjx-mi\" id=\"MJXc-Node-1238\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1239\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1240\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1241\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1242\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1243\"><span class=\"mjx-mi\" id=\"MJXc-Node-1244\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1245\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1246\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-116\" type=\"math/tex\">(\\mathbf{x}_i, \\mathbf{y}_i)</script>, ta có: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x225C;&lt;/mo&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-117-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1247\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1248\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1249\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1250\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1251\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1252\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1253\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1254\"><span class=\"mjx-mi\" id=\"MJXc-Node-1255\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1256\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1257\"><span class=\"mjx-char MJXc-TeX-ams-R\" style=\"padding-top: 0.59em; padding-bottom: 0.27em;\">≜</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-1258\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1259\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1260\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1261\"><span class=\"mjx-mi\" id=\"MJXc-Node-1262\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1263\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1264\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1265\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1266\"><span class=\"mjx-mi\" id=\"MJXc-Node-1267\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1268\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1269\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1270\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1271\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1272\"><span class=\"mjx-mi\" id=\"MJXc-Node-1273\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1274\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1275\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1276\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo><mo>≜</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>;</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo></math></span></span></span><script id=\"MathJax-Element-117\" type=\"math/tex; mode=display\">\nJ_i(\\mathbf{W}) \\triangleq J(\\mathbf{W}; \\mathbf{x}_i, \\mathbf{y}_i) = \n</script>\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtable columnalign=\"right center left\" rowspacing=\"3pt\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\"&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;' id=\"MathJax-Element-118-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1277\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1278\"><span class=\"mjx-mtable\" id=\"MJXc-Node-1279\" style=\"vertical-align: -4.838em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-1280\" style=\"height: 3.36em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1281\" style=\"padding: 0px; text-align: right; width: 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1282\" style=\"margin-top: 0.818em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1283\" style=\"padding: 0px 0.139em 0px 0px; width: 1.056em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1284\" style=\"margin-top: 0.818em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1285\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1286\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1287\" style=\"padding: 0px 0px 0px 0.139em; text-align: left; width: 18.985em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1288\"><span class=\"mjx-mi\" id=\"MJXc-Node-1289\"></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1290\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space2\" id=\"MJXc-Node-1291\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1298\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1292\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1293\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1294\"><span class=\"mjx-mi\" id=\"MJXc-Node-1295\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1296\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1297\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1299\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1300\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1301\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1302\"><span class=\"mjx-mi\" id=\"MJXc-Node-1303\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1304\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1305\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1306\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1307\"><span class=\"mjx-mo\" id=\"MJXc-Node-1308\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">(</span></span><span class=\"mjx-mfrac\" id=\"MJXc-Node-1309\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 7.287em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 7.287em; top: -1.818em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1310\"><span class=\"mjx-mi\" id=\"MJXc-Node-1311\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1312\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1313\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1314\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1315\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1316\"><span class=\"mjx-mi\" id=\"MJXc-Node-1317\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1319\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1318\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1320\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1321\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1322\"><span class=\"mjx-mi\" id=\"MJXc-Node-1323\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1324\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1325\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 7.287em; bottom: -1.355em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1326\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1327\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1328\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.383em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1334\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1329\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1330\"><span class=\"mjx-mi\" id=\"MJXc-Node-1331\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1332\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1333\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1335\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1336\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1337\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1338\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1339\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1340\"><span class=\"mjx-mi\" id=\"MJXc-Node-1341\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.335em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1343\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1342\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1344\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1345\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1346\"><span class=\"mjx-mi\" id=\"MJXc-Node-1347\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1348\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1349\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 7.287em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 3.173em; vertical-align: -1.355em;\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1350\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">)</span></span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1351\" style=\"height: 3.483em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1352\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1353\" style=\"margin-top: 0.791em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1354\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1355\" style=\"margin-top: 0.791em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1356\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1357\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1358\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1359\"><span class=\"mjx-mi\" id=\"MJXc-Node-1360\"></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1361\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space2\" id=\"MJXc-Node-1362\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1369\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1363\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1364\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1365\"><span class=\"mjx-mi\" id=\"MJXc-Node-1366\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1367\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1368\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-mrow MJXc-space1\" id=\"MJXc-Node-1370\"><span class=\"mjx-mo\" id=\"MJXc-Node-1371\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">(</span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1372\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1373\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1374\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1375\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1376\"><span class=\"mjx-mi\" id=\"MJXc-Node-1377\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1378\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1379\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1380\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1381\"><span class=\"mjx-mi\" id=\"MJXc-Node-1382\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1384\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1383\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1385\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1386\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1387\"><span class=\"mjx-mi\" id=\"MJXc-Node-1388\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1389\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1390\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1391\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1392\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1393\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1394\"><span class=\"mjx-mi\" id=\"MJXc-Node-1395\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1396\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1397\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1398\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1399\"><span class=\"mjx-mo\" id=\"MJXc-Node-1400\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">(</span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1401\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1402\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1409\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1403\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.122em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1404\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1405\"><span class=\"mjx-mi\" id=\"MJXc-Node-1406\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1407\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1408\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1410\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1411\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1412\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1413\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1414\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1415\"><span class=\"mjx-mi\" id=\"MJXc-Node-1416\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.335em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1418\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1417\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1419\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1420\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1421\"><span class=\"mjx-mi\" id=\"MJXc-Node-1422\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1423\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1424\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1425\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">)</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1426\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">)</span></span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1427\" style=\"height: 3.333em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1428\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1429\" style=\"margin-top: 0.791em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1430\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1431\" style=\"margin-top: 0.791em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1432\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1433\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1434\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1435\"><span class=\"mjx-mi\" id=\"MJXc-Node-1436\"></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1437\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-munderover MJXc-space2\" id=\"MJXc-Node-1438\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1445\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1439\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.176em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1440\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1441\"><span class=\"mjx-mi\" id=\"MJXc-Node-1442\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1443\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1444\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1446\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1447\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1448\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1449\"><span class=\"mjx-mi\" id=\"MJXc-Node-1450\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1451\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1452\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1453\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1454\"><span class=\"mjx-mi\" id=\"MJXc-Node-1455\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1457\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1456\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1458\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1459\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1460\"><span class=\"mjx-mi\" id=\"MJXc-Node-1461\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1462\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1463\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-1464\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">log</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1465\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1466\"><span class=\"mjx-mo\" id=\"MJXc-Node-1467\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">(</span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1468\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1469\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.236em; padding-top: 0.141em; padding-left: 0.641em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1476\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1470\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.122em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1471\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1472\"><span class=\"mjx-mi\" id=\"MJXc-Node-1473\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1474\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1475\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1477\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1478\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1479\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1480\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1481\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1482\"><span class=\"mjx-mi\" id=\"MJXc-Node-1483\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.335em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1485\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1484\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1486\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1487\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1488\"><span class=\"mjx-mi\" id=\"MJXc-Node-1489\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1490\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1491\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1492\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">)</span></span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1493\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1494\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1495\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1496\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1497\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtable columnalign=\"right center left\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\" rowspacing=\"3pt\"><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>k</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mrow><mo>(</mo><mrow><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>−</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>k</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo>−</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>+</mo><mi>log</mi><mo>⁡</mo><mrow><mo>(</mo><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>k</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>)</mo></mrow><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable></math></span></span></span><script id=\"MathJax-Element-118\" type=\"math/tex; mode=display\">\n\\begin{eqnarray}\n&=& -\\sum_{j = 1}^C y_{ji}\\log\\left(\\frac{\\exp(\\mathbf{w}_j^T\\mathbf{x}_i)}{\\sum_{k=1}^C \\exp(\\mathbf{w}_k^T\\mathbf{x}_i)}\\right) \\newline\n&=& -\\sum_{j=1}^C\\left(y_{ji} \\mathbf{w}_j^T\\mathbf{x}_i - y_{ji}\\log\\left(\\sum_{k=1}^C \\exp(\\mathbf{w}_k^T\\mathbf{x}_i)\\right)\\right) \\newline\n&=& -\\sum_{j=1}^C y_{ji} \\mathbf{w}_j^T\\mathbf{x}_i + \\log\\left(\\sum_{k=1}^C \\exp(\\mathbf{w}_k^T\\mathbf{x}_i)\\right) ~~ (3)\n\\end{eqnarray}\n</script></p><p>trong biến đổi ở dòng cuối cùng, tôi đã sử dụng quan sát: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-119-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1498\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1499\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1500\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1501\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.411em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1507\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1502\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1503\"><span class=\"mjx-mi\" id=\"MJXc-Node-1504\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1505\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1506\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1508\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1509\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1510\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1511\"><span class=\"mjx-mi\" id=\"MJXc-Node-1512\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1513\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1514\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1515\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><mn>1</mn></math></span></span><script id=\"MathJax-Element-119\" type=\"math/tex\">\\sum_{j=1}^C y_{ji} = 1</script> vì nó là tổng các xác suất.</p><p>Tiếp theo ta sử dụng công thức: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-120-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1516\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1517\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1518\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.567em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.567em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1519\"><span class=\"mjx-mi\" id=\"MJXc-Node-1520\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1521\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1522\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1523\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1524\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1525\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1526\"><span class=\"mjx-mi\" id=\"MJXc-Node-1527\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1528\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.567em; bottom: -0.764em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1529\"><span class=\"mjx-mi\" id=\"MJXc-Node-1530\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1531\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1532\"><span class=\"mjx-mi\" id=\"MJXc-Node-1533\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.567em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.291em; vertical-align: -0.764em;\"></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1534\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mrow MJXc-space3\" id=\"MJXc-Node-1535\"><span class=\"mjx-mo\" id=\"MJXc-Node-1536\"><span class=\"mjx-char MJXc-TeX-size3-R\" style=\"padding-top: 1.231em; padding-bottom: 1.231em;\">[</span></span><span class=\"mjx-mrow\" id=\"MJXc-Node-1537\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1538\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.567em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.567em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1539\"><span class=\"mjx-mi\" id=\"MJXc-Node-1540\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1541\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1542\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1543\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1544\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1545\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1546\"><span class=\"mjx-mi\" id=\"MJXc-Node-1547\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1548\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.567em; bottom: -0.885em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1549\"><span class=\"mjx-mi\" id=\"MJXc-Node-1550\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1551\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1552\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1553\"><span class=\"mjx-mi\" id=\"MJXc-Node-1554\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1555\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.567em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.412em; vertical-align: -0.885em;\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1556\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mfrac MJXc-space1\" id=\"MJXc-Node-1557\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.567em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.567em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1558\"><span class=\"mjx-mi\" id=\"MJXc-Node-1559\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1560\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1561\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1562\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1563\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1564\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1565\"><span class=\"mjx-mi\" id=\"MJXc-Node-1566\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1567\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.567em; bottom: -0.885em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1568\"><span class=\"mjx-mi\" id=\"MJXc-Node-1569\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1570\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1571\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1572\"><span class=\"mjx-mi\" id=\"MJXc-Node-1573\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1574\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.567em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.412em; vertical-align: -0.885em;\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1575\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1576\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1577\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mfrac MJXc-space1\" id=\"MJXc-Node-1578\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.567em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.567em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1579\"><span class=\"mjx-mi\" id=\"MJXc-Node-1580\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1581\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1582\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1583\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1584\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1585\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1586\"><span class=\"mjx-mi\" id=\"MJXc-Node-1587\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1588\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.567em; bottom: -0.913em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1589\"><span class=\"mjx-mi\" id=\"MJXc-Node-1590\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1591\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1592\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1593\"><span class=\"mjx-mi\" id=\"MJXc-Node-1594\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1595\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.567em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.44em; vertical-align: -0.913em;\"></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1596\"><span class=\"mjx-char MJXc-TeX-size3-R\" style=\"padding-top: 1.231em; padding-bottom: 1.231em;\">]</span></span></span><span class=\"mjx-mtext MJXc-space1\" id=\"MJXc-Node-1597\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1598\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1599\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1600\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">4</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1601\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></mrow></mfrac><mo>=</mo><mrow><mo>[</mo><mrow><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub></mrow></mfrac><mo>,</mo><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub></mrow></mfrac><mo>,</mo><mo>…</mo><mo>,</mo><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>C</mi></msub></mrow></mfrac></mrow><mo>]</mo></mrow><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-120\" type=\"math/tex; mode=display\">\n\\frac{\\partial J_i(\\mathbf{W})}{\\partial \\mathbf{W}} = \\left[\\frac{\\partial J_i(\\mathbf{W})}{\\partial \\mathbf{w}_1}, \\frac{\\partial J_i(\\mathbf{W})}{\\partial \\mathbf{w}_2}, \\dots, \\frac{\\partial J_i(\\mathbf{W})}{\\partial \\mathbf{w}_C}    \\right]~~(4)\n</script></p><p>Trong đó, gradient theo từng cột có thể tính được dựa theo <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-121-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1602\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1603\"><span class=\"mjx-mo\" id=\"MJXc-Node-1604\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1605\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1606\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-121\" type=\"math/tex\">(3)</script>:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtable columnalign=\"right center left\" rowspacing=\"3pt\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/munderover&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mtext&gt;where&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;' id=\"MathJax-Element-122-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1607\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1608\"><span class=\"mjx-mtable\" id=\"MJXc-Node-1609\" style=\"vertical-align: -2.749em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-1610\" style=\"height: 3.323em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1611\" style=\"padding: 0px; text-align: right; width: 3.807em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1612\" style=\"margin-top: 0.291em;\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1613\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.567em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.567em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1614\"><span class=\"mjx-mi\" id=\"MJXc-Node-1615\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1616\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1617\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1618\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1619\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1620\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1621\"><span class=\"mjx-mi\" id=\"MJXc-Node-1622\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1623\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.567em; bottom: -1.029em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1624\"><span class=\"mjx-mi\" id=\"MJXc-Node-1625\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1626\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1627\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1628\"><span class=\"mjx-mi\" id=\"MJXc-Node-1629\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1630\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.567em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.556em; vertical-align: -1.029em;\"></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1631\" style=\"padding: 0px 0.139em 0px 0px; width: 1.056em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1632\" style=\"margin-top: 0.818em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1633\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1634\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1635\" style=\"padding: 0px 0px 0px 0.139em; text-align: left; width: 13.29em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1636\"><span class=\"mjx-mi\" id=\"MJXc-Node-1637\"></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1638\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1639\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1640\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1641\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1642\"><span class=\"mjx-mi\" id=\"MJXc-Node-1643\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1644\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1645\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1646\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1647\"><span class=\"mjx-mi\" id=\"MJXc-Node-1648\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1649\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1650\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mfrac MJXc-space2\" id=\"MJXc-Node-1651\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 7.287em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 7.287em; top: -1.818em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1652\"><span class=\"mjx-mi\" id=\"MJXc-Node-1653\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1654\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1655\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1656\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1657\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1658\"><span class=\"mjx-mi\" id=\"MJXc-Node-1659\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1661\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1660\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1662\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1663\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1664\"><span class=\"mjx-mi\" id=\"MJXc-Node-1665\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1666\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1667\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 7.287em; bottom: -1.355em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1668\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1669\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1670\"><span class=\"mjx-char MJXc-TeX-size1-R\" style=\"padding-top: 0.537em; padding-bottom: 0.537em;\">∑</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.31em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.383em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1676\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1671\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1672\"><span class=\"mjx-mi\" id=\"MJXc-Node-1673\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1674\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1675\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-1677\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1678\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1679\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1680\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1681\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1682\"><span class=\"mjx-mi\" id=\"MJXc-Node-1683\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.335em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1685\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1684\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1686\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1687\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1688\"><span class=\"mjx-mi\" id=\"MJXc-Node-1689\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1690\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1691\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 7.287em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 3.173em; vertical-align: -1.355em;\"></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1692\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1693\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1694\"><span class=\"mjx-mi\" id=\"MJXc-Node-1695\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1696\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1697\" style=\"height: 1.412em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1698\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1699\" style=\"margin-top: -0.2em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1700\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1701\" style=\"margin-top: -0.2em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1702\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1703\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1704\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1705\" style=\"margin-top: -0.2em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1706\"></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1707\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1708\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1709\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1710\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1711\"><span class=\"mjx-mi\" id=\"MJXc-Node-1712\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1713\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1714\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1715\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1716\"><span class=\"mjx-mi\" id=\"MJXc-Node-1717\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1718\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1719\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1720\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1721\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1722\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1723\"><span class=\"mjx-mi\" id=\"MJXc-Node-1724\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1725\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1726\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1727\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1728\"><span class=\"mjx-mi\" id=\"MJXc-Node-1729\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1730\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1731\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1732\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1733\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1734\"><span class=\"mjx-mi\" id=\"MJXc-Node-1735\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1736\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1737\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1738\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1739\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1740\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1741\"><span class=\"mjx-mi\" id=\"MJXc-Node-1742\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1743\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1744\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1745\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1746\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1747\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1748\"><span class=\"mjx-mi\" id=\"MJXc-Node-1749\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1750\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1751\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1752\" style=\"height: 1.262em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1753\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1754\" style=\"margin-top: -0.2em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1755\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1756\" style=\"margin-top: -0.2em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1757\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1758\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1759\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1760\" style=\"margin-top: -0.2em;\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1761\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1762\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1763\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1764\"><span class=\"mjx-mi\" id=\"MJXc-Node-1765\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1766\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1767\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1768\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1769\"><span class=\"mjx-mi\" id=\"MJXc-Node-1770\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1771\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1772\"><span class=\"mjx-mi\" id=\"MJXc-Node-1773\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1774\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1775\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1776\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">where</span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1777\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1778\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1779\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1780\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1781\"><span class=\"mjx-mi\" id=\"MJXc-Node-1782\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1783\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1784\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1785\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1786\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1787\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1788\"><span class=\"mjx-mi\" id=\"MJXc-Node-1789\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1790\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1791\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1792\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1793\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1794\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1795\"><span class=\"mjx-mi\" id=\"MJXc-Node-1796\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1797\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1798\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1799\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1800\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1801\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1802\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">5</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1803\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtable columnalign=\"right center left\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\" rowspacing=\"3pt\"><mtr><mtd><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi></msub></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo>−</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>+</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>k</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mi></mi><mo>−</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>+</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><msub><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub><mtext> </mtext><mo stretchy=\"false\">(</mo><mtext>where</mtext><mtext> </mtext><msub><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo stretchy=\"false\">)</mo><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable></math></span></span></span><script id=\"MathJax-Element-122\" type=\"math/tex; mode=display\">\n\\begin{eqnarray}\n\\frac{\\partial J_i(\\mathbf{W})}{\\partial \\mathbf{w}_j} &=& -y_{ji}\\mathbf{x}_i + \n\\frac{\\exp(\\mathbf{w}_j^T\\mathbf{x}_i)}{\\sum_{k = 1}^C \\exp(\\mathbf{w}_k^T\\mathbf{x}_i)}\\mathbf{x}_i \\newline\n&=& -y_{ji}\\mathbf{x}_i + a_{ji} \\mathbf{x}_i = \\mathbf{x}_i (a_{ji} - y_{ji}) \\newline\n&=& e_{ji}\\mathbf{x}_{i} ~(\\text{where}~ e_{ji} = a_{ji} - y_{ji}) ~~(5)\n\\end{eqnarray}\n</script></p><p>Giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-123-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1804\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1805\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1806\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1807\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1808\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1809\"><span class=\"mjx-mi\" id=\"MJXc-Node-1810\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1811\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1812\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1813\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1814\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1815\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1816\"><span class=\"mjx-mi\" id=\"MJXc-Node-1817\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1818\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1819\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1820\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1821\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1822\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1823\"><span class=\"mjx-mi\" id=\"MJXc-Node-1824\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1825\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub><mo>−</mo><msub><mi>y</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mi>i</mi></mrow></msub></math></span></span><script id=\"MathJax-Element-123\" type=\"math/tex\">e_{ji} = a_{ji} - y_{ji} </script> có thể được coi là <em>sai số dự đoán</em>.</p><p>Đến đây ta đã được biểu thức rất đẹp rồi. Kết hợp <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-124-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1826\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1827\"><span class=\"mjx-mo\" id=\"MJXc-Node-1828\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1829\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">4</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1830\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-124\" type=\"math/tex\">(4)</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-125-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1831\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1832\"><span class=\"mjx-mo\" id=\"MJXc-Node-1833\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1834\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">5</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1835\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-125\" type=\"math/tex\">(5)</script> ta có: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;/math&gt;' id=\"MathJax-Element-126-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1836\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1837\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1838\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.567em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.567em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1839\"><span class=\"mjx-mi\" id=\"MJXc-Node-1840\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1841\"><span class=\"mjx-base\" style=\"margin-right: -0.078em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1842\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1843\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1844\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1845\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1846\"><span class=\"mjx-mi\" id=\"MJXc-Node-1847\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1848\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.567em; bottom: -0.764em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1849\"><span class=\"mjx-mi\" id=\"MJXc-Node-1850\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1851\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1852\"><span class=\"mjx-mi\" id=\"MJXc-Node-1853\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.567em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.291em; vertical-align: -0.764em;\"></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1854\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1855\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1856\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1857\"><span class=\"mjx-mi\" id=\"MJXc-Node-1858\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1859\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1860\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1861\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1862\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1863\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1864\"><span class=\"mjx-mn\" id=\"MJXc-Node-1865\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1866\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1867\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1868\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1869\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1870\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1871\"><span class=\"mjx-mn\" id=\"MJXc-Node-1872\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1873\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1874\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1875\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1876\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1877\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-1878\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">e</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.23em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1879\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1880\"><span class=\"mjx-mi\" id=\"MJXc-Node-1881\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1882\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1883\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1884\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1885\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1886\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1887\"><span class=\"mjx-mi\" id=\"MJXc-Node-1888\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1889\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1890\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1891\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1892\"><span class=\"mjx-mi\" id=\"MJXc-Node-1893\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">e</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1895\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1894\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>J</mi><mi>i</mi></msub><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></mrow></mfrac><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><mo stretchy=\"false\">[</mo><msub><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>1</mn><mi>i</mi></mrow></msub><mo>,</mo><msub><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mn>2</mn><mi>i</mi></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>e</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi>C</mi><mi>i</mi></mrow></msub><mo stretchy=\"false\">]</mo><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">e</mi></mrow><mi>i</mi><mi>T</mi></msubsup></math></span></span></span><script id=\"MathJax-Element-126\" type=\"math/tex; mode=display\">\n\\frac{\\partial J_i(\\mathbf{W})}{\\partial \\mathbf{W}} = \\mathbf{x}_i [e_{1i}, e_{2i}, \\dots, e_{Ci}] = \\mathbf{x}_i\\mathbf{e}_i^T\n</script>\n<a name=\"vi-du-va-luu-y-khi-lap-trinh-voi-python\"></a></p><p>Từ đây ta cũng có thể suy ra rằng:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-127-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1896\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1897\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1898\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 3.366em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 3.366em; top: -1.527em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1899\"><span class=\"mjx-mi\" id=\"MJXc-Node-1900\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1901\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.078em;\">J</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1902\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1903\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1904\"><span class=\"mjx-mi\" id=\"MJXc-Node-1905\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1906\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 3.366em; bottom: -0.764em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1907\"><span class=\"mjx-mi\" id=\"MJXc-Node-1908\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1909\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1910\"><span class=\"mjx-mi\" id=\"MJXc-Node-1911\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 3.366em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.291em; vertical-align: -0.764em;\"></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1912\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-munderover MJXc-space3\" id=\"MJXc-Node-1913\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1920\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-1914\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.21em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1915\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1916\"><span class=\"mjx-mi\" id=\"MJXc-Node-1917\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1918\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1919\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1921\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1922\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1923\"><span class=\"mjx-mi\" id=\"MJXc-Node-1924\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1925\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1926\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1927\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1928\"><span class=\"mjx-mi\" id=\"MJXc-Node-1929\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">e</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1931\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1930\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1932\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-texatom MJXc-space3\" id=\"MJXc-Node-1933\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1934\"><span class=\"mjx-mi\" id=\"MJXc-Node-1935\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1936\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1937\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1938\"><span class=\"mjx-mi\" id=\"MJXc-Node-1939\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">E</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.611em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1940\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>J</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>i</mi></msub><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">e</mi></mrow><mi>i</mi><mi>T</mi></msubsup><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">E</mi></mrow><mi>T</mi></msup></math></span></span></span><script id=\"MathJax-Element-127\" type=\"math/tex; mode=display\">\n\\frac{\\partial J(\\mathbf{W})}{\\partial \\mathbf{W}} = \\sum_{i=1}^N \\mathbf{x}_i\\mathbf{e}_i^T = \\mathbf{X}\\mathbf{E}^T\n</script>\nvới <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;E&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;A&lt;/mi&gt;&lt;mo mathvariant=\"bold\"&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=\"bold\"&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-128-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1941\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1942\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1943\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1944\"><span class=\"mjx-mi\" id=\"MJXc-Node-1945\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">E</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1946\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-texatom MJXc-space3\" id=\"MJXc-Node-1947\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1948\"><span class=\"mjx-mi\" id=\"MJXc-Node-1949\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">A</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1950\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"margin-top: -0.051em; padding-bottom: 0.323em;\">−</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-1951\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">Y</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">E</mi></mrow><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">A</mi><mo mathvariant=\"bold\">−</mo><mi mathvariant=\"bold\">Y</mi></mrow></math></span></span><script id=\"MathJax-Element-128\" type=\"math/tex\">\\mathbf{E} = \\mathbf{A - Y}</script>. Công thức tính gradient đơn giản thế này giúp cho cả <a href=\"https://machinelearningcoban.com/2017/01/16/gradientdescent2/#-bien-the-cua-gradient-descent\">Batch Gradient Descent, Stochastic Gradient Descent (SGD), và Mini-batch Gradient Descent</a> đều có thể dễ dàng được áp dụng.</p><p>Giả sử rằng chúng ta sử dụng SGD, công thức cập nhật cho ma trận trọng số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-129-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1952\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1953\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1954\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1955\"><span class=\"mjx-mi\" id=\"MJXc-Node-1956\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-129\" type=\"math/tex\">\\mathbf{W}</script> sẽ là: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;a&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-130-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1957\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1958\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1959\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1960\"><span class=\"mjx-mi\" id=\"MJXc-Node-1961\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1962\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-texatom MJXc-space3\" id=\"MJXc-Node-1963\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1964\"><span class=\"mjx-mi\" id=\"MJXc-Node-1965\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1966\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-1967\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">η</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1968\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1969\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1970\"><span class=\"mjx-mi\" id=\"MJXc-Node-1971\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1972\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1973\"><span class=\"mjx-mi\" id=\"MJXc-Node-1974\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1975\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1976\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1977\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1978\"><span class=\"mjx-mi\" id=\"MJXc-Node-1979\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1980\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1981\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1982\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1983\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1984\"><span class=\"mjx-mi\" id=\"MJXc-Node-1985\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">a</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1986\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1987\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1988\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1989\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>+</mo><mi>η</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi></mrow></msub><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">a</mi></mrow><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></math></span></span></span><script id=\"MathJax-Element-130\" type=\"math/tex; mode=display\">\n\\mathbf{W} = \\mathbf{W} +\\eta \\mathbf{x}_{i}(\\mathbf{y}_i - \\mathbf{a}_i)^T\n</script></p><p>Bạn có thấy công thức này giống với <a href=\"https://machinelearningcoban.com/2017/01/27/logisticregression/#cong-thuc-cap-nhat-cho-logistic-sigmoid-regression\">công thức cập nhật của Logistic Regression</a> không!</p><p>Thực ra:</p><p><a name=\"-logistic-regression-la-mot-truong-hop-dat-biet-cua-softmax-regression\"></a></p><h3 id=\"35-logistic-regression-là-một-trường-hợp-đặt-biệt-của-softmax-regression\">3.5. Logistic Regression là một trường hợp đặt biệt của Softmax Regression</h3><p>Khi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-131-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1990\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1991\"><span class=\"mjx-mi\" id=\"MJXc-Node-1992\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1993\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1994\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo>=</mo><mn>2</mn></math></span></span><script id=\"MathJax-Element-131\" type=\"math/tex\">C = 2</script>, Softmax Regression và Logistic Regression là giống nhau. Thật vậy, đầu ra dự đoán của Softmax Regression với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-132-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1995\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1996\"><span class=\"mjx-mi\" id=\"MJXc-Node-1997\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1998\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1999\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo>=</mo><mn>2</mn></math></span></span><script id=\"MathJax-Element-132\" type=\"math/tex\">C= 2</script> có thể được viết dưới dạng: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtable columnalign=\"right center left\" rowspacing=\"3pt\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;' id=\"MathJax-Element-133-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2000\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2001\"><span class=\"mjx-mtable\" id=\"MJXc-Node-2002\" style=\"vertical-align: -2.53em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-2003\" style=\"height: 3.005em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-2004\" style=\"padding: 0px; text-align: right; width: 0.918em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2005\" style=\"margin-top: 0.677em;\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-2006\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-2007\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">a</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2008\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-2009\" style=\"padding: 0px 0.139em 0px 0px; width: 1.056em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2010\" style=\"margin-top: 0.677em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2011\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-2012\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-2013\" style=\"padding: 0px 0px 0px 0.139em; text-align: left; width: 10.217em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2014\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-2015\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 9.977em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 9.977em; top: -1.677em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2016\"><span class=\"mjx-mi\" id=\"MJXc-Node-2017\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2018\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2019\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-2020\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2021\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2022\"><span class=\"mjx-mi\" id=\"MJXc-Node-2023\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2025\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2024\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-2026\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2027\"><span class=\"mjx-mi\" id=\"MJXc-Node-2028\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2029\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-denominator\" style=\"width: 9.977em; bottom: -1.177em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2030\"><span class=\"mjx-mi\" id=\"MJXc-Node-2031\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2032\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2033\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-2034\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2035\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2036\"><span class=\"mjx-mi\" id=\"MJXc-Node-2037\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2039\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2038\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-2040\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2041\"><span class=\"mjx-mi\" id=\"MJXc-Node-2042\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2043\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-2044\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-2045\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2046\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2047\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-2048\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2049\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2050\"><span class=\"mjx-mi\" id=\"MJXc-Node-2051\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2053\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2052\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-2054\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2055\"><span class=\"mjx-mi\" id=\"MJXc-Node-2056\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2057\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 9.977em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.855em; vertical-align: -1.177em;\"></span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-2058\" style=\"height: 2.555em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-2059\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2060\" style=\"margin-top: 0.368em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-2061\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2062\" style=\"margin-top: 0.368em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2063\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-2064\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-2065\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2066\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-2067\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 9.809em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 9.809em; top: -1.368em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2068\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span><span class=\"mjx-denominator\" style=\"width: 9.809em; bottom: -1.037em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2069\"><span class=\"mjx-mn\" id=\"MJXc-Node-2070\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-2071\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-2072\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">exp</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2073\"><span class=\"mjx-char\"></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2074\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2075\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-2076\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2077\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2078\"><span class=\"mjx-mi\" id=\"MJXc-Node-2079\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2080\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-2081\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-2082\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2083\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2084\"><span class=\"mjx-mi\" id=\"MJXc-Node-2085\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-2086\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-2087\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-2088\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.409em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2089\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-2090\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2091\"><span class=\"mjx-mi\" id=\"MJXc-Node-2092\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-2093\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 9.809em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.405em; vertical-align: -1.037em;\"></span></span><span class=\"mjx-strut\"></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtable columnalign=\"right center left\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\" rowspacing=\"3pt\"><mtr><mtd><msub><mi>a</mi><mn>1</mn></msub></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></mrow><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mfrac></mtd></mtr><mtr><mtd></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></mrow></mfrac></mtd></mtr></mtable></math></span></span></span><script id=\"MathJax-Element-133\" type=\"math/tex; mode=display\">\n\\begin{eqnarray}\na_1 &=& \\frac{\\exp(\\mathbf{w}_1^T\\mathbf{x})} {\\exp(\\mathbf{w}_1^T\\mathbf{x}) + \\exp(\\mathbf{w}_2^T\\mathbf{x})} \\newline\n&=& \\frac{1}{1 + \\exp((\\mathbf{w}_2 - \\mathbf{w}_1)^T\\mathbf{x})}\n\\end{eqnarray}\n</script></p><p>Đây chính là <a href=\"https://machinelearningcoban.com/2017/01/27/logisticregression/#sigmoid-function\">sigmoid function</a>, là đầu ra dự đoán theo Logistic Regression. Khi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-134-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2094\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2095\"><span class=\"mjx-mi\" id=\"MJXc-Node-2096\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-2097\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-2098\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo>=</mo><mn>2</mn></math></span></span><script id=\"MathJax-Element-134\" type=\"math/tex\">C = 2</script>, bạn đọc cũng có thể thấy rằng hàm mất mát của Logistic và Softmax Regression đều là cross entropy. Hơn nữa, mặc dù có 2 outputs, Softmax Regression có thể rút gọn thành 1 output vì tổng 2 outputs luôn luôn bằng 1.</p><p>Softmax Regression còn có các tên gọi khác là Multinomial Logistic Regression, Maximum Entropy Classifier, hay rất nhiều tên khác nữa. Xem thêm <a href=\"https://en.wikipedia.org/wiki/Multinomial_logistic_regression\">Multinomial logistic regression - Wikipedia</a>\n<a name=\"-mot-vai-luu-y-khi-lap-trinh-voi-python\"></a></p>"}, "examples": {"title": "<h2 id=\"4-một-vài-lưu-ý-khi-lập-trình-với-python\">4. Một vài lưu ý khi lập trình với Python</h2>", "content": "<p><a name=\"-bat-dau-voi-du-lieu-nho\"></a></p><h3 id=\"41-bắt-đầu-với-dữ-liệu-nhỏ\">4.1. Bắt đầu với dữ liệu nhỏ</h3><p>Các bài toán Machine Learning thường có độ phức tạp cao với lượng dữ liệu lớn và nhiều chiều. Để có thể áp dụng một thuật toán vào một bài toán cụ thể, trước tiên chúng ta cần áp dụng thuật toán đó vào <em>simulated data</em> (dữ liệu giả) với số chiều và số điểm dữ liệu nhỏ hơn. <em>Simulated data</em> này thường được tạo ngẫu nhiên (có thể thêm vài ràng buộc tùy vào đặc thù của dữ liệu). Với <em>simulated data</em> nhỏ, chúng ta có thể debug nhanh hơn và thử với nhiều trường hợp <em>simulated data</em> khác nhau. Khi nào thấy thuật toán chạy đúng chúng ta mới đưa <em>dữ liệu thật</em> vào.</p><p>Với Softmax Regression, tôi tạo <em>simulated data</em> như sau:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span> \n\n<span class=\"c1\"># randomly generate data \n</span><span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"mi\">2</span> <span class=\"c1\"># number of training sample \n</span><span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"mi\">2</span> <span class=\"c1\"># data dimension \n</span><span class=\"n\">C</span> <span class=\"o\">=</span> <span class=\"mi\">3</span> <span class=\"c1\"># number of classes \n</span>\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randint</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"p\">(</span><span class=\"n\">N</span><span class=\"p\">,))</span>\n</code></pre></div></div><p>Trong ví dụ đơn giản này, số điểm dữ liệu chỉ là <code class=\"language-plaintext highlighter-rouge\">N = 2</code>, số chiều dữ liệu <code class=\"language-plaintext highlighter-rouge\">d = 2</code>, và số classes <code class=\"language-plaintext highlighter-rouge\">C = 3</code>. Những giá trị đủ nhỏ này giúp cho việc kiểm tra có thể được thực hiện một cách tức thì. Sau khi thuật toán chạy đúng với những giá trị nhỏ này, ta có thể thay <code class=\"language-plaintext highlighter-rouge\">N, d, C</code> bằng vài giá trị khác trước khi sử dụng dữ liệu thật.</p><p><a name=\"-ma-tran-one-hot-coding\"></a></p><h3 id=\"42-ma-trận-one-hot-coding\">4.2. Ma trận one-hot coding</h3><p>Có một bước quan trọng nữa trong Softmax Regression là phải chuyển đổi mỗi label <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-135-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2099\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2100\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-2101\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2102\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2103\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-135\" type=\"math/tex\">y_i</script> thành một vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-136-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2104\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2105\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-2106\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2107\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2108\"><span class=\"mjx-mi\" id=\"MJXc-Node-2109\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2110\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-136\" type=\"math/tex\">\\mathbf{y}_i</script> dưới dạng one-hot coding. Trong đó, chỉ có đúng một phần tử của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-137-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2111\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2112\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-2113\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2114\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2115\"><span class=\"mjx-mi\" id=\"MJXc-Node-2116\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.368em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-2117\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-137\" type=\"math/tex\">\\mathbf{y}_i</script> bằng 1, các phần tử còn lại bằng 0. Như vậy, với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-138-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2118\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2119\"><span class=\"mjx-mi\" id=\"MJXc-Node-2120\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>N</mi></math></span></span><script id=\"MathJax-Element-138\" type=\"math/tex\">N</script> điểm dữ liệu và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-139-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2121\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2122\"><span class=\"mjx-mi\" id=\"MJXc-Node-2123\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi></math></span></span><script id=\"MathJax-Element-139\" type=\"math/tex\">C</script> classes, chúng ta sẽ có một ma trận có kích thước <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-140-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2124\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2125\"><span class=\"mjx-mi\" id=\"MJXc-Node-2126\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-2127\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-2128\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo>×</mo><mi>N</mi></math></span></span><script id=\"MathJax-Element-140\" type=\"math/tex\">C \\times N</script> trong đó mỗi cột chỉ có đúng 1 phần tử bằng 1, còn lại bằng 0. Nếu chúng ta lưu toàn bộ dữ liệu này thì sẽ bị lãng phí bộ nhớ.</p><p>Một cách thường được sử dụng là lưu ma trận output <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;Y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-141-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-2129\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2130\"><span class=\"mjx-texatom\" id=\"MJXc-Node-2131\"><span class=\"mjx-mrow\" id=\"MJXc-Node-2132\"><span class=\"mjx-mi\" id=\"MJXc-Node-2133\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">Y</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">Y</mi></mrow></math></span></span><script id=\"MathJax-Element-141\" type=\"math/tex\">\\mathbf{Y}</script> dưới dạng <em>sparse matrix</em>. Về cơ bản, cách làm này chỉ lưu các <strong>vị trí</strong> khác 0 của ma trận và <strong>giá trị</strong> khác 0 đó.</p><p>Python có hàm <a href=\"https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.coo_matrix.html\">scipy.sparse.coo_matrix</a> giúp chúng ta thực hiện việc này. Với one-hot coding, tôi thực hiện như sau:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">## One-hot coding\n</span><span class=\"kn\">from</span> <span class=\"nn\">scipy</span> <span class=\"kn\">import</span> <span class=\"n\">sparse</span> \n<span class=\"k\">def</span> <span class=\"nf\">convert_labels</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">C</span> <span class=\"o\">=</span> <span class=\"n\">C</span><span class=\"p\">):</span>\n    <span class=\"s\">\"\"\"\n    convert 1d label to a matrix label: each column of this \n    matrix coresponding to 1 element in y. In i-th column of Y, \n    only one non-zeros element located in the y[i]-th position, \n    and = 1 ex: y = [0, 2, 1, 0], and 3 classes then return\n\n            [[1, 0, 0, 1],\n             [0, 0, 1, 0],\n             [0, 1, 0, 0]]\n    \"\"\"</span>\n    <span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">sparse</span><span class=\"p\">.</span><span class=\"n\">coo_matrix</span><span class=\"p\">((</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">ones_like</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">),</span> \n        <span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">)))),</span> <span class=\"n\">shape</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">))).</span><span class=\"n\">toarray</span><span class=\"p\">()</span>\n    <span class=\"k\">return</span> <span class=\"n\">Y</span> \n\n<span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">convert_labels</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n</code></pre></div></div><p><a name=\"-kiem-tra-dao-ham\"></a></p><h3 id=\"43-kiểm-tra-đạo-hàm\">4.3. Kiểm tra đạo hàm</h3><p>Điều cốt lõi trong cách tối ưu hàm mất mát là tính gradient. Với biểu thức toán trông <em>khá rối mắt</em> như trên, rất dễ để các bạn nhầm lẫn ở một bước nào đó. Softmax Regression vẫn là một thuật toán đơn giản, sau này các bạn sẽ thấy nhưng biểu thức phức tạp hơn nhiều. Rất khó để có thể tính toán đúng gradient ở ngay lần thử đầu tiên.</p><p>Trong thực nghiệm, một cách thường được làm là so sánh gradient tính được với <em>numeric gradient</em>, tức gradient tính theo định nghĩa. Bạn đọc được khuyến khích đọc cách <a href=\"https://machinelearningcoban.com/2017/01/12/gradientdescent/#kiem-tra-dao-ham\">Kiểm tra đạo hàm</a>.</p><p>Việc kiểm tra đạo hàm được thực hiện như sau:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># cost or loss function  \n</span><span class=\"k\">def</span> <span class=\"nf\">cost</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W</span><span class=\"p\">):</span>\n    <span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"n\">softmax</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">))</span>\n    <span class=\"k\">return</span> <span class=\"o\">-</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">Y</span><span class=\"o\">*</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">log</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">))</span>\n\n<span class=\"n\">W_init</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">grad</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W</span><span class=\"p\">):</span>\n    <span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"n\">softmax</span><span class=\"p\">((</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)))</span>\n    <span class=\"n\">E</span> <span class=\"o\">=</span> <span class=\"n\">A</span> <span class=\"o\">-</span> <span class=\"n\">Y</span>\n    <span class=\"k\">return</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">E</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">)</span>\n    \n<span class=\"k\">def</span> <span class=\"nf\">numerical_grad</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">cost</span><span class=\"p\">):</span>\n    <span class=\"n\">eps</span> <span class=\"o\">=</span> <span class=\"mf\">1e-6</span>\n    <span class=\"n\">g</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">)</span>\n    <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]):</span>\n        <span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]):</span>\n            <span class=\"n\">W_p</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n            <span class=\"n\">W_n</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n            <span class=\"n\">W_p</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"n\">eps</span> \n            <span class=\"n\">W_n</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">-=</span> <span class=\"n\">eps</span>\n            <span class=\"n\">g</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">,</span><span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">cost</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W_p</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"n\">cost</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W_n</span><span class=\"p\">))</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">eps</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">g</span> \n\n<span class=\"n\">g1</span> <span class=\"o\">=</span> <span class=\"n\">grad</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W_init</span><span class=\"p\">)</span>\n<span class=\"n\">g2</span> <span class=\"o\">=</span> <span class=\"n\">numerical_grad</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">Y</span><span class=\"p\">,</span> <span class=\"n\">W_init</span><span class=\"p\">,</span> <span class=\"n\">cost</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">linalg</span><span class=\"p\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">g1</span> <span class=\"o\">-</span> <span class=\"n\">g2</span><span class=\"p\">))</span>\n</code></pre></div></div><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>2.70479295591e-10\n</code></pre></div></div><p>Như vậy, sự khác biệt giữa hai đạo hàm là rất nhỏ. Nếu các bạn thử vài trường hợp khác nữa của <code class=\"language-plaintext highlighter-rouge\">N, C, d</code>, chúng ta sẽ thấy sự sai khác vẫn là nhỏ. Điều này chứng tỏ đạo hàm chúng ta tính được coi là chính xác. (Vẫn có thể có bug, chỉ khi nào kết quả cuối cùng với dữ liệu thật là chấp nhận được thì ta mới có thể bỏ cụm từ ‘có thể coi’ đi).</p><p>Chú ý rằng, nếu <code class=\"language-plaintext highlighter-rouge\">N, C, d</code> quá lớn, việc tính toán <code class=\"language-plaintext highlighter-rouge\">numerical_grad</code> trở nên cực kỳ tốn thời gian và bộ nhớ. Chúng ta chỉ nên kiểm tra với những dữ liệu nhỏ.\n<a name=\"-ham-chinh-cho-training-softmax-regression\"></a></p><h3 id=\"44-hàm-chính-cho-training-softmax-regression\">4.4. Hàm chính cho training Softmax Regression</h3><p>Sau khi đã có những hàm cần thiết và gradient được tính đúng, chúng ta có thể viết hàm chính có training Softmax Regression (theo SGD) như sau:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">softmax_regression</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">W_init</span><span class=\"p\">,</span> <span class=\"n\">eta</span><span class=\"p\">,</span> <span class=\"n\">tol</span> <span class=\"o\">=</span> <span class=\"mf\">1e-4</span><span class=\"p\">,</span> <span class=\"n\">max_count</span> <span class=\"o\">=</span> <span class=\"mi\">10000</span><span class=\"p\">):</span>\n    <span class=\"n\">W</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">W_init</span><span class=\"p\">]</span>    \n    <span class=\"n\">C</span> <span class=\"o\">=</span> <span class=\"n\">W_init</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">Y</span> <span class=\"o\">=</span> <span class=\"n\">convert_labels</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n    <span class=\"n\">it</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n    \n    <span class=\"n\">count</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">check_w_after</span> <span class=\"o\">=</span> <span class=\"mi\">20</span>\n    <span class=\"k\">while</span> <span class=\"n\">count</span> <span class=\"o\">&lt;</span> <span class=\"n\">max_count</span><span class=\"p\">:</span>\n        <span class=\"c1\"># mix data \n</span>        <span class=\"n\">mix_id</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">permutation</span><span class=\"p\">(</span><span class=\"n\">N</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">mix_id</span><span class=\"p\">:</span>\n            <span class=\"n\">xi</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[:,</span> <span class=\"n\">i</span><span class=\"p\">].</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n            <span class=\"n\">yi</span> <span class=\"o\">=</span> <span class=\"n\">Y</span><span class=\"p\">[:,</span> <span class=\"n\">i</span><span class=\"p\">].</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n            <span class=\"n\">ai</span> <span class=\"o\">=</span> <span class=\"n\">softmax</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">].</span><span class=\"n\">T</span><span class=\"p\">,</span> <span class=\"n\">xi</span><span class=\"p\">))</span>\n            <span class=\"n\">W_new</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"o\">+</span> <span class=\"n\">eta</span><span class=\"o\">*</span><span class=\"n\">xi</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">((</span><span class=\"n\">yi</span> <span class=\"o\">-</span> <span class=\"n\">ai</span><span class=\"p\">).</span><span class=\"n\">T</span><span class=\"p\">)</span>\n            <span class=\"n\">count</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n            <span class=\"c1\"># stopping criteria\n</span>            <span class=\"k\">if</span> <span class=\"n\">count</span><span class=\"o\">%</span><span class=\"n\">check_w_after</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>                \n                <span class=\"k\">if</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">linalg</span><span class=\"p\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">W_new</span> <span class=\"o\">-</span> <span class=\"n\">W</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"n\">check_w_after</span><span class=\"p\">])</span> <span class=\"o\">&lt;</span> <span class=\"n\">tol</span><span class=\"p\">:</span>\n                    <span class=\"k\">return</span> <span class=\"n\">W</span>\n            <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">W_new</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">W</span>\n<span class=\"n\">eta</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">05</span> \n<span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"n\">W_init</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n\n<span class=\"n\">W</span> <span class=\"o\">=</span> <span class=\"n\">softmax_regression</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">W_init</span><span class=\"p\">,</span> <span class=\"n\">eta</span><span class=\"p\">)</span>\n<span class=\"c1\"># W[-1] is the solution, W is all history of weights\n</span></code></pre></div></div><p><a name=\"-ham-du-doan-class-cho-du-lieu-moi\"></a></p><h3 id=\"45-hàm-dự-đoán-class-cho-dữ-liệu-mới\">4.5. Hàm dự đoán class cho dữ liệu mới</h3><p>Sau khi train Softmax Regression và tính được ma trận hệ số <code class=\"language-plaintext highlighter-rouge\">W</code>, class của một dữ liệu mới có thể tìm được bằng cách xác định vị trí của giá trị lớn nhất ở đầu ra dự đoán (tương ứng với xác suất điểm dữ liệu rơi vào class đó là lớn nhất). Chú ý rằng, các class được đánh số là <code class=\"language-plaintext highlighter-rouge\">0, 1, 2, ..., C</code>.</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">pred</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">):</span>\n    <span class=\"s\">\"\"\"\n    predict output of each columns of X\n    Class of each x_i is determined by location of max probability\n    Note that class are indexed by [0, 1, 2, ...., C-1]\n    \"\"\"</span>\n    <span class=\"n\">A</span> <span class=\"o\">=</span> <span class=\"n\">softmax_stable</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">))</span>\n    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">argmax</span><span class=\"p\">(</span><span class=\"n\">A</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n</code></pre></div></div><p><a name=\"-vi-du-voi-python\"></a></p>"}}