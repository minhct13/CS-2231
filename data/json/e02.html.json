{"topic": "<ul class=\"tags\">\n<a class=\"tag\" href=\"/tags#Clustering\">Clustering</a>\n<a class=\"tag\" href=\"/tags#Kmeans\">Kmeans</a>\n<a class=\"tag\" href=\"/tags#Unsupervised-learning\">Unsupervised-learning</a>\n</ul>", "title": "<h1 class=\"post-title\" itemprop=\"name\">Bài 4: K-means Clustering</h1>", "introduction": {"title": "1. Giới thiệu", "content": ["<p><a href=\"/2016/12/28/linearregression/\">Trong bài trước</a>, chúng ta đã làm quen với thuật toán Linear Regression - là thuật toán đơn giản nhất trong <a href=\"/2016/12/27/categories/#supervised-learning-hoc-co-giam-sat\">Supervised learning</a>. Bài này tôi sẽ giới thiệu một trong những thuật toán cơ bản nhất trong <a href=\"/2016/12/27/categories/#unsupervised-learning-hoc-khong-giam-sat\">Unsupervised learning</a> - thuật toán K-means clustering (phân cụm K-means).</p>", "<a href=\"/2016/12/28/linearregression/\">Trong bài trước</a>", "<a href=\"/2016/12/27/categories/#supervised-learning-hoc-co-giam-sat\">Supervised learning</a>", "<a href=\"/2016/12/27/categories/#unsupervised-learning-hoc-khong-giam-sat\">Unsupervised learning</a>", "<p>Trong thuật toán K-means clustering, chúng ta không biết nhãn (label) của từng điểm dữ liệu. Mục đích là làm thể nào để phân dữ liệu thành các cụm (cluster) khác nhau sao cho <em>dữ liệu trong cùng một cụm có tính chất giống nhau</em>.</p>", "<em>dữ liệu trong cùng một cụm có tính chất giống nhau</em>", "<p><strong>Ví dụ:</strong> Một công ty muốn tạo ra những chính sách ưu đãi cho những nhóm khách hàng khác nhau dựa trên sự tương tác giữa mỗi khách hàng với công ty đó (số năm là khách hàng; số tiền khách hàng đã chi trả cho công ty; độ tuổi; giới tính; thành phố; nghề nghiệp; …). Giả sử công ty đó có rất nhiều dữ liệu của rất nhiều khách hàng nhưng chưa có cách nào chia toàn bộ khách hàng đó thành một số nhóm/cụm khác nhau. Nếu một người biết Machine Learning được đặt câu hỏi này, phương pháp đầu tiên anh (chị) ta nghĩ đến sẽ là K-means Clustering. Vì nó là một trong những thuật toán đầu tiên mà anh ấy tìm được trong các cuốn sách, khóa học về Machine Learning. Và tôi cũng chắc rằng anh ấy đã đọc blog <a href=\"https://tiepvupsu.github.io\">Machine Learning cơ bản</a>. Sau khi đã phân ra được từng nhóm, nhân viên công ty đó có thể lựa chọn ra một vài khách hàng trong mỗi nhóm để quyết định xem mỗi nhóm tương ứng với nhóm khách hàng nào. Phần việc cuối cùng này cần sự can thiệp của con người, nhưng lượng công việc đã được rút gọn đi rất nhiều.</p>", "<strong>Ví dụ:</strong>", "<a href=\"https://tiepvupsu.github.io\">Machine Learning cơ bản</a>", "<p>Ý tưởng đơn giản nhất về cluster (cụm) là tập hợp các điểm <em>ở gần nhau trong một không gian nào đó</em> (không gian này có thể có rất nhiều chiều trong trường hợp thông tin về một điểm dữ liệu là rất lớn). Hình bên dưới là một ví dụ về 3 cụm dữ liệu (từ giờ tôi sẽ viết gọn là <em>cluster</em>).</p>", "<em>ở gần nhau trong một không gian nào đó</em>", "<em>cluster</em>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/kmeans/figure_2.png\" width=\"500\"/>\n<div class=\"thecap\"> Bài toán với 3 clusters. <br/></div>\n</div>", "<img align=\"center\" src=\"/assets/kmeans/figure_2.png\" width=\"500\"/>", "<div class=\"thecap\"> Bài toán với 3 clusters. <br/></div>", "<br/>", "<p>Giả sử mỗi cluster có một điểm đại diện (<em>center</em>) màu vàng. Và những điểm xung quanh mỗi center thuộc vào cùng nhóm với center đó. Một cách đơn giản nhất, xét một điểm bất kỳ, ta xét xem điểm đó gần với center nào nhất thì nó thuộc về cùng nhóm với center đó. Tới đây, chúng ta có một bài toán thú vị: <em>Trên một vùng biển hình vuông lớn có ba đảo hình vuông, tam giác, và tròn màu vàng như hình trên. Một điểm trên biển được gọi là thuộc lãnh hải của một đảo nếu nó nằm gần đảo này hơn so với hai đảo kia . Hãy xác định ranh giới lãnh hải của các đảo.</em></p>", "<em>center</em>", "<em>Trên một vùng biển hình vuông lớn có ba đảo hình vuông, tam giác, và tròn màu vàng như hình trên. Một điểm trên biển được gọi là thuộc lãnh hải của một đảo nếu nó nằm gần đảo này hơn so với hai đảo kia . Hãy xác định ranh giới lãnh hải của các đảo.</em>", "<p>Hình dưới đây là một hình minh họa cho việc phân chia lãnh hải nếu có 5 đảo khác nhau được biểu diễn bằng các hình tròn màu đen:</p>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/kmeans/figure_1.png\" width=\"500\"/>\n<div class=\"thecap\"> Phân vùng lãnh hải của mỗi đảo. Các vùng khác nhau có màu sắc khác nhau. <br/></div>\n</div>", "<img align=\"center\" src=\"/assets/kmeans/figure_1.png\" width=\"500\"/>", "<div class=\"thecap\"> Phân vùng lãnh hải của mỗi đảo. Các vùng khác nhau có màu sắc khác nhau. <br/></div>", "<br/>", "<p>Chúng ta thấy rằng đường phân định giữa các lãnh hải là các đường thẳng (chính xác hơn thì chúng là các đường trung trực của các cặp điểm gần nhau). Vì vậy, lãnh hải của một đảo sẽ là một hình đa giác.</p>", "<p>Cách phân chia này trong toán học được gọi là <a href=\"https://en.wikipedia.org/wiki/Voronoi_diagram\">Voronoi Diagram</a>.</p>", "<a href=\"https://en.wikipedia.org/wiki/Voronoi_diagram\">Voronoi Diagram</a>", "<p>Trong không gian ba chiều, lấy ví dụ là các hành tinh, thì (tạm gọi là) <em>lãnh không</em> của mỗi hành tinh sẽ là một đa diện. Trong không gian nhiều chiều hơn, chúng ta sẽ có những thứ (mà tôi gọi là) <em>siêu đa diện</em> (hyperpolygon).</p>", "<em>lãnh không</em>", "<em>siêu đa diện</em>", "<p>Quay lại với bài toán phân nhóm và cụ thể là thuật toán K-means clustering, chúng ta cần một chút phân tích toán học trước khi đi tới phần <a href=\"#tom-tat-thuat-toan\">tóm tắt thuật toán</a> ở phần dưới. Nếu bạn không muốn đọc quá nhiều về toán, bạn có thể bỏ qua phần này. (<em>Tốt nhất là đừng bỏ qua, bạn sẽ tiếc đấy</em>).\n<!-- ========================== New Heading ==================== -->\n<a name=\"-phan-tich-toan-hoc\"></a></p>", "<a href=\"#tom-tat-thuat-toan\">tóm tắt thuật toán</a>", "<em>Tốt nhất là đừng bỏ qua, bạn sẽ tiếc đấy</em>", "<a name=\"-phan-tich-toan-hoc\"></a>"]}, "formulas": {"title": "2. Phân tích toán học", "content": ["<p>Mục đích cuối cùng của thuật toán phân nhóm này là: từ dữ liệu đầu vào và số lượng nhóm chúng ta muốn tìm, hãy chỉ ra center của mỗi nhóm và phân các điểm dữ liệu vào các nhóm tương ứng. Giả sử thêm rằng mỗi điểm dữ liệu chỉ thuộc vào đúng một nhóm.</p>", "<p><a name=\"mot-so-ky-hieu-toan-hoc\"></a></p>", "<a name=\"mot-so-ky-hieu-toan-hoc\"></a>", "<h3 id=\"một-số-ký-hiệu-toán-học\">Một số ký hiệu toán học</h3>", "<p>Giả sử có \\(N\\) điểm dữ liệu là \\( \\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\dots, \\mathbf{x}_N] \\in \\mathbb{R}^{d \\times N}\\) và \\(K &lt; N\\) là số cluster chúng ta muốn phân chia. Chúng ta cần tìm các center \\( \\mathbf{m}_1, \\mathbf{m}_2, \\dots, \\mathbf{m}_K \\in \\mathbb{R}^{d \\times 1} \\) và label của mỗi điểm dữ liệu.</p>", "<p><strong>Lưu ý về ký hiệu toán học:</strong> <em>trong các bài viết của tôi, các số vô hướng được biểu diễn bởi các chữ cái viết ở dạng không in đậm, có thể viết hoa, ví dụ \\(x_1, N, y, k\\). Các vector được biểu diễn bằng các chữ cái thường in đậm, ví dụ \\(\\mathbf{m}, \\mathbf{x}_1 \\). Các ma trận được biểu diễn bởi các chữ viết hoa in đậm, ví dụ \\(\\mathbf{X, M, Y} \\). Lưu ý này đã được nêu ở bài <a href=\"/2016/12/28/linearregression/\">Linear Regression</a>. Tôi xin được không nhắc lại trong các bài tiếp theo.</em></p>", "<strong>Lưu ý về ký hiệu toán học:</strong>", "<em>trong các bài viết của tôi, các số vô hướng được biểu diễn bởi các chữ cái viết ở dạng không in đậm, có thể viết hoa, ví dụ \\(x_1, N, y, k\\). Các vector được biểu diễn bằng các chữ cái thường in đậm, ví dụ \\(\\mathbf{m}, \\mathbf{x}_1 \\). Các ma trận được biểu diễn bởi các chữ viết hoa in đậm, ví dụ \\(\\mathbf{X, M, Y} \\). Lưu ý này đã được nêu ở bài <a href=\"/2016/12/28/linearregression/\">Linear Regression</a>. Tôi xin được không nhắc lại trong các bài tiếp theo.</em>", "<a href=\"/2016/12/28/linearregression/\">Linear Regression</a>", "<p><a name=\"one-hot\"></a>\nVới mỗi điểm dữ liệu \\( \\mathbf{x}_i \\) đặt \\(\\mathbf{y}_i = [y_{i1}, y_{i2}, \\dots, y_{iK}]\\) là label vector của nó, trong đó nếu \\( \\mathbf{x}_i \\) được phân vào cluster \\(k\\) thì  \\(y_{ik} = 1\\) và \\(y_{ij} = 0, \\forall j \\neq k \\). Điều này có nghĩa là có đúng một phần tử của vector \\(\\mathbf{y}_i\\) là bằng 1 (tương ứng với cluster của \\(\\mathbf{x}_i \\)), các phần tử còn lại bằng 0. Ví dụ: nếu một điểm dữ liệu có label vector là \\([1,0,0,\\dots,0]\\) thì nó thuộc vào cluster 1, là \\([0,1,0,\\dots,0]\\) thì nó thuộc vào cluster 2, \\(\\dots\\). Cách mã hóa label của dữ liệu như thế này được gọi là biểu diễn <a href=\"https://en.wikipedia.org/wiki/One-hot\"><em>one-hot</em></a>. Chúng ta sẽ thấy cách biểu diễn one-hot này rất phổ biến trong Machine Learning ở các bài tiếp theo.</p>", "<a name=\"one-hot\"></a>", "<a href=\"https://en.wikipedia.org/wiki/One-hot\"><em>one-hot</em></a>", "<em>one-hot</em>", "<p>Ràng buộc của \\(\\mathbf{y}_i \\) có thể viết dưới dạng toán học như sau:\n\\[\n y_{ik} \\in \\{0, 1\\},~~~ \\sum_{k = 1}^K y_{ik} = 1 ~~~ (1)\n\\]\n<!-- \\\\[ \\mathbf{y}_i = [y_{i}, y_2] \\\\] -->\n<!-- [y_{i1}]\\\\) -->\n<!-- đặt \\\\(\\mathbf{y}_i = [y_{i1}, y_{i2}, \\dots, y_{iK} \\\\) là vector biểu diễn label của một điểm, trong đó nếu nếu điểm dữ liệu --></p>", "<p><!-- \\\\(\\mathbf{x}_i\\\\) được phân vào cluster \\\\(k\\\\) thì  \\\\(y_{ik} = 1\\\\)  -->\n<!-- ========================== New Heading ==================== -->\n<a name=\"ham-mat-mat-va-bai-toan-toi-uu\"></a></p>", "<a name=\"ham-mat-mat-va-bai-toan-toi-uu\"></a>", "<h3 id=\"hàm-mất-mát-và-bài-toán-tối-ưu\">Hàm mất mát và bài toán tối ưu</h3>", "<p>Nếu ta coi center \\(\\mathbf{m}_k \\)  là center (hoặc representative) của mỗi cluster và <em>ước lượng</em> tất cả các điểm được phân vào cluster này bởi \\(\\mathbf{m}_k \\), thì một điểm dữ liệu \\(\\mathbf{x}_i \\) được phân vào cluster \\(k\\) sẽ bị sai số là \\( (\\mathbf{x}_i - \\mathbf{m}_k) \\). Chúng ta mong muốn sai số này có trị tuyệt đối nhỏ nhất nên (<a href=\"/2016/12/28/linearregression/#sai-so-du-doan\">giống như trong bài Linear Regression</a>) ta sẽ tìm cách để đại lượng sau đây đạt giá trị nhỏ nhất: \n\\[\n\\|\\mathbf{x}_i - \\mathbf{m}_k\\|_2^2\n\\]</p>", "<em>ước lượng</em>", "<a href=\"/2016/12/28/linearregression/#sai-so-du-doan\">giống như trong bài Linear Regression</a>", "<p>Hơn nữa, vì \\(\\mathbf{x}_i \\) được phân vào cluster \\(k\\) nên \\(y_{ik} = 1, y_{ij} = 0, ~\\forall j \\neq k \\). Khi đó, biểu thức bên trên sẽ được viết lại là:\n\\[\ny_{ik}\\|\\mathbf{x}_i - \\mathbf{m}_k\\|_2^2 =  \\sum_{j=1}^K y_{ij}\\|\\mathbf{x}_i - \\mathbf{m}_j\\|_2^2\n\\]</p>", "<p>(<em>Hy vọng chỗ này không quá khó hiểu</em>)</p>", "<em>Hy vọng chỗ này không quá khó hiểu</em>", "<p>Sai số cho toàn bộ dữ liệu sẽ là: \n\\[\n\\mathcal{L}(\\mathbf{Y}, \\mathbf{M}) = \\sum_{i=1}^N\\sum_{j=1}^K y_{ij} \\|\\mathbf{x}_i - \\mathbf{m}_j\\|_2^2\n\\]</p>", "<p>Trong đó \\( \\mathbf{Y} = [\\mathbf{y}_1; \\mathbf{y}_2; \\dots; \\mathbf{y}_N]\\), \\( \\mathbf{M} = [\\mathbf{m}_1, \\mathbf{m}_2, \\dots \\mathbf{m}_K] \\) lần lượt là các ma trận được tạo bởi label vector của mỗi điểm dữ liệu và center của mỗi cluster. Hàm số mất mát trong bài toán K-means clustering của chúng ta là hàm \\(\\mathcal{L}(\\mathbf{Y}, \\mathbf{M})\\) với ràng buộc như được nêu trong phương trình \\((1)\\).</p>", "<p>Tóm lại, chúng ta cần tối ưu bài toán sau: \n\\[\n\\mathbf{Y}, \\mathbf{M} = \\arg\\min_{\\mathbf{Y}, \\mathbf{M}} \\sum_{i=1}^N\\sum_{j=1}^K y_{ij} \\|\\mathbf{x}_i - \\mathbf{m}_j\\|_2^2~~~~~(2)\n\\]</p>", "<p>\\[\n\\text{subject to:} ~~ y_{ij} \\in \\{0, 1\\}~~ \\forall i, j;~~~ \\sum_{j = 1}^K y_{ij} = 1~~\\forall i\n\\]</p>", "<p>(<em>subject to</em> nghĩa là <em>thỏa mãn điều kiện</em>).</p>", "<em>subject to</em>", "<em>thỏa mãn điều kiện</em>", "<p><strong>Nhắc lại khái niệm \\(\\arg\\min\\)</strong>: Chúng ta biết ký hiệu \\(\\min\\) là <em>giá trị nhỏ nhất của hàm số</em>, \\(\\arg\\min\\) chính là <em>giá trị của biến số để hàm số đó đạt giá trị nhỏ nhất đó</em>. Nếu \\(f(x) = x^2 -2x + 1 = (x-1)^2 \\) thì giá trị nhỏ nhất của hàm số này bằng 0, đạt được khi \\(x = 1\\). Trong ví dụ này \\(\\min_{x} f(x) = 0\\) và \\(\\arg\\min_{x} f(x) = 1\\). Thêm ví dụ khác, nếu \\(x_1 = 0, x_2 = 10, x_3 = 5\\) thì ta nói \\(\\arg\\min_{i} x_i = 1\\) vì \\(1\\) là chỉ số để \\(x_i\\) đạt giá trị nhỏ nhất (bằng \\(0\\)). Biến số viết bên dưới \\(\\min\\) là biến số cúng ta cần tối ưu. Trong các bài toán tối ưu, ta thường quan tâm tới \\(\\arg\\min\\) hơn là \\(\\min\\).\n<!-- _K-means còn là một trong những phương pháp thực hiện ước lượng vector [_vector quantization_](https://en.wikipedia.org/wiki/Vector_quantization)_ -->\n<!-- ========================== New Heading ==================== -->\n<a name=\"thuat-toan-toi-uu-ham-mat-mat\"></a></p>", "<strong>Nhắc lại khái niệm \\(\\arg\\min\\)</strong>", "<em>giá trị nhỏ nhất của hàm số</em>", "<em>giá trị của biến số để hàm số đó đạt giá trị nhỏ nhất đó</em>", "<a name=\"thuat-toan-toi-uu-ham-mat-mat\"></a>", "<h3 id=\"thuật-toán-tối-ưu-hàm-mất-mát\">Thuật toán tối ưu hàm mất mát</h3>", "<p>Bài toán \\((2)\\) là một bài toán khó tìm <em>điểm tối ưu</em> vì nó có thêm các điều kiện ràng buộc. <em>Bài toán này thuộc loại mix-integer programming (điều kiện biến là số nguyên) - là loại rất khó tìm nghiệm tối ưu toàn cục (global optimal point, tức nghiệm làm cho hàm mất mát đạt giá trị nhỏ nhất có thể).</em> Tuy nhiên, trong một số trường hợp chúng ta vẫn có thể tìm được phương pháp để tìm được nghiệm gần đúng hoặc điểm cực tiểu. (<em>Nếu chúng ta vẫn nhớ chương trình toán ôn thi đại học thì điểm cực tiểu chưa chắc đã phải là điểm làm cho hàm số đạt giá trị nhỏ nhất</em>).</p>", "<em>điểm tối ưu</em>", "<em>Bài toán này thuộc loại mix-integer programming (điều kiện biến là số nguyên) - là loại rất khó tìm nghiệm tối ưu toàn cục (global optimal point, tức nghiệm làm cho hàm mất mát đạt giá trị nhỏ nhất có thể).</em>", "<em>Nếu chúng ta vẫn nhớ chương trình toán ôn thi đại học thì điểm cực tiểu chưa chắc đã phải là điểm làm cho hàm số đạt giá trị nhỏ nhất</em>", "<p>Một cách đơn giản để giải bài toán \\((2)\\) là xen kẽ giải \\(\\mathbf{Y}\\) và \\( \\mathbf{M}\\) khi biến còn lại được cố định. Đây là một thuật toán lặp, cũng là kỹ thuật phổ biến khi giải bài toán tối ưu. Chúng ta sẽ lần lượt giải quyết hai bài toán sau đây:</p>", "<p><a name=\"co-dinh-\\\\\\mathbfm-\\\\-tim-\\\\\\mathbfy\\\\\"></a></p>", "<a name=\"co-dinh-\\\\\\mathbfm-\\\\-tim-\\\\\\mathbfy\\\\\"></a>", "<h4 id=\"cố-định-mathbfm--tìm-mathbfy\">Cố định \\(\\mathbf{M} \\), tìm \\(\\mathbf{Y}\\)</h4>", "<p><strong>Giả sử đã tìm được các centers, hãy tìm các label vector để hàm mất mát đạt giá trị nhỏ nhất.</strong> Điều này tương đương với việc tìm cluster cho mỗi điểm dữ liệu.</p>", "<strong>Giả sử đã tìm được các centers, hãy tìm các label vector để hàm mất mát đạt giá trị nhỏ nhất.</strong>", "<p>Khi các centers là cố định, bài toán tìm label vector cho toàn bộ dữ liệu có thể được chia nhỏ thành bài toán tìm label vector cho từng điểm dữ liệu \\(\\mathbf{x}_i\\) như sau:</p>", "<p>\\[\n\\mathbf{y}_i = \\arg\\min_{\\mathbf{y}_i} \\sum_{j=1}^K y_{ij}\\|\\mathbf{x}_i - \\mathbf{m}_j\\|_2^2 ~~~ (3)\n\\]\n\\[\n\\text{subject to:} ~~ y_{ij} \\in \\{0, 1\\}~~ \\forall j;~~~ \\sum_{j = 1}^K y_{ij} = 1\n\\]</p>", "<p>Vì chỉ có một phần tử của label vector \\(\\mathbf{y}_i\\) bằng \\(1\\) nên bài toán \\((3)\\) có thể tiếp tục được viết dưới dạng đơn giản hơn: \n\\[\nj = \\arg\\min_{j} \\|\\mathbf{x}_i - \\mathbf{m}_j\\|_2^2\n\\]</p>", "<p>Vì \\(\\|\\mathbf{x}_i - \\mathbf{m}_j\\|_2^2\\) chính là bình phương khoảng cách tính từ điểm \\(\\mathbf{x}_i \\) tới center \\(\\mathbf{m}_j \\), ta có thể kết luận rằng <strong>mỗi điểm \\(\\mathbf{x}_i \\) thuộc vào cluster có center gần nó nhất</strong>! Từ đó ta có thể dễ dàng suy ra label vector của từng điểm dữ liệu.</p>", "<strong>mỗi điểm \\(\\mathbf{x}_i \\) thuộc vào cluster có center gần nó nhất</strong>", "<p><a name=\"co-dinh-\\\\\\mathbfy-\\\\-tim-\\\\\\mathbfm\\\\\"></a></p>", "<a name=\"co-dinh-\\\\\\mathbfy-\\\\-tim-\\\\\\mathbfm\\\\\"></a>", "<h4 id=\"cố-định-mathbfy--tìm-mathbfm\">Cố định \\(\\mathbf{Y} \\), tìm \\(\\mathbf{M}\\)</h4>", "<p><strong>Giả sử đã tìm được cluster cho từng điểm, hãy tìm center mới cho mỗi cluster để hàm mất mát đạt giá trị nhỏ nhất.</strong></p>", "<strong>Giả sử đã tìm được cluster cho từng điểm, hãy tìm center mới cho mỗi cluster để hàm mất mát đạt giá trị nhỏ nhất.</strong>", "<p>Một khi chúng ta đã xác định được label vector cho từng điểm dữ liệu, bài toán tìm center cho mỗi cluster được rút gọn thành:</p>", "<p>\\[\n\\mathbf{m}_j = \\arg\\min_{\\mathbf{m}_j} \\sum_{i = 1}^{N} y_{ij}\\|\\mathbf{x}_i - \\mathbf{m}_j \\|_2^2.\n\\]\n Tới đây, ta có thể tìm nghiệm bằng phương pháp giải đạo hàm bằng 0, vì hàm cần tối ưu là một hàm liên tục và có đạo hàm xác định tại mọi điểm. <em>Và quan trọng hơn, hàm này là hàm convex (lồi) theo \\(\\mathbf{m}_j \\) nên chúng ta sẽ tìm được giá trị nhỏ nhất và điểm tối ưu tương ứng. Sau này nếu có dịp, tôi sẽ nói thêm về tối ưu lồi (convex optimization) - một mảng cực kỳ quan trọng trong toán tối ưu</em>.</p>", "<em>Và quan trọng hơn, hàm này là hàm convex (lồi) theo \\(\\mathbf{m}_j \\) nên chúng ta sẽ tìm được giá trị nhỏ nhất và điểm tối ưu tương ứng. Sau này nếu có dịp, tôi sẽ nói thêm về tối ưu lồi (convex optimization) - một mảng cực kỳ quan trọng trong toán tối ưu</em>", "<p>Đặt \\(l(\\mathbf{m}_j)\\) là hàm bên trong dấu \\(\\arg\\min\\), ta có đạo hàm:\n\\[\n\\frac{\\partial l(\\mathbf{m}_j)}{\\partial \\mathbf{m}_j} = 2\\sum_{i=1}^N y_{ij}(\\mathbf{m}_j - \\mathbf{x}_i) \n\\]</p>", "<p>Giải phương trình đạo hàm bằng 0 ta có: \n\\[\n\\mathbf{m}_j \\sum_{i=1}^N y_{ij} = \\sum_{i=1}^N y_{ij} \\mathbf{x}_i \n\\]\n\\[\n\\Rightarrow \\mathbf{m}_j = \\frac{ \\sum_{i=1}^N y_{ij} \\mathbf{x}_i}{\\sum_{i=1}^N y_{ij}}\n\\]</p>", "<p>Nếu để ý một chút, chúng ta sẽ thấy rằng mẫu số chính là phép đếm <em>số lượng các điểm dữ liệu</em> trong cluster \\(j\\) (<em>Bạn có nhận ra không?</em>). Còn tử số chính là <em>tổng các điểm dữ liệu</em> trong cluster \\(j\\). (<em>Nếu bạn đọc vẫn nhớ điều kiện ràng buộc của các</em> \\(y_{ij} \\) <em>thì sẽ có thể nhanh chóng nhìn ra điều này</em>).</p>", "<em>số lượng các điểm dữ liệu</em>", "<em>Bạn có nhận ra không?</em>", "<em>tổng các điểm dữ liệu</em>", "<em>Nếu bạn đọc vẫn nhớ điều kiện ràng buộc của các</em>", "<em>thì sẽ có thể nhanh chóng nhìn ra điều này</em>", "<p>Hay nói một cách đơn giản hơn nhiều: \\(\\mathbf{m}_j\\) <strong>là trung bình cộng của các điểm trong cluster</strong> \\(j\\).</p>", "<strong>là trung bình cộng của các điểm trong cluster</strong>", "<p>Tên gọi <em>K-means clustering</em> cũng xuất phát từ đây.\n<!-- ========================== New Heading ==================== -->\n<a name=\"tom-tat-thuat-toan\"></a></p>", "<em>K-means clustering</em>", "<a name=\"tom-tat-thuat-toan\"></a>", "<p><a name=\"tom-tat-thuat-toan\"></a></p>", "<a name=\"tom-tat-thuat-toan\"></a>", "<h3 id=\"tóm-tắt-thuật-toán\">Tóm tắt thuật toán</h3>", "<p>Tới đây tôi xin được tóm tắt lại thuật toán (<em>đặc biệt quan trọng với các bạn bỏ qua phần toán học bên trên</em>) như sau:</p>", "<em>đặc biệt quan trọng với các bạn bỏ qua phần toán học bên trên</em>", "<p><strong>Đầu vào:</strong> Dữ liệu \\(\\mathbf{X}\\) và số lượng cluster cần tìm \\(K\\).</p>", "<strong>Đầu vào:</strong>", "<p><strong>Đầu ra:</strong> Các center \\(\\mathbf{M}\\) và label vector cho từng điểm dữ liệu \\(\\mathbf{Y}\\).</p>", "<strong>Đầu ra:</strong>", "<ol>\n<li>Chọn \\(K\\) điểm bất kỳ làm các center ban đầu.</li>\n<li>Phân mỗi điểm dữ liệu vào cluster có center gần nó nhất.</li>\n<li>Nếu việc gán dữ liệu vào từng cluster ở bước 2 không thay đổi so với vòng lặp trước nó thì ta dừng thuật toán.</li>\n<li>Cập nhật center cho từng cluster bằng cách lấy trung bình cộng của tất các các điểm dữ liệu đã được gán vào cluster đó sau bước 2.</li>\n<li>Quay lại bước 2.</li>\n</ol>", "<li>Chọn \\(K\\) điểm bất kỳ làm các center ban đầu.</li>", "<li>Phân mỗi điểm dữ liệu vào cluster có center gần nó nhất.</li>", "<li>Nếu việc gán dữ liệu vào từng cluster ở bước 2 không thay đổi so với vòng lặp trước nó thì ta dừng thuật toán.</li>", "<li>Cập nhật center cho từng cluster bằng cách lấy trung bình cộng của tất các các điểm dữ liệu đã được gán vào cluster đó sau bước 2.</li>", "<li>Quay lại bước 2.</li>", "<p>Chúng ta có thể đảm bảo rằng thuật toán sẽ dừng lại sau một số hữu hạn vòng lặp. Thật vậy, vì hàm mất mát là một số dương và sau mỗi bước 2 hoặc 3, giá trị của hàm mất mát bị giảm đi. Theo kiến thức về dãy số trong chương trình cấp 3: <em>nếu một dãy số giảm và bị chặn dưới thì nó hội tụ!</em> Hơn nữa, số lượng cách phân nhóm cho toàn bộ dữ liệu là hữu hạn nên đến một lúc nào đó, hàm mất mát sẽ không thể thay đổi, và chúng ta có thể dừng thuật toán tại đây.</p>", "<em>nếu một dãy số giảm và bị chặn dưới thì nó hội tụ!</em>", "<p>Chúng ta sẽ có một vài <a href=\"#-thao-luan\">thảo luận</a> về thuật toán này, về những hạn chế và một số phương pháp khắc phục. Nhưng trước hết, hãy xem nó thể hiện như thế nào trong một ví dụ cụ thể dưới đây.</p>", "<a href=\"#-thao-luan\">thảo luận</a>", "<p><a name=\"-vi-du-tren-python\"></a></p>", "<a name=\"-vi-du-tren-python\"></a>"]}, "examples": {"title": "3. Ví dụ trên Python", "content": ["<p><a name=\"gioi-thieu-bai-toan\"></a></p>", "<a name=\"gioi-thieu-bai-toan\"></a>", "<h3 id=\"giới-thiệu-bài-toán\">Giới thiệu bài toán</h3>", "<p>Để kiểm tra mức độ hiểu quả của một thuật toán, chúng ta sẽ làm một ví dụ đơn giản (thường được gọi là <em>toy example</em>). Trước hết, chúng ta chọn center cho từng cluster và tạo dữ liệu cho từng cluster bằng cách lấy mẫu theo phân phối chuẩn có kỳ vọng là center của cluster đó và ma trận hiệp phương sai (covariance matrix) là ma trận đơn vị.</p>", "<em>toy example</em>", "<p>Trước tiên, chúng ta cần khai báo các thư viện cần dùng. Chúng ta cần <code class=\"language-plaintext highlighter-rouge\">numpy</code> và <code class=\"language-plaintext highlighter-rouge\">matplotlib</code> như trong bài <a href=\"/2016/12/28/linearregression/\">Linear Regression</a> cho việc tính toán ma trận và hiển thị dữ liệu. Chúng ta cũng cần thêm thư viện <code class=\"language-plaintext highlighter-rouge\">scipy.spatial.distance</code> để tính khoảng cách giữa các cặp điểm trong hai tập hợp một cách hiệu quả.</p>", "<code class=\"language-plaintext highlighter-rouge\">numpy</code>", "<code class=\"language-plaintext highlighter-rouge\">matplotlib</code>", "<a href=\"/2016/12/28/linearregression/\">Linear Regression</a>", "<code class=\"language-plaintext highlighter-rouge\">scipy.spatial.distance</code>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"kn\">import</span> <span class=\"n\">print_function</span> \n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.spatial.distance</span> <span class=\"kn\">import</span> <span class=\"n\">cdist</span>\n<span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">seed</span><span class=\"p\">(</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"kn\">import</span> <span class=\"n\">print_function</span> \n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.spatial.distance</span> <span class=\"kn\">import</span> <span class=\"n\">cdist</span>\n<span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">seed</span><span class=\"p\">(</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"kn\">import</span> <span class=\"n\">print_function</span> \n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.spatial.distance</span> <span class=\"kn\">import</span> <span class=\"n\">cdist</span>\n<span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">seed</span><span class=\"p\">(</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n</code></pre>", "<code><span class=\"kn\">from</span> <span class=\"nn\">__future__</span> <span class=\"kn\">import</span> <span class=\"n\">print_function</span> \n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy.spatial.distance</span> <span class=\"kn\">import</span> <span class=\"n\">cdist</span>\n<span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">seed</span><span class=\"p\">(</span><span class=\"mi\">11</span><span class=\"p\">)</span>\n</code>", "<span class=\"kn\">from</span>", "<span class=\"nn\">__future__</span>", "<span class=\"kn\">import</span>", "<span class=\"n\">print_function</span>", "<span class=\"kn\">import</span>", "<span class=\"nn\">numpy</span>", "<span class=\"k\">as</span>", "<span class=\"n\">np</span>", "<span class=\"kn\">import</span>", "<span class=\"nn\">matplotlib.pyplot</span>", "<span class=\"k\">as</span>", "<span class=\"n\">plt</span>", "<span class=\"kn\">from</span>", "<span class=\"nn\">scipy.spatial.distance</span>", "<span class=\"kn\">import</span>", "<span class=\"n\">cdist</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">random</span>", "<span class=\"p\">.</span>", "<span class=\"n\">seed</span>", "<span class=\"p\">(</span>", "<span class=\"mi\">11</span>", "<span class=\"p\">)</span>", "<p>Tiếp theo, ta tạo dữ liệu bằng cách lấy các điểm theo phân phối chuẩn có kỳ vọng tại các điểm có tọa độ <code class=\"language-plaintext highlighter-rouge\">(2, 2), (8, 3)</code> và <code class=\"language-plaintext highlighter-rouge\">(3, 6)</code>, ma trận hiệp phương sai giống nhau và là ma trận đơn vị. Mỗi cluster có 500 điểm. (<em>Chú ý rằng mỗi điểm dữ liệu là một hàng của ma trận dữ liệu.</em></p>", "<code class=\"language-plaintext highlighter-rouge\">(2, 2), (8, 3)</code>", "<code class=\"language-plaintext highlighter-rouge\">(3, 6)</code>", "<em>Chú ý rằng mỗi điểm dữ liệu là một hàng của ma trận dữ liệu.</em>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">means</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">]]</span>\n<span class=\"n\">cov</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"mi\">500</span>\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">concatenate</span><span class=\"p\">((</span><span class=\"n\">X0</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">),</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"mi\">3</span>\n\n<span class=\"n\">original_label</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">asarray</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span><span class=\"p\">).</span><span class=\"n\">T</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">means</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">]]</span>\n<span class=\"n\">cov</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"mi\">500</span>\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">concatenate</span><span class=\"p\">((</span><span class=\"n\">X0</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">),</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"mi\">3</span>\n\n<span class=\"n\">original_label</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">asarray</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span><span class=\"p\">).</span><span class=\"n\">T</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"n\">means</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">]]</span>\n<span class=\"n\">cov</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"mi\">500</span>\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">concatenate</span><span class=\"p\">((</span><span class=\"n\">X0</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">),</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"mi\">3</span>\n\n<span class=\"n\">original_label</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">asarray</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span><span class=\"p\">).</span><span class=\"n\">T</span>\n</code></pre>", "<code><span class=\"n\">means</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">8</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">]]</span>\n<span class=\"n\">cov</span> <span class=\"o\">=</span> <span class=\"p\">[[</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">]]</span>\n<span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"mi\">500</span>\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">multivariate_normal</span><span class=\"p\">(</span><span class=\"n\">means</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"n\">cov</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">concatenate</span><span class=\"p\">((</span><span class=\"n\">X0</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">),</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n<span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"mi\">3</span>\n\n<span class=\"n\">original_label</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">asarray</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span><span class=\"o\">*</span><span class=\"n\">N</span><span class=\"p\">).</span><span class=\"n\">T</span>\n</code>", "<span class=\"n\">means</span>", "<span class=\"o\">=</span>", "<span class=\"p\">[[</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">,</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">],</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">8</span>", "<span class=\"p\">,</span>", "<span class=\"mi\">3</span>", "<span class=\"p\">],</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">3</span>", "<span class=\"p\">,</span>", "<span class=\"mi\">6</span>", "<span class=\"p\">]]</span>", "<span class=\"n\">cov</span>", "<span class=\"o\">=</span>", "<span class=\"p\">[[</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">,</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">],</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">,</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">]]</span>", "<span class=\"n\">N</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">500</span>", "<span class=\"n\">X0</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">random</span>", "<span class=\"p\">.</span>", "<span class=\"n\">multivariate_normal</span>", "<span class=\"p\">(</span>", "<span class=\"n\">means</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">],</span>", "<span class=\"n\">cov</span>", "<span class=\"p\">,</span>", "<span class=\"n\">N</span>", "<span class=\"p\">)</span>", "<span class=\"n\">X1</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">random</span>", "<span class=\"p\">.</span>", "<span class=\"n\">multivariate_normal</span>", "<span class=\"p\">(</span>", "<span class=\"n\">means</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">],</span>", "<span class=\"n\">cov</span>", "<span class=\"p\">,</span>", "<span class=\"n\">N</span>", "<span class=\"p\">)</span>", "<span class=\"n\">X2</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">random</span>", "<span class=\"p\">.</span>", "<span class=\"n\">multivariate_normal</span>", "<span class=\"p\">(</span>", "<span class=\"n\">means</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">],</span>", "<span class=\"n\">cov</span>", "<span class=\"p\">,</span>", "<span class=\"n\">N</span>", "<span class=\"p\">)</span>", "<span class=\"n\">X</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">concatenate</span>", "<span class=\"p\">((</span>", "<span class=\"n\">X0</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X1</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X2</span>", "<span class=\"p\">),</span>", "<span class=\"n\">axis</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">)</span>", "<span class=\"n\">K</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">3</span>", "<span class=\"n\">original_label</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">asarray</span>", "<span class=\"p\">([</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">]</span>", "<span class=\"o\">*</span>", "<span class=\"n\">N</span>", "<span class=\"o\">+</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">]</span>", "<span class=\"o\">*</span>", "<span class=\"n\">N</span>", "<span class=\"o\">+</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">]</span>", "<span class=\"o\">*</span>", "<span class=\"n\">N</span>", "<span class=\"p\">).</span>", "<span class=\"n\">T</span>", "<p><a name=\"hien-thi-du-lieu-tren-do-thi\"></a></p>", "<a name=\"hien-thi-du-lieu-tren-do-thi\"></a>", "<h3 id=\"hiển-thị-dữ-liệu-trên-đồ-thị\">Hiển thị dữ liệu trên đồ thị</h3>", "<p>Chúng ta cần một hàm <code class=\"language-plaintext highlighter-rouge\">kmeans_display</code> để hiển thị dữ liệu. Sau đó hiển thị dữ liệu theo nhãn ban đầu.</p>", "<code class=\"language-plaintext highlighter-rouge\">kmeans_display</code>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"p\">):</span>\n    <span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">amax</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n    <span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    \n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'b^'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'go'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'rs'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s\">'equal'</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">()</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n    \n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">original_label</span><span class=\"p\">)</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"p\">):</span>\n    <span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">amax</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n    <span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    \n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'b^'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'go'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'rs'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s\">'equal'</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">()</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n    \n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">original_label</span><span class=\"p\">)</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"p\">):</span>\n    <span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">amax</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n    <span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    \n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'b^'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'go'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'rs'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s\">'equal'</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">()</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n    \n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">original_label</span><span class=\"p\">)</span>\n</code></pre>", "<code><span class=\"k\">def</span> <span class=\"nf\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"p\">):</span>\n    <span class=\"n\">K</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">amax</span><span class=\"p\">(</span><span class=\"n\">label</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mi\">1</span>\n    <span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    <span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n    \n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X0</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'b^'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X1</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'go'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">X2</span><span class=\"p\">[:,</span> <span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"s\">'rs'</span><span class=\"p\">,</span> <span class=\"n\">markersize</span> <span class=\"o\">=</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"n\">alpha</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">8</span><span class=\"p\">)</span>\n\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">axis</span><span class=\"p\">(</span><span class=\"s\">'equal'</span><span class=\"p\">)</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">()</span>\n    <span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n    \n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">original_label</span><span class=\"p\">)</span>\n</code>", "<span class=\"k\">def</span>", "<span class=\"nf\">kmeans_display</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">label</span>", "<span class=\"p\">):</span>", "<span class=\"n\">K</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">amax</span>", "<span class=\"p\">(</span>", "<span class=\"n\">label</span>", "<span class=\"p\">)</span>", "<span class=\"o\">+</span>", "<span class=\"mi\">1</span>", "<span class=\"n\">X0</span>", "<span class=\"o\">=</span>", "<span class=\"n\">X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">label</span>", "<span class=\"o\">==</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">,</span>", "<span class=\"p\">:]</span>", "<span class=\"n\">X1</span>", "<span class=\"o\">=</span>", "<span class=\"n\">X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">label</span>", "<span class=\"o\">==</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">,</span>", "<span class=\"p\">:]</span>", "<span class=\"n\">X2</span>", "<span class=\"o\">=</span>", "<span class=\"n\">X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">label</span>", "<span class=\"o\">==</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">,</span>", "<span class=\"p\">:]</span>", "<span class=\"n\">plt</span>", "<span class=\"p\">.</span>", "<span class=\"n\">plot</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X0</span>", "<span class=\"p\">[:,</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">],</span>", "<span class=\"n\">X0</span>", "<span class=\"p\">[:,</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">],</span>", "<span class=\"s\">'b^'</span>", "<span class=\"p\">,</span>", "<span class=\"n\">markersize</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">4</span>", "<span class=\"p\">,</span>", "<span class=\"n\">alpha</span>", "<span class=\"o\">=</span>", "<span class=\"p\">.</span>", "<span class=\"mi\">8</span>", "<span class=\"p\">)</span>", "<span class=\"n\">plt</span>", "<span class=\"p\">.</span>", "<span class=\"n\">plot</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X1</span>", "<span class=\"p\">[:,</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">],</span>", "<span class=\"n\">X1</span>", "<span class=\"p\">[:,</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">],</span>", "<span class=\"s\">'go'</span>", "<span class=\"p\">,</span>", "<span class=\"n\">markersize</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">4</span>", "<span class=\"p\">,</span>", "<span class=\"n\">alpha</span>", "<span class=\"o\">=</span>", "<span class=\"p\">.</span>", "<span class=\"mi\">8</span>", "<span class=\"p\">)</span>", "<span class=\"n\">plt</span>", "<span class=\"p\">.</span>", "<span class=\"n\">plot</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X2</span>", "<span class=\"p\">[:,</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">],</span>", "<span class=\"n\">X2</span>", "<span class=\"p\">[:,</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">],</span>", "<span class=\"s\">'rs'</span>", "<span class=\"p\">,</span>", "<span class=\"n\">markersize</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">4</span>", "<span class=\"p\">,</span>", "<span class=\"n\">alpha</span>", "<span class=\"o\">=</span>", "<span class=\"p\">.</span>", "<span class=\"mi\">8</span>", "<span class=\"p\">)</span>", "<span class=\"n\">plt</span>", "<span class=\"p\">.</span>", "<span class=\"n\">axis</span>", "<span class=\"p\">(</span>", "<span class=\"s\">'equal'</span>", "<span class=\"p\">)</span>", "<span class=\"n\">plt</span>", "<span class=\"p\">.</span>", "<span class=\"n\">plot</span>", "<span class=\"p\">()</span>", "<span class=\"n\">plt</span>", "<span class=\"p\">.</span>", "<span class=\"n\">show</span>", "<span class=\"p\">()</span>", "<span class=\"n\">kmeans_display</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">original_label</span>", "<span class=\"p\">)</span>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/kmeans/output_5_0.png\"/>\n</div>", "<img align=\"center\" src=\"/assets/kmeans/output_5_0.png\"/>", "<p>Trong đồ thị trên, mỗi cluster tương ứng với một màu. Có thể nhận thấy rằng có một vài điểm màu đỏ bị lẫn sang phần cluster màu xanh.\n<!-- ========================== New Heading ==================== -->\n<a name=\"cac-ham-so-can-thiet-cho-k-means-clustering\"></a></p>", "<a name=\"cac-ham-so-can-thiet-cho-k-means-clustering\"></a>", "<p><a name=\"cac-ham-so-can-thiet-cho-k-means-clustering\"></a></p>", "<a name=\"cac-ham-so-can-thiet-cho-k-means-clustering\"></a>", "<h3 id=\"các-hàm-số-cần-thiết-cho-k-means-clustering\">Các hàm số cần thiết cho K-means clustering</h3>", "<p>Viết các hàm:</p>", "<ol>\n<li><code class=\"language-plaintext highlighter-rouge\">kmeans_init_centers</code> để khởi tạo các centers ban đầu.</li>\n<li><code class=\"language-plaintext highlighter-rouge\">kmeans_asign_labels</code> để gán nhán mới cho các điểm khi biết các centers.</li>\n<li><code class=\"language-plaintext highlighter-rouge\">kmeans_update_centers</code> để cập nhật các centers mới dữa trên dữ liệu vừa được gán nhãn.</li>\n<li><code class=\"language-plaintext highlighter-rouge\">has_converged</code> để kiểm tra điều kiện dừng của thuật toán.</li>\n</ol>", "<li><code class=\"language-plaintext highlighter-rouge\">kmeans_init_centers</code> để khởi tạo các centers ban đầu.</li>", "<code class=\"language-plaintext highlighter-rouge\">kmeans_init_centers</code>", "<li><code class=\"language-plaintext highlighter-rouge\">kmeans_asign_labels</code> để gán nhán mới cho các điểm khi biết các centers.</li>", "<code class=\"language-plaintext highlighter-rouge\">kmeans_asign_labels</code>", "<li><code class=\"language-plaintext highlighter-rouge\">kmeans_update_centers</code> để cập nhật các centers mới dữa trên dữ liệu vừa được gán nhãn.</li>", "<code class=\"language-plaintext highlighter-rouge\">kmeans_update_centers</code>", "<li><code class=\"language-plaintext highlighter-rouge\">has_converged</code> để kiểm tra điều kiện dừng của thuật toán.</li>", "<code class=\"language-plaintext highlighter-rouge\">has_converged</code>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">k</span><span class=\"p\">):</span>\n    <span class=\"c1\"># randomly pick k rows of X as initial centers\n</span>    <span class=\"k\">return</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">choice</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">replace</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">)]</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># calculate pairwise distances btw data and centers\n</span>    <span class=\"n\">D</span> <span class=\"o\">=</span> <span class=\"n\">cdist</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">)</span>\n    <span class=\"c1\"># return index of the closest center\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">D</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"n\">K</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n    <span class=\"k\">for</span> <span class=\"n\">k</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">):</span>\n        <span class=\"c1\"># collect all points assigned to the k-th cluster \n</span>        <span class=\"n\">Xk</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">labels</span> <span class=\"o\">==</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n        <span class=\"c1\"># take average\n</span>        <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">,:]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">Xk</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">centers</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># return True if two sets of centers are the same\n</span>    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">centers</span><span class=\"p\">])</span> <span class=\"o\">==</span> \n        <span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">new_centers</span><span class=\"p\">]))</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">k</span><span class=\"p\">):</span>\n    <span class=\"c1\"># randomly pick k rows of X as initial centers\n</span>    <span class=\"k\">return</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">choice</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">replace</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">)]</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># calculate pairwise distances btw data and centers\n</span>    <span class=\"n\">D</span> <span class=\"o\">=</span> <span class=\"n\">cdist</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">)</span>\n    <span class=\"c1\"># return index of the closest center\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">D</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"n\">K</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n    <span class=\"k\">for</span> <span class=\"n\">k</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">):</span>\n        <span class=\"c1\"># collect all points assigned to the k-th cluster \n</span>        <span class=\"n\">Xk</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">labels</span> <span class=\"o\">==</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n        <span class=\"c1\"># take average\n</span>        <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">,:]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">Xk</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">centers</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># return True if two sets of centers are the same\n</span>    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">centers</span><span class=\"p\">])</span> <span class=\"o\">==</span> \n        <span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">new_centers</span><span class=\"p\">]))</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">k</span><span class=\"p\">):</span>\n    <span class=\"c1\"># randomly pick k rows of X as initial centers\n</span>    <span class=\"k\">return</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">choice</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">replace</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">)]</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># calculate pairwise distances btw data and centers\n</span>    <span class=\"n\">D</span> <span class=\"o\">=</span> <span class=\"n\">cdist</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">)</span>\n    <span class=\"c1\"># return index of the closest center\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">D</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"n\">K</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n    <span class=\"k\">for</span> <span class=\"n\">k</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">):</span>\n        <span class=\"c1\"># collect all points assigned to the k-th cluster \n</span>        <span class=\"n\">Xk</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">labels</span> <span class=\"o\">==</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n        <span class=\"c1\"># take average\n</span>        <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">,:]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">Xk</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">centers</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># return True if two sets of centers are the same\n</span>    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">centers</span><span class=\"p\">])</span> <span class=\"o\">==</span> \n        <span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">new_centers</span><span class=\"p\">]))</span>\n</code></pre>", "<code><span class=\"k\">def</span> <span class=\"nf\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">k</span><span class=\"p\">):</span>\n    <span class=\"c1\"># randomly pick k rows of X as initial centers\n</span>    <span class=\"k\">return</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">choice</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">replace</span><span class=\"o\">=</span><span class=\"bp\">False</span><span class=\"p\">)]</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># calculate pairwise distances btw data and centers\n</span>    <span class=\"n\">D</span> <span class=\"o\">=</span> <span class=\"n\">cdist</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">)</span>\n    <span class=\"c1\"># return index of the closest center\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">argmin</span><span class=\"p\">(</span><span class=\"n\">D</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"n\">K</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n    <span class=\"k\">for</span> <span class=\"n\">k</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">K</span><span class=\"p\">):</span>\n        <span class=\"c1\"># collect all points assigned to the k-th cluster \n</span>        <span class=\"n\">Xk</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[</span><span class=\"n\">labels</span> <span class=\"o\">==</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"p\">:]</span>\n        <span class=\"c1\"># take average\n</span>        <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"n\">k</span><span class=\"p\">,:]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">mean</span><span class=\"p\">(</span><span class=\"n\">Xk</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"k\">return</span> <span class=\"n\">centers</span>\n\n<span class=\"k\">def</span> <span class=\"nf\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n    <span class=\"c1\"># return True if two sets of centers are the same\n</span>    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">centers</span><span class=\"p\">])</span> <span class=\"o\">==</span> \n        <span class=\"nb\">set</span><span class=\"p\">([</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">a</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">a</span> <span class=\"ow\">in</span> <span class=\"n\">new_centers</span><span class=\"p\">]))</span>\n</code>", "<span class=\"k\">def</span>", "<span class=\"nf\">kmeans_init_centers</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">k</span>", "<span class=\"p\">):</span>", "<span class=\"c1\"># randomly pick k rows of X as initial centers\n</span>", "<span class=\"k\">return</span>", "<span class=\"n\">X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">random</span>", "<span class=\"p\">.</span>", "<span class=\"n\">choice</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">.</span>", "<span class=\"n\">shape</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">],</span>", "<span class=\"n\">k</span>", "<span class=\"p\">,</span>", "<span class=\"n\">replace</span>", "<span class=\"o\">=</span>", "<span class=\"bp\">False</span>", "<span class=\"p\">)]</span>", "<span class=\"k\">def</span>", "<span class=\"nf\">kmeans_assign_labels</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">):</span>", "<span class=\"c1\"># calculate pairwise distances btw data and centers\n</span>", "<span class=\"n\">D</span>", "<span class=\"o\">=</span>", "<span class=\"n\">cdist</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">)</span>", "<span class=\"c1\"># return index of the closest center\n</span>", "<span class=\"k\">return</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">argmin</span>", "<span class=\"p\">(</span>", "<span class=\"n\">D</span>", "<span class=\"p\">,</span>", "<span class=\"n\">axis</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">)</span>", "<span class=\"k\">def</span>", "<span class=\"nf\">kmeans_update_centers</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">labels</span>", "<span class=\"p\">,</span>", "<span class=\"n\">K</span>", "<span class=\"p\">):</span>", "<span class=\"n\">centers</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">zeros</span>", "<span class=\"p\">((</span>", "<span class=\"n\">K</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X</span>", "<span class=\"p\">.</span>", "<span class=\"n\">shape</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">]))</span>", "<span class=\"k\">for</span>", "<span class=\"n\">k</span>", "<span class=\"ow\">in</span>", "<span class=\"nb\">range</span>", "<span class=\"p\">(</span>", "<span class=\"n\">K</span>", "<span class=\"p\">):</span>", "<span class=\"c1\"># collect all points assigned to the k-th cluster \n</span>", "<span class=\"n\">Xk</span>", "<span class=\"o\">=</span>", "<span class=\"n\">X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">labels</span>", "<span class=\"o\">==</span>", "<span class=\"n\">k</span>", "<span class=\"p\">,</span>", "<span class=\"p\">:]</span>", "<span class=\"c1\"># take average\n</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">[</span>", "<span class=\"n\">k</span>", "<span class=\"p\">,:]</span>", "<span class=\"o\">=</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">mean</span>", "<span class=\"p\">(</span>", "<span class=\"n\">Xk</span>", "<span class=\"p\">,</span>", "<span class=\"n\">axis</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">)</span>", "<span class=\"k\">return</span>", "<span class=\"n\">centers</span>", "<span class=\"k\">def</span>", "<span class=\"nf\">has_converged</span>", "<span class=\"p\">(</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">,</span>", "<span class=\"n\">new_centers</span>", "<span class=\"p\">):</span>", "<span class=\"c1\"># return True if two sets of centers are the same\n</span>", "<span class=\"k\">return</span>", "<span class=\"p\">(</span>", "<span class=\"nb\">set</span>", "<span class=\"p\">([</span>", "<span class=\"nb\">tuple</span>", "<span class=\"p\">(</span>", "<span class=\"n\">a</span>", "<span class=\"p\">)</span>", "<span class=\"k\">for</span>", "<span class=\"n\">a</span>", "<span class=\"ow\">in</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">])</span>", "<span class=\"o\">==</span>", "<span class=\"nb\">set</span>", "<span class=\"p\">([</span>", "<span class=\"nb\">tuple</span>", "<span class=\"p\">(</span>", "<span class=\"n\">a</span>", "<span class=\"p\">)</span>", "<span class=\"k\">for</span>", "<span class=\"n\">a</span>", "<span class=\"ow\">in</span>", "<span class=\"n\">new_centers</span>", "<span class=\"p\">]))</span>", "<p>Phần chính của K-means clustering:</p>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)]</span>\n    <span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"n\">it</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> \n    <span class=\"k\">while</span> <span class=\"bp\">True</span><span class=\"p\">:</span>\n        <span class=\"n\">labels</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n        <span class=\"n\">new_centers</span> <span class=\"o\">=</span> <span class=\"n\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n            <span class=\"k\">break</span>\n        <span class=\"n\">centers</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">new_centers</span><span class=\"p\">)</span>\n        <span class=\"n\">it</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)]</span>\n    <span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"n\">it</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> \n    <span class=\"k\">while</span> <span class=\"bp\">True</span><span class=\"p\">:</span>\n        <span class=\"n\">labels</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n        <span class=\"n\">new_centers</span> <span class=\"o\">=</span> <span class=\"n\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n            <span class=\"k\">break</span>\n        <span class=\"n\">centers</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">new_centers</span><span class=\"p\">)</span>\n        <span class=\"n\">it</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)]</span>\n    <span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"n\">it</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> \n    <span class=\"k\">while</span> <span class=\"bp\">True</span><span class=\"p\">:</span>\n        <span class=\"n\">labels</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n        <span class=\"n\">new_centers</span> <span class=\"o\">=</span> <span class=\"n\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n            <span class=\"k\">break</span>\n        <span class=\"n\">centers</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">new_centers</span><span class=\"p\">)</span>\n        <span class=\"n\">it</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span>\n</code></pre>", "<code><span class=\"k\">def</span> <span class=\"nf\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">):</span>\n    <span class=\"n\">centers</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">kmeans_init_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)]</span>\n    <span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n    <span class=\"n\">it</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> \n    <span class=\"k\">while</span> <span class=\"bp\">True</span><span class=\"p\">:</span>\n        <span class=\"n\">labels</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">kmeans_assign_labels</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]))</span>\n        <span class=\"n\">new_centers</span> <span class=\"o\">=</span> <span class=\"n\">kmeans_update_centers</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">has_converged</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">new_centers</span><span class=\"p\">):</span>\n            <span class=\"k\">break</span>\n        <span class=\"n\">centers</span><span class=\"p\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">new_centers</span><span class=\"p\">)</span>\n        <span class=\"n\">it</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n    <span class=\"k\">return</span> <span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span>\n</code>", "<span class=\"k\">def</span>", "<span class=\"nf\">kmeans</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">K</span>", "<span class=\"p\">):</span>", "<span class=\"n\">centers</span>", "<span class=\"o\">=</span>", "<span class=\"p\">[</span>", "<span class=\"n\">kmeans_init_centers</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">K</span>", "<span class=\"p\">)]</span>", "<span class=\"n\">labels</span>", "<span class=\"o\">=</span>", "<span class=\"p\">[]</span>", "<span class=\"n\">it</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">0</span>", "<span class=\"k\">while</span>", "<span class=\"bp\">True</span>", "<span class=\"p\">:</span>", "<span class=\"n\">labels</span>", "<span class=\"p\">.</span>", "<span class=\"n\">append</span>", "<span class=\"p\">(</span>", "<span class=\"n\">kmeans_assign_labels</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">[</span>", "<span class=\"o\">-</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">]))</span>", "<span class=\"n\">new_centers</span>", "<span class=\"o\">=</span>", "<span class=\"n\">kmeans_update_centers</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">labels</span>", "<span class=\"p\">[</span>", "<span class=\"o\">-</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">],</span>", "<span class=\"n\">K</span>", "<span class=\"p\">)</span>", "<span class=\"k\">if</span>", "<span class=\"n\">has_converged</span>", "<span class=\"p\">(</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">[</span>", "<span class=\"o\">-</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">],</span>", "<span class=\"n\">new_centers</span>", "<span class=\"p\">):</span>", "<span class=\"k\">break</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">.</span>", "<span class=\"n\">append</span>", "<span class=\"p\">(</span>", "<span class=\"n\">new_centers</span>", "<span class=\"p\">)</span>", "<span class=\"n\">it</span>", "<span class=\"o\">+=</span>", "<span class=\"mi\">1</span>", "<span class=\"k\">return</span>", "<span class=\"p\">(</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">,</span>", "<span class=\"n\">labels</span>", "<span class=\"p\">,</span>", "<span class=\"n\">it</span>", "<span class=\"p\">)</span>", "<p>Áp dụng thuật toán vừa viết vào dữ liệu ban đầu, hiển thị kết quả cuối cùng.</p>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by our algorithm:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by our algorithm:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by our algorithm:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n</code></pre>", "<code><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">,</span> <span class=\"n\">it</span><span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">K</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by our algorithm:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">centers</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">labels</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">])</span>\n</code>", "<span class=\"p\">(</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">,</span>", "<span class=\"n\">labels</span>", "<span class=\"p\">,</span>", "<span class=\"n\">it</span>", "<span class=\"p\">)</span>", "<span class=\"o\">=</span>", "<span class=\"n\">kmeans</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">K</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"p\">(</span>", "<span class=\"s\">'Centers found by our algorithm:'</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"p\">(</span>", "<span class=\"n\">centers</span>", "<span class=\"p\">[</span>", "<span class=\"o\">-</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">])</span>", "<span class=\"n\">kmeans_display</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">labels</span>", "<span class=\"p\">[</span>", "<span class=\"o\">-</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">])</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Centers found by our algorithm:\n[[ 1.97563391  2.01568065]\n [ 8.03643517  3.02468432]\n [ 2.99084705  6.04196062]]\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Centers found by our algorithm:\n[[ 1.97563391  2.01568065]\n [ 8.03643517  3.02468432]\n [ 2.99084705  6.04196062]]\n</code></pre></div>", "<pre class=\"highlight\"><code>Centers found by our algorithm:\n[[ 1.97563391  2.01568065]\n [ 8.03643517  3.02468432]\n [ 2.99084705  6.04196062]]\n</code></pre>", "<code>Centers found by our algorithm:\n[[ 1.97563391  2.01568065]\n [ 8.03643517  3.02468432]\n [ 2.99084705  6.04196062]]\n</code>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/kmeans/output_11_1.png\"/>\n</div>", "<img align=\"center\" src=\"/assets/kmeans/output_11_1.png\"/>", "<p>Từ kết quả này chúng ta thấy rằng thuật toán K-means clustering làm việc khá thành công, các centers tìm được khá gần với kỳ vọng ban đầu. Các điểm thuộc cùng một cluster hầu như được phân vào cùng một cluster (trừ một số điểm màu đỏ ban đầu đã bị phân nhầm vào cluster màu xanh da trời, nhưng tỉ lệ là nhỏ và có thể chấp nhận được).</p>", "<p>Dưới đây là hình ảnh động minh họa thuật toán qua từng vòng lặp, chúng ta thấy rằng thuật toán trên hội tụ rất nhanh, chỉ cần 6 vòng lặp để có được kết quả cuối cùng:</p>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/kmeans/kmeans11.gif\"/>\n</div>", "<img align=\"center\" src=\"/assets/kmeans/kmeans11.gif\"/>", "<p>Các bạn có thể xem thêm các trang web minh họa thuật toán K-means cluster tại:</p>", "<ol>\n<li><a href=\"https://www.naftaliharris.com/blog/visualizing-k-means-clustering/\">Visualizing K-Means Clustering</a></li>\n<li><a href=\"http://stanford.edu/class/ee103/visualizations/kmeans/kmeans.html\">Visualizing K-Means Clustering - Standford</a></li>\n</ol>", "<li><a href=\"https://www.naftaliharris.com/blog/visualizing-k-means-clustering/\">Visualizing K-Means Clustering</a></li>", "<a href=\"https://www.naftaliharris.com/blog/visualizing-k-means-clustering/\">Visualizing K-Means Clustering</a>", "<li><a href=\"http://stanford.edu/class/ee103/visualizations/kmeans/kmeans.html\">Visualizing K-Means Clustering - Standford</a></li>", "<a href=\"http://stanford.edu/class/ee103/visualizations/kmeans/kmeans.html\">Visualizing K-Means Clustering - Standford</a>", "<p><a name=\"ket-qua-tim-duoc-bang-thu-vien-scikit-learn\"></a></p>", "<a name=\"ket-qua-tim-duoc-bang-thu-vien-scikit-learn\"></a>", "<p><a name=\"ket-qua-tim-duoc-bang-thu-vien-scikit-learn\"></a></p>", "<a name=\"ket-qua-tim-duoc-bang-thu-vien-scikit-learn\"></a>", "<h3 id=\"kết-quả-tìm-được-bằng-thư-viện-scikit-learn\">Kết quả tìm được bằng thư viện scikit-learn</h3>", "<p>Để kiểm tra thêm, chúng ta hãy so sánh kết quả trên với kết quả thu được bằng cách sử dụng thư viện <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html\"><code class=\"language-plaintext highlighter-rouge\">scikit-learn</code></a>.</p>", "<a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html\"><code class=\"language-plaintext highlighter-rouge\">scikit-learn</code></a>", "<code class=\"language-plaintext highlighter-rouge\">scikit-learn</code>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.cluster</span> <span class=\"kn\">import</span> <span class=\"n\">KMeans</span>\n<span class=\"n\">kmeans</span> <span class=\"o\">=</span> <span class=\"n\">KMeans</span><span class=\"p\">(</span><span class=\"n\">n_clusters</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">).</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by scikit-learn:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">cluster_centers_</span><span class=\"p\">)</span>\n<span class=\"n\">pred_label</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">pred_label</span><span class=\"p\">)</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.cluster</span> <span class=\"kn\">import</span> <span class=\"n\">KMeans</span>\n<span class=\"n\">kmeans</span> <span class=\"o\">=</span> <span class=\"n\">KMeans</span><span class=\"p\">(</span><span class=\"n\">n_clusters</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">).</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by scikit-learn:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">cluster_centers_</span><span class=\"p\">)</span>\n<span class=\"n\">pred_label</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">pred_label</span><span class=\"p\">)</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.cluster</span> <span class=\"kn\">import</span> <span class=\"n\">KMeans</span>\n<span class=\"n\">kmeans</span> <span class=\"o\">=</span> <span class=\"n\">KMeans</span><span class=\"p\">(</span><span class=\"n\">n_clusters</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">).</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by scikit-learn:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">cluster_centers_</span><span class=\"p\">)</span>\n<span class=\"n\">pred_label</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">pred_label</span><span class=\"p\">)</span>\n</code></pre>", "<code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.cluster</span> <span class=\"kn\">import</span> <span class=\"n\">KMeans</span>\n<span class=\"n\">kmeans</span> <span class=\"o\">=</span> <span class=\"n\">KMeans</span><span class=\"p\">(</span><span class=\"n\">n_clusters</span><span class=\"o\">=</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"n\">random_state</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">).</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"s\">'Centers found by scikit-learn:'</span><span class=\"p\">)</span>\n<span class=\"k\">print</span><span class=\"p\">(</span><span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">cluster_centers_</span><span class=\"p\">)</span>\n<span class=\"n\">pred_label</span> <span class=\"o\">=</span> <span class=\"n\">kmeans</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>\n<span class=\"n\">kmeans_display</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">pred_label</span><span class=\"p\">)</span>\n</code>", "<span class=\"kn\">from</span>", "<span class=\"nn\">sklearn.cluster</span>", "<span class=\"kn\">import</span>", "<span class=\"n\">KMeans</span>", "<span class=\"n\">kmeans</span>", "<span class=\"o\">=</span>", "<span class=\"n\">KMeans</span>", "<span class=\"p\">(</span>", "<span class=\"n\">n_clusters</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">3</span>", "<span class=\"p\">,</span>", "<span class=\"n\">random_state</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">).</span>", "<span class=\"n\">fit</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"p\">(</span>", "<span class=\"s\">'Centers found by scikit-learn:'</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"p\">(</span>", "<span class=\"n\">kmeans</span>", "<span class=\"p\">.</span>", "<span class=\"n\">cluster_centers_</span>", "<span class=\"p\">)</span>", "<span class=\"n\">pred_label</span>", "<span class=\"o\">=</span>", "<span class=\"n\">kmeans</span>", "<span class=\"p\">.</span>", "<span class=\"n\">predict</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">)</span>", "<span class=\"n\">kmeans_display</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">pred_label</span>", "<span class=\"p\">)</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Centers found by scikit-learn:\n[[ 8.0410628   3.02094748]\n [ 2.99357611  6.03605255]\n [ 1.97634981  2.01123694]]\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Centers found by scikit-learn:\n[[ 8.0410628   3.02094748]\n [ 2.99357611  6.03605255]\n [ 1.97634981  2.01123694]]\n</code></pre></div>", "<pre class=\"highlight\"><code>Centers found by scikit-learn:\n[[ 8.0410628   3.02094748]\n [ 2.99357611  6.03605255]\n [ 1.97634981  2.01123694]]\n</code></pre>", "<code>Centers found by scikit-learn:\n[[ 8.0410628   3.02094748]\n [ 2.99357611  6.03605255]\n [ 1.97634981  2.01123694]]\n</code>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/kmeans/output_14_1.png\"/>\n</div>", "<img align=\"center\" src=\"/assets/kmeans/output_14_1.png\"/>", "<p>Thật may mắn (<em>cho tôi</em>), hai thuật toán cho cùng một đáp số! Với cách thứ nhất, tôi mong muốn các bạn hiểu rõ được thuật toán K-means clustering làm việc như thế nào. Với cách thứ hai, tôi hy vọng các bạn biết áp dụng thư viện sẵn có như thế nào.</p>", "<em>cho tôi</em>", "<p><a name=\"-thao-luan\"></a></p>", "<a name=\"-thao-luan\"></a>"]}}