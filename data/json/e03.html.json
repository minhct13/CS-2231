{"topic": "<ul class=\"tags\">\n<a class=\"tag\" href=\"/tags#KNN\">KNN</a>\n<a class=\"tag\" href=\"/tags#Regression\">Regression</a>\n<a class=\"tag\" href=\"/tags#Classification\">Classification</a>\n<a class=\"tag\" href=\"/tags#Supervised-learning\">Supervised-learning</a>\n<a class=\"tag\" href=\"/tags#MNIST\">MNIST</a>\n<a class=\"tag\" href=\"/tags#Iris\">Iris</a>\n</ul>", "title": "<h1 class=\"post-title\" itemprop=\"name\">Bài 6: K-nearest neighbors</h1>", "introduction": {"title": "1. Giới thiệu", "content": ["<p><a name=\"mot-cau-chuyen-vui\"></a></p>", "<a name=\"mot-cau-chuyen-vui\"></a>", "<h3 id=\"một-câu-chuyện-vui\">Một câu chuyện vui</h3>", "<p>Có một anh bạn chuẩn bị đến ngày thi cuối kỳ. Vì môn này được mở tài liệu khi thi nên anh ta không chịu ôn tập để hiểu ý nghĩa của từng bài học và mối liên hệ giữa các bài. Thay vào đó, anh thu thập tất cả các tài liệu trên lớp, bao gồm ghi chép bài giảng (lecture notes), các slides và bài tập về nhà + lời giải. Để cho chắc, anh ta ra thư viện và các quán Photocopy quanh trường mua hết tất cả các loại tài liệu liên quan (<em>khá khen cho cậu này chịu khó tìm kiếm tài liệu</em>). Cuối cùng, anh bạn của chúng ta thu thập được một chồng cao tài liệu để mang vào phòng thi. \n<!-- Thật không may, cậu ấy không biết rằng trong đống tài liệu mua từ quán Photocopy đó có nhiều bài cho đáp án sai.  --></p>", "<em>khá khen cho cậu này chịu khó tìm kiếm tài liệu</em>", "<p>Vào ngày thi, anh tự tin mang chồng tài liệu vào phòng thi. Aha, đề này ít nhất mình phải được 8 điểm. Câu 1 giống hệt bài giảng trên lớp. Câu 2 giống hệt đề thi năm ngoái mà lời giải có trong tập tài liệu mua ở quán Photocopy. Câu 3 gần giống với bài tập về nhà. Câu 4 trắc nghiệm thậm chí cậu nhớ chính xác ba tài liệu có ghi đáp án. Câu cuối cùng, 1 câu khó nhưng anh đã từng nhìn thấy, chỉ là không nhớ ở đâu thôi.</p>", "<p>Kết quả cuối cùng, cậu ta được 4 điểm, vừa đủ điểm qua môn. Cậu làm chính xác câu 1 vì tìm được ngay trong tập ghi chú bài giảng. Câu 2 cũng tìm được đáp án nhưng lời giải của quán Photocopy sai! Câu ba thấy gần giống bài về nhà, chỉ khác mỗi một số thôi, cậu cho kết quả giống như thế luôn, vậy mà không được điểm nào. Câu 4 thì tìm được cả 3 tài liệu nhưng có hai trong đó cho đáp án A, cái còn lại cho B. Cậu chọn A và được điểm. Câu 5 thì không làm được dù còn tới 20 phút, vì tìm mãi chẳng thấy đáp án đâu - nhiều tài liệu quá cũng mệt!!</p>", "<p>Không phải ngẫu nhiên mà tôi dành ra ba đoạn văn để kể về chuyện học hành của anh chàng kia. Hôm nay tôi xin trình bày về một phương pháp trong Machine Learning, được gọi là K-nearest neighbor (hay KNN), một thuật toán được xếp vào loại lazy (machine) learning (máy lười học). Thuật toán này khá giống với cách học/thi của anh bạn kém may mắn kia.</p>", "<p><a name=\"k-nearest-neighbor\"></a></p>", "<a name=\"k-nearest-neighbor\"></a>", "<h3 id=\"k-nearest-neighbor\">K-nearest neighbor</h3>", "<p>K-nearest neighbor là một trong những thuật toán supervised-learning đơn giản nhất (mà hiệu quả trong một vài trường hợp) trong Machine Learning. Khi training, thuật toán này <em>không học</em> một điều gì từ dữ liệu training (đây cũng là lý do thuật toán này được xếp vào loại <a href=\"https://en.wikipedia.org/wiki/Lazy_learning\">lazy learning</a>), mọi tính toán được thực hiện khi nó cần dự đoán kết quả của dữ liệu mới. K-nearest neighbor có thể áp dụng được vào cả hai loại của bài toán Supervised learning là <a href=\"/2016/12/27/categories/#classification-phan-loai\">Classification</a> và <a href=\"/2016/12/27/categories/#regression-hoi-quy\">Regression</a>. KNN còn được gọi là một thuật toán <a href=\"https://en.wikipedia.org/wiki/Instance-based_learning\">Instance-based hay Memory-based learning</a>.</p>", "<em>không học</em>", "<a href=\"https://en.wikipedia.org/wiki/Lazy_learning\">lazy learning</a>", "<a href=\"/2016/12/27/categories/#classification-phan-loai\">Classification</a>", "<a href=\"/2016/12/27/categories/#regression-hoi-quy\">Regression</a>", "<a href=\"https://en.wikipedia.org/wiki/Instance-based_learning\">Instance-based hay Memory-based learning</a>", "<p>Có một vài khái niệm tương ứng người-máy như sau:</p>", "<table>\n<thead>\n<tr>\n<th>Ngôn ngữ người</th>\n<th>Ngôn ngữ Máy Học</th>\n<th>in Machine Learning</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Câu hỏi</td>\n<td>Điểm dữ liệu</td>\n<td>Data point</td>\n</tr>\n<tr>\n<td>Đáp án</td>\n<td>Đầu ra, nhãn</td>\n<td>Output, Label</td>\n</tr>\n<tr>\n<td>Ôn thi</td>\n<td>Huấn luyện</td>\n<td>Training</td>\n</tr>\n<tr>\n<td>Tập tài liệu mang vào phòng thi</td>\n<td>Tập dữ liệu tập huấn</td>\n<td>Training set</td>\n</tr>\n<tr>\n<td>Đề thi</td>\n<td>Tập dữ liểu kiểm thử</td>\n<td>Test set</td>\n</tr>\n<tr>\n<td>Câu hỏi trong dề thi</td>\n<td>Dữ liệu kiểm thử</td>\n<td>Test data point</td>\n</tr>\n<tr>\n<td>Câu hỏi có đáp án sai</td>\n<td>Nhiễu</td>\n<td>Noise, Outlier</td>\n</tr>\n<tr>\n<td>Câu hỏi gần giống</td>\n<td>Điểm dữ liệu gần nhất</td>\n<td>Nearest Neighbor</td>\n</tr>\n</tbody>\n</table>", "<thead>\n<tr>\n<th>Ngôn ngữ người</th>\n<th>Ngôn ngữ Máy Học</th>\n<th>in Machine Learning</th>\n</tr>\n</thead>", "<tr>\n<th>Ngôn ngữ người</th>\n<th>Ngôn ngữ Máy Học</th>\n<th>in Machine Learning</th>\n</tr>", "<th>Ngôn ngữ người</th>", "<th>Ngôn ngữ Máy Học</th>", "<th>in Machine Learning</th>", "<tbody>\n<tr>\n<td>Câu hỏi</td>\n<td>Điểm dữ liệu</td>\n<td>Data point</td>\n</tr>\n<tr>\n<td>Đáp án</td>\n<td>Đầu ra, nhãn</td>\n<td>Output, Label</td>\n</tr>\n<tr>\n<td>Ôn thi</td>\n<td>Huấn luyện</td>\n<td>Training</td>\n</tr>\n<tr>\n<td>Tập tài liệu mang vào phòng thi</td>\n<td>Tập dữ liệu tập huấn</td>\n<td>Training set</td>\n</tr>\n<tr>\n<td>Đề thi</td>\n<td>Tập dữ liểu kiểm thử</td>\n<td>Test set</td>\n</tr>\n<tr>\n<td>Câu hỏi trong dề thi</td>\n<td>Dữ liệu kiểm thử</td>\n<td>Test data point</td>\n</tr>\n<tr>\n<td>Câu hỏi có đáp án sai</td>\n<td>Nhiễu</td>\n<td>Noise, Outlier</td>\n</tr>\n<tr>\n<td>Câu hỏi gần giống</td>\n<td>Điểm dữ liệu gần nhất</td>\n<td>Nearest Neighbor</td>\n</tr>\n</tbody>", "<tr>\n<td>Câu hỏi</td>\n<td>Điểm dữ liệu</td>\n<td>Data point</td>\n</tr>", "<td>Câu hỏi</td>", "<td>Điểm dữ liệu</td>", "<td>Data point</td>", "<tr>\n<td>Đáp án</td>\n<td>Đầu ra, nhãn</td>\n<td>Output, Label</td>\n</tr>", "<td>Đáp án</td>", "<td>Đầu ra, nhãn</td>", "<td>Output, Label</td>", "<tr>\n<td>Ôn thi</td>\n<td>Huấn luyện</td>\n<td>Training</td>\n</tr>", "<td>Ôn thi</td>", "<td>Huấn luyện</td>", "<td>Training</td>", "<tr>\n<td>Tập tài liệu mang vào phòng thi</td>\n<td>Tập dữ liệu tập huấn</td>\n<td>Training set</td>\n</tr>", "<td>Tập tài liệu mang vào phòng thi</td>", "<td>Tập dữ liệu tập huấn</td>", "<td>Training set</td>", "<tr>\n<td>Đề thi</td>\n<td>Tập dữ liểu kiểm thử</td>\n<td>Test set</td>\n</tr>", "<td>Đề thi</td>", "<td>Tập dữ liểu kiểm thử</td>", "<td>Test set</td>", "<tr>\n<td>Câu hỏi trong dề thi</td>\n<td>Dữ liệu kiểm thử</td>\n<td>Test data point</td>\n</tr>", "<td>Câu hỏi trong dề thi</td>", "<td>Dữ liệu kiểm thử</td>", "<td>Test data point</td>", "<tr>\n<td>Câu hỏi có đáp án sai</td>\n<td>Nhiễu</td>\n<td>Noise, Outlier</td>\n</tr>", "<td>Câu hỏi có đáp án sai</td>", "<td>Nhiễu</td>", "<td>Noise, Outlier</td>", "<tr>\n<td>Câu hỏi gần giống</td>\n<td>Điểm dữ liệu gần nhất</td>\n<td>Nearest Neighbor</td>\n</tr>", "<td>Câu hỏi gần giống</td>", "<td>Điểm dữ liệu gần nhất</td>", "<td>Nearest Neighbor</td>", "<p><br>\nVới KNN, trong bài toán Classification, label của một điểm dữ liệu mới (hay kết quả của câu hỏi trong bài thi) được suy ra trực tiếp từ K điểm dữ liệu gần nhất trong training set. Label của một test data có thể được quyết định bằng major voting (bầu chọn theo số phiếu) giữa các điểm gần nhất, hoặc nó có thể được suy ra bằng cách đánh trọng số khác nhau cho mỗi trong các điểm gần nhất đó rồi suy ra label. Chi tiết sẽ được nêu trong phần tiếp theo.</br></p>", "<br>\nVới KNN, trong bài toán Classification, label của một điểm dữ liệu mới (hay kết quả của câu hỏi trong bài thi) được suy ra trực tiếp từ K điểm dữ liệu gần nhất trong training set. Label của một test data có thể được quyết định bằng major voting (bầu chọn theo số phiếu) giữa các điểm gần nhất, hoặc nó có thể được suy ra bằng cách đánh trọng số khác nhau cho mỗi trong các điểm gần nhất đó rồi suy ra label. Chi tiết sẽ được nêu trong phần tiếp theo.</br>", "<p>Trong bài toán Regresssion, đầu ra của một điểm dữ liệu sẽ bằng chính đầu ra của điểm dữ liệu đã biết gần nhất (trong trường hợp K=1), hoặc là trung bình có trọng số của đầu ra của những điểm gần nhất, hoặc bằng một mối quan hệ dựa trên khoảng cách tới các điểm gần nhất đó.</p>", "<p>Một cách ngắn gọn, KNN là thuật toán đi tìm đầu ra của một điểm dữ liệu mới bằng cách <em>chỉ</em> dựa trên thông tin của K điểm dữ liệu trong training set gần nó nhất (K-lân cận), <em>không quan tâm đến việc có một vài điểm dữ liệu trong những điểm gần nhất này là nhiễu</em>. Hình dưới đây là một ví dụ về KNN trong classification với K = 1.</p>", "<em>chỉ</em>", "<em>không quan tâm đến việc có một vài điểm dữ liệu trong những điểm gần nhất này là nhiễu</em>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"https://upload.wikimedia.org/wikipedia/commons/5/52/Map1NN.png\"/>\n<div class=\"thecap\"> Bản đồ của 1NN (Nguồn: <a href=\"https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm\">Wikipedia</a>) <br/></div>\n</div>", "<img align=\"center\" src=\"https://upload.wikimedia.org/wikipedia/commons/5/52/Map1NN.png\"/>", "<div class=\"thecap\"> Bản đồ của 1NN (Nguồn: <a href=\"https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm\">Wikipedia</a>) <br/></div>", "<a href=\"https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm\">Wikipedia</a>", "<br/>", "<p>Ví dụ trên đây là bài toán Classification với 3 classes: Đỏ, Lam, Lục. Mỗi điểm dữ liệu mới (test data point) sẽ được gán label theo màu của điểm mà nó thuộc về. Trong hình này, có một vài vùng nhỏ xem lẫn vào các vùng lớn hơn khác màu. Ví dụ có một điểm màu Lục ở gần góc 11 giờ nằm giữa hai vùng lớn với nhiều dữ liệu màu Đỏ và Lam. Điểm này rất có thể là nhiễu. Dẫn đến nếu dữ liệu test rơi vào vùng này sẽ có nhiều khả năng cho kết quả không chính xác.</p>", "<p><a name=\"khoang-cach-trong-khong-gian-vector\"></a></p>", "<a name=\"khoang-cach-trong-khong-gian-vector\"></a>", "<h3 id=\"khoảng-cách-trong-không-gian-vector\">Khoảng cách trong không gian vector</h3>", "<p>Trong không gian một chiều, khoảng cách giữa hai điểm là trị tuyệt đối giữa hiệu giá trị của hai điểm đó. Trong không gian nhiều chiều, khoảng cách giữa hai điểm có thể được định nghĩa bằng nhiều hàm số khác nhau, trong đó độ dài đường thằng nổi hai điểm chỉ là một trường hợp đặc biệt trong đó. Nhiều thông tin bổ ích (cho Machine Learning) có thể được tìm thấy tại <a href=\"/math/#-norms-chuan\">Norms (chuẩn) của vector</a> trong tab <a href=\"/math/\">Math</a>.</p>", "<a href=\"/math/#-norms-chuan\">Norms (chuẩn) của vector</a>", "<a href=\"/math/\">Math</a>", "<p><a name=\"-phan-tich-toan-hoc\"></a></p>", "<a name=\"-phan-tich-toan-hoc\"></a>"]}, "formulas": {"title": "2. Phân tích toán học", "content": ["<p>Thuật toán KNN rất dễ hiểu nên sẽ phần “Phân tích toán học” này sẽ chỉ có 3 câu. Tôi trực tiếp đi vào các ví dụ. Có một điều đáng lưu ý là KNN phải <em>nhớ</em> tất cả các điểm dữ liệu training, việc này không được lợi về cả bộ nhớ và thời gian tính toán - giống như khi cậu bạn của chúng ta không tìm được câu trả lời cho câu hỏi cuối cùng.</p>", "<em>nhớ</em>", "<p><a name=\"-vi-du-tren-python\"></a></p>", "<a name=\"-vi-du-tren-python\"></a>"]}, "examples": {"title": "3. Ví dụ trên Python", "content": ["<p><a name=\"bo-co-so-du-lieu-iris-iris-flower-dataset\"></a></p>", "<a name=\"bo-co-so-du-lieu-iris-iris-flower-dataset\"></a>", "<h3 id=\"bộ-cơ-sở-dữ-liệu-iris-iris-flower-dataset\">Bộ cơ sở dữ liệu Iris (Iris flower dataset).</h3>", "<p><a href=\"https://en.wikipedia.org/wiki/Iris_flower_data_set\">Iris flower dataset</a> là một bộ dữ liệu nhỏ (nhỏ hơn rất nhiều so với <a href=\"/2017/01/04/kmeans2/#bo-co-so-du-lieu-mnist\">MNIST</a>. Bộ dữ liệu này bao gồm thông tin của ba loại hoa Iris (một loài hoa lan) khác nhau: Iris setosa, Iris virginica và Iris versicolor. Mỗi loại có 50 bông hoa được đo với dữ liệu là 4 thông tin: chiều dài, chiều rộng đài hoa (sepal), và chiều dài, chiều rộng cánh hoa (petal). Dưới đây là ví dụ về hình ảnh của ba loại hoa. (Chú ý, đây không phải là bộ cơ sở dữ liệu ảnh như MNIST, mỗi điểm dữ liệu trong tập này chỉ là một vector 4 chiều).</p>", "<a href=\"https://en.wikipedia.org/wiki/Iris_flower_data_set\">Iris flower dataset</a>", "<a href=\"/2017/01/04/kmeans2/#bo-co-so-du-lieu-mnist\">MNIST</a>", "<div class=\"imgcap\">\n<img align=\"center\" src=\"/assets/knn/iris.png\" width=\"800\"/>\n<div class=\"thecap\"> Ví dụ về Iris flower dataset (Nguồn: <a href=\"https://en.wikipedia.org/wiki/Iris_flower_data_set\">Wikipedia</a>) <br/></div>\n</div>", "<img align=\"center\" src=\"/assets/knn/iris.png\" width=\"800\"/>", "<div class=\"thecap\"> Ví dụ về Iris flower dataset (Nguồn: <a href=\"https://en.wikipedia.org/wiki/Iris_flower_data_set\">Wikipedia</a>) <br/></div>", "<a href=\"https://en.wikipedia.org/wiki/Iris_flower_data_set\">Wikipedia</a>", "<br/>", "<p>Bộ dữ liệu nhỏ này thường được sử dụng trong nhiều thuật toán Machine Learning trong các lớp học. Tôi sẽ giải thích lý do không chọn MNIST vào phần sau.</p>", "<p><a name=\"thi-nghiem\"></a></p>", "<a name=\"thi-nghiem\"></a>", "<h3 id=\"thí-nghiệm\">Thí nghiệm</h3>", "<p>Trong phần này, chúng ta sẽ tách 150 dữ liệu trong Iris flower dataset ra thành 2 phần, gọi là <em>training set</em> và <em>test set</em>. Thuật toán KNN sẽ dựa vào trông tin ở <em>training set</em> để dự đoán xem mỗi dữ liệu trong <em>test set</em> tương ứng với loại hoa nào. Dữ liệu được dự đoán này sẽ được đối chiếu với loại hoa thật của mỗi dữ liệu trong <em>test set</em> để đánh giá hiệu quả của KNN.</p>", "<em>training set</em>", "<em>test set</em>", "<em>training set</em>", "<em>test set</em>", "<em>test set</em>", "<p><strong>Trước tiên, chúng ta cần khai báo vài thư viện</strong>.</p>", "<strong>Trước tiên, chúng ta cần khai báo vài thư viện</strong>", "<p>Iris flower dataset có sẵn trong thư viện <a href=\"http://scikit-learn.org/\">scikit-learn</a>.</p>", "<a href=\"http://scikit-learn.org/\">scikit-learn</a>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn</span> <span class=\"kn\">import</span> <span class=\"n\">neighbors</span><span class=\"p\">,</span> <span class=\"n\">datasets</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn</span> <span class=\"kn\">import</span> <span class=\"n\">neighbors</span><span class=\"p\">,</span> <span class=\"n\">datasets</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn</span> <span class=\"kn\">import</span> <span class=\"n\">neighbors</span><span class=\"p\">,</span> <span class=\"n\">datasets</span>\n</code></pre>", "<code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"kn\">from</span> <span class=\"nn\">sklearn</span> <span class=\"kn\">import</span> <span class=\"n\">neighbors</span><span class=\"p\">,</span> <span class=\"n\">datasets</span>\n</code>", "<span class=\"kn\">import</span>", "<span class=\"nn\">numpy</span>", "<span class=\"k\">as</span>", "<span class=\"n\">np</span>", "<span class=\"kn\">import</span>", "<span class=\"nn\">matplotlib.pyplot</span>", "<span class=\"k\">as</span>", "<span class=\"n\">plt</span>", "<span class=\"kn\">from</span>", "<span class=\"nn\">sklearn</span>", "<span class=\"kn\">import</span>", "<span class=\"n\">neighbors</span>", "<span class=\"p\">,</span>", "<span class=\"n\">datasets</span>", "<p><strong>Tiếp theo, chúng ta load dữ liệu và hiện thị vài dữ liệu mẫu</strong>. Các class được gán nhãn là 0, 1, và 2.</p>", "<strong>Tiếp theo, chúng ta load dữ liệu và hiện thị vài dữ liệu mẫu</strong>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">iris</span> <span class=\"o\">=</span> <span class=\"n\">datasets</span><span class=\"p\">.</span><span class=\"n\">load_iris</span><span class=\"p\">()</span>\n<span class=\"n\">iris_X</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">data</span>\n<span class=\"n\">iris_y</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">target</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of classes: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">))</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of data points: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 0:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X0</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 1:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 2:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">iris</span> <span class=\"o\">=</span> <span class=\"n\">datasets</span><span class=\"p\">.</span><span class=\"n\">load_iris</span><span class=\"p\">()</span>\n<span class=\"n\">iris_X</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">data</span>\n<span class=\"n\">iris_y</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">target</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of classes: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">))</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of data points: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 0:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X0</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 1:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 2:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"n\">iris</span> <span class=\"o\">=</span> <span class=\"n\">datasets</span><span class=\"p\">.</span><span class=\"n\">load_iris</span><span class=\"p\">()</span>\n<span class=\"n\">iris_X</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">data</span>\n<span class=\"n\">iris_y</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">target</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of classes: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">))</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of data points: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 0:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X0</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 1:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 2:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n</code></pre>", "<code><span class=\"n\">iris</span> <span class=\"o\">=</span> <span class=\"n\">datasets</span><span class=\"p\">.</span><span class=\"n\">load_iris</span><span class=\"p\">()</span>\n<span class=\"n\">iris_X</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">data</span>\n<span class=\"n\">iris_y</span> <span class=\"o\">=</span> <span class=\"n\">iris</span><span class=\"p\">.</span><span class=\"n\">target</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of classes: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">))</span>\n<span class=\"k\">print</span> <span class=\"s\">'Number of data points: %d'</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">iris_y</span><span class=\"p\">)</span>\n\n\n<span class=\"n\">X0</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 0:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X0</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X1</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 1:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X1</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n<span class=\"n\">X2</span> <span class=\"o\">=</span> <span class=\"n\">iris_X</span><span class=\"p\">[</span><span class=\"n\">iris_y</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">,:]</span>\n<span class=\"k\">print</span> <span class=\"s\">'</span><span class=\"se\">\\n</span><span class=\"s\">Samples from class 2:</span><span class=\"se\">\\n</span><span class=\"s\">'</span><span class=\"p\">,</span> <span class=\"n\">X2</span><span class=\"p\">[:</span><span class=\"mi\">5</span><span class=\"p\">,:]</span>\n\n</code>", "<span class=\"n\">iris</span>", "<span class=\"o\">=</span>", "<span class=\"n\">datasets</span>", "<span class=\"p\">.</span>", "<span class=\"n\">load_iris</span>", "<span class=\"p\">()</span>", "<span class=\"n\">iris_X</span>", "<span class=\"o\">=</span>", "<span class=\"n\">iris</span>", "<span class=\"p\">.</span>", "<span class=\"n\">data</span>", "<span class=\"n\">iris_y</span>", "<span class=\"o\">=</span>", "<span class=\"n\">iris</span>", "<span class=\"p\">.</span>", "<span class=\"n\">target</span>", "<span class=\"k\">print</span>", "<span class=\"s\">'Number of classes: %d'</span>", "<span class=\"o\">%</span>", "<span class=\"nb\">len</span>", "<span class=\"p\">(</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">unique</span>", "<span class=\"p\">(</span>", "<span class=\"n\">iris_y</span>", "<span class=\"p\">))</span>", "<span class=\"k\">print</span>", "<span class=\"s\">'Number of data points: %d'</span>", "<span class=\"o\">%</span>", "<span class=\"nb\">len</span>", "<span class=\"p\">(</span>", "<span class=\"n\">iris_y</span>", "<span class=\"p\">)</span>", "<span class=\"n\">X0</span>", "<span class=\"o\">=</span>", "<span class=\"n\">iris_X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">iris_y</span>", "<span class=\"o\">==</span>", "<span class=\"mi\">0</span>", "<span class=\"p\">,:]</span>", "<span class=\"k\">print</span>", "<span class=\"s\">'</span>", "<span class=\"se\">\\n</span>", "<span class=\"s\">Samples from class 0:</span>", "<span class=\"se\">\\n</span>", "<span class=\"s\">'</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X0</span>", "<span class=\"p\">[:</span>", "<span class=\"mi\">5</span>", "<span class=\"p\">,:]</span>", "<span class=\"n\">X1</span>", "<span class=\"o\">=</span>", "<span class=\"n\">iris_X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">iris_y</span>", "<span class=\"o\">==</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">,:]</span>", "<span class=\"k\">print</span>", "<span class=\"s\">'</span>", "<span class=\"se\">\\n</span>", "<span class=\"s\">Samples from class 1:</span>", "<span class=\"se\">\\n</span>", "<span class=\"s\">'</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X1</span>", "<span class=\"p\">[:</span>", "<span class=\"mi\">5</span>", "<span class=\"p\">,:]</span>", "<span class=\"n\">X2</span>", "<span class=\"o\">=</span>", "<span class=\"n\">iris_X</span>", "<span class=\"p\">[</span>", "<span class=\"n\">iris_y</span>", "<span class=\"o\">==</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">,:]</span>", "<span class=\"k\">print</span>", "<span class=\"s\">'</span>", "<span class=\"se\">\\n</span>", "<span class=\"s\">Samples from class 2:</span>", "<span class=\"se\">\\n</span>", "<span class=\"s\">'</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X2</span>", "<span class=\"p\">[:</span>", "<span class=\"mi\">5</span>", "<span class=\"p\">,:]</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Number of classes: 3\nNumber of data points: 150\n\nSamples from class 0:\n[[ 5.1  3.5  1.4  0.2]\n [ 4.9  3.   1.4  0.2]\n [ 4.7  3.2  1.3  0.2]\n [ 4.6  3.1  1.5  0.2]\n [ 5.   3.6  1.4  0.2]]\n\nSamples from class 1:\n[[ 7.   3.2  4.7  1.4]\n [ 6.4  3.2  4.5  1.5]\n [ 6.9  3.1  4.9  1.5]\n [ 5.5  2.3  4.   1.3]\n [ 6.5  2.8  4.6  1.5]]\n\nSamples from class 2:\n[[ 6.3  3.3  6.   2.5]\n [ 5.8  2.7  5.1  1.9]\n [ 7.1  3.   5.9  2.1]\n [ 6.3  2.9  5.6  1.8]\n [ 6.5  3.   5.8  2.2]]\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Number of classes: 3\nNumber of data points: 150\n\nSamples from class 0:\n[[ 5.1  3.5  1.4  0.2]\n [ 4.9  3.   1.4  0.2]\n [ 4.7  3.2  1.3  0.2]\n [ 4.6  3.1  1.5  0.2]\n [ 5.   3.6  1.4  0.2]]\n\nSamples from class 1:\n[[ 7.   3.2  4.7  1.4]\n [ 6.4  3.2  4.5  1.5]\n [ 6.9  3.1  4.9  1.5]\n [ 5.5  2.3  4.   1.3]\n [ 6.5  2.8  4.6  1.5]]\n\nSamples from class 2:\n[[ 6.3  3.3  6.   2.5]\n [ 5.8  2.7  5.1  1.9]\n [ 7.1  3.   5.9  2.1]\n [ 6.3  2.9  5.6  1.8]\n [ 6.5  3.   5.8  2.2]]\n</code></pre></div>", "<pre class=\"highlight\"><code>Number of classes: 3\nNumber of data points: 150\n\nSamples from class 0:\n[[ 5.1  3.5  1.4  0.2]\n [ 4.9  3.   1.4  0.2]\n [ 4.7  3.2  1.3  0.2]\n [ 4.6  3.1  1.5  0.2]\n [ 5.   3.6  1.4  0.2]]\n\nSamples from class 1:\n[[ 7.   3.2  4.7  1.4]\n [ 6.4  3.2  4.5  1.5]\n [ 6.9  3.1  4.9  1.5]\n [ 5.5  2.3  4.   1.3]\n [ 6.5  2.8  4.6  1.5]]\n\nSamples from class 2:\n[[ 6.3  3.3  6.   2.5]\n [ 5.8  2.7  5.1  1.9]\n [ 7.1  3.   5.9  2.1]\n [ 6.3  2.9  5.6  1.8]\n [ 6.5  3.   5.8  2.2]]\n</code></pre>", "<code>Number of classes: 3\nNumber of data points: 150\n\nSamples from class 0:\n[[ 5.1  3.5  1.4  0.2]\n [ 4.9  3.   1.4  0.2]\n [ 4.7  3.2  1.3  0.2]\n [ 4.6  3.1  1.5  0.2]\n [ 5.   3.6  1.4  0.2]]\n\nSamples from class 1:\n[[ 7.   3.2  4.7  1.4]\n [ 6.4  3.2  4.5  1.5]\n [ 6.9  3.1  4.9  1.5]\n [ 5.5  2.3  4.   1.3]\n [ 6.5  2.8  4.6  1.5]]\n\nSamples from class 2:\n[[ 6.3  3.3  6.   2.5]\n [ 5.8  2.7  5.1  1.9]\n [ 7.1  3.   5.9  2.1]\n [ 6.3  2.9  5.6  1.8]\n [ 6.5  3.   5.8  2.2]]\n</code>", "<p>Nếu nhìn vào vài dữ liệu mẫu, chúng ta thấy rằng hai cột cuối mang khá nhiều thông tin giúp chúng ta có thể  phân biệt được chúng. Chúng ta dự đoán rằng kết quả classification cho cơ sở dữ liệu này sẽ tương đối cao.</p>", "<p><a name=\"tach-training-va-test-sets\"></a></p>", "<a name=\"tach-training-va-test-sets\"></a>", "<h4 id=\"tách-training-và-test-sets\">Tách training và test sets</h4>", "<p>Giả sử chúng ta muốn dùng 50 điểm dữ liệu cho test set, 100 điểm còn lại cho training set. Scikit-learn có một hàm số cho phép chúng ta ngẫu nhiên lựa chọn các điểm này, như sau:</p>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.model_selection</span> <span class=\"kn\">import</span> <span class=\"n\">train_test_split</span>\n<span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">X_test</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">,</span> <span class=\"n\">y_test</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span>\n     <span class=\"n\">iris_X</span><span class=\"p\">,</span> <span class=\"n\">iris_y</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Training size: %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Test size    : %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.model_selection</span> <span class=\"kn\">import</span> <span class=\"n\">train_test_split</span>\n<span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">X_test</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">,</span> <span class=\"n\">y_test</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span>\n     <span class=\"n\">iris_X</span><span class=\"p\">,</span> <span class=\"n\">iris_y</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Training size: %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Test size    : %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.model_selection</span> <span class=\"kn\">import</span> <span class=\"n\">train_test_split</span>\n<span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">X_test</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">,</span> <span class=\"n\">y_test</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span>\n     <span class=\"n\">iris_X</span><span class=\"p\">,</span> <span class=\"n\">iris_y</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Training size: %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Test size    : %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n</code></pre>", "<code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.model_selection</span> <span class=\"kn\">import</span> <span class=\"n\">train_test_split</span>\n<span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">X_test</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">,</span> <span class=\"n\">y_test</span> <span class=\"o\">=</span> <span class=\"n\">train_test_split</span><span class=\"p\">(</span>\n     <span class=\"n\">iris_X</span><span class=\"p\">,</span> <span class=\"n\">iris_y</span><span class=\"p\">,</span> <span class=\"n\">test_size</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Training size: %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Test size    : %d\"</span> <span class=\"o\">%</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">)</span>\n</code>", "<span class=\"kn\">from</span>", "<span class=\"nn\">sklearn.model_selection</span>", "<span class=\"kn\">import</span>", "<span class=\"n\">train_test_split</span>", "<span class=\"n\">X_train</span>", "<span class=\"p\">,</span>", "<span class=\"n\">X_test</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_train</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_test</span>", "<span class=\"o\">=</span>", "<span class=\"n\">train_test_split</span>", "<span class=\"p\">(</span>", "<span class=\"n\">iris_X</span>", "<span class=\"p\">,</span>", "<span class=\"n\">iris_y</span>", "<span class=\"p\">,</span>", "<span class=\"n\">test_size</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">50</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Training size: %d\"</span>", "<span class=\"o\">%</span>", "<span class=\"nb\">len</span>", "<span class=\"p\">(</span>", "<span class=\"n\">y_train</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Test size    : %d\"</span>", "<span class=\"o\">%</span>", "<span class=\"nb\">len</span>", "<span class=\"p\">(</span>", "<span class=\"n\">y_test</span>", "<span class=\"p\">)</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Training size: 100\nTest size    : 50\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Training size: 100\nTest size    : 50\n</code></pre></div>", "<pre class=\"highlight\"><code>Training size: 100\nTest size    : 50\n</code></pre>", "<code>Training size: 100\nTest size    : 50\n</code>", "<p>Sau đây, tôi trước hết xét trường hợp đơn giản K = 1, tức là với mỗi điểm test data, ta chỉ xét 1 điểm training data gần nhất và lấy label của điểm đó để dự đoán cho điểm test này.</p>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Print results for 20 test data points:\"</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Predicted labels: \"</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Ground truth    : \"</span><span class=\"p\">,</span> <span class=\"n\">y_test</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Print results for 20 test data points:\"</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Predicted labels: \"</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Ground truth    : \"</span><span class=\"p\">,</span> <span class=\"n\">y_test</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Print results for 20 test data points:\"</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Predicted labels: \"</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Ground truth    : \"</span><span class=\"p\">,</span> <span class=\"n\">y_test</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n</code></pre>", "<code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Print results for 20 test data points:\"</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Predicted labels: \"</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Ground truth    : \"</span><span class=\"p\">,</span> <span class=\"n\">y_test</span><span class=\"p\">[</span><span class=\"mi\">20</span><span class=\"p\">:</span><span class=\"mi\">40</span><span class=\"p\">]</span>\n</code>", "<span class=\"n\">clf</span>", "<span class=\"o\">=</span>", "<span class=\"n\">neighbors</span>", "<span class=\"p\">.</span>", "<span class=\"n\">KNeighborsClassifier</span>", "<span class=\"p\">(</span>", "<span class=\"n\">n_neighbors</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">1</span>", "<span class=\"p\">,</span>", "<span class=\"n\">p</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">)</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">fit</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_train</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_train</span>", "<span class=\"p\">)</span>", "<span class=\"n\">y_pred</span>", "<span class=\"o\">=</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">predict</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_test</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Print results for 20 test data points:\"</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Predicted labels: \"</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_pred</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">20</span>", "<span class=\"p\">:</span>", "<span class=\"mi\">40</span>", "<span class=\"p\">]</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Ground truth    : \"</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_test</span>", "<span class=\"p\">[</span>", "<span class=\"mi\">20</span>", "<span class=\"p\">:</span>", "<span class=\"mi\">40</span>", "<span class=\"p\">]</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Print results for first 20 test data points:\nPredicted labels:  [2 1 2 2 1 2 2 0 2 0 2 0 1 0 0 2 2 0 2 0]\nGround truth    :  [2 1 2 2 1 2 2 0 2 0 1 0 1 0 0 2 1 0 2 0]\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Print results for first 20 test data points:\nPredicted labels:  [2 1 2 2 1 2 2 0 2 0 2 0 1 0 0 2 2 0 2 0]\nGround truth    :  [2 1 2 2 1 2 2 0 2 0 1 0 1 0 0 2 1 0 2 0]\n</code></pre></div>", "<pre class=\"highlight\"><code>Print results for first 20 test data points:\nPredicted labels:  [2 1 2 2 1 2 2 0 2 0 2 0 1 0 0 2 2 0 2 0]\nGround truth    :  [2 1 2 2 1 2 2 0 2 0 1 0 1 0 0 2 1 0 2 0]\n</code></pre>", "<code>Print results for first 20 test data points:\nPredicted labels:  [2 1 2 2 1 2 2 0 2 0 2 0 1 0 0 2 2 0 2 0]\nGround truth    :  [2 1 2 2 1 2 2 0 2 0 1 0 1 0 0 2 1 0 2 0]\n</code>", "<p><a name=\"ground-truth\"></a>\nKết quả cho thấy label dự đoán gần giống với label thật của test data, chỉ có 2 điểm trong số 20 điểm được hiển thị có kết quả sai lệch. Ở đây chúng ta làm quen với khái niệm mới: <em>ground truth</em>. Một cách đơn giản, <em>ground truth</em> chính là nhãn/label/đầu ra <em>thực sự</em> của các điểm trong test data. Khái niệm này được dùng nhiều trong Machine Learning, hy vọng lần tới các bạn gặp thì sẽ nhớ ngay nó là gì.</p>", "<a name=\"ground-truth\"></a>", "<em>ground truth</em>", "<em>ground truth</em>", "<em>thực sự</em>", "<p><a name=\"phuong-phap-danh-gia-evaluation-method\"></a></p>", "<a name=\"phuong-phap-danh-gia-evaluation-method\"></a>", "<h4 id=\"phương-pháp-đánh-giá-evaluation-method\">Phương pháp đánh giá (evaluation method)</h4>", "<p>Để đánh giá độ chính xác của thuật toán KNN classifier này, chúng ta xem xem có bao nhiêu điểm trong test data được dự đoán đúng. Lấy số lượng này chia cho tổng số lượng trong tập test data sẽ ra độ chính xác. Scikit-learn cung cấp hàm số <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html\"><code class=\"language-plaintext highlighter-rouge\">accuracy_score</code></a> để thực hiện công việc này.</p>", "<a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html\"><code class=\"language-plaintext highlighter-rouge\">accuracy_score</code></a>", "<code class=\"language-plaintext highlighter-rouge\">accuracy_score</code>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.metrics</span> <span class=\"kn\">import</span> <span class=\"n\">accuracy_score</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 1NN: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.metrics</span> <span class=\"kn\">import</span> <span class=\"n\">accuracy_score</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 1NN: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.metrics</span> <span class=\"kn\">import</span> <span class=\"n\">accuracy_score</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 1NN: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre>", "<code><span class=\"kn\">from</span> <span class=\"nn\">sklearn.metrics</span> <span class=\"kn\">import</span> <span class=\"n\">accuracy_score</span>\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 1NN: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code>", "<span class=\"kn\">from</span>", "<span class=\"nn\">sklearn.metrics</span>", "<span class=\"kn\">import</span>", "<span class=\"n\">accuracy_score</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Accuracy of 1NN: %.2f %%\"</span>", "<span class=\"o\">%</span>", "<span class=\"p\">(</span>", "<span class=\"mi\">100</span>", "<span class=\"o\">*</span>", "<span class=\"n\">accuracy_score</span>", "<span class=\"p\">(</span>", "<span class=\"n\">y_test</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_pred</span>", "<span class=\"p\">))</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 1NN: 94.00 %\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 1NN: 94.00 %\n</code></pre></div>", "<pre class=\"highlight\"><code>Accuracy of 1NN: 94.00 %\n</code></pre>", "<code>Accuracy of 1NN: 94.00 %\n</code>", "<p>1NN đã cho chúng ta kết quả là 94%, không tệ! Chú ý rằng đây là một cơ sở dữ liệu dễ vì chỉ với dữ liệu ở hai cột cuối cùng, chúng ta đã có thể suy ra quy luật. Trong ví dụ này, tôi sử dụng <code class=\"language-plaintext highlighter-rouge\">p = 2</code> nghĩa là khoảng cách ở đây được tính là khoảng cách theo <a href=\"/math/#norm2\">norm 2</a>. Các bạn cũng có thể thử bằng cách thay <code class=\"language-plaintext highlighter-rouge\">p = 1</code> cho <a href=\"/math/#norm0\">norm 1</a>, hoặc các gía trị <code class=\"language-plaintext highlighter-rouge\">p</code> khác cho norm khác. (Xem thêm <a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html\">sklearn.neighbors.KNeighborsClassifier</a>)</p>", "<code class=\"language-plaintext highlighter-rouge\">p = 2</code>", "<a href=\"/math/#norm2\">norm 2</a>", "<code class=\"language-plaintext highlighter-rouge\">p = 1</code>", "<a href=\"/math/#norm0\">norm 1</a>", "<code class=\"language-plaintext highlighter-rouge\">p</code>", "<a href=\"http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html\">sklearn.neighbors.KNeighborsClassifier</a>", "<p>Nhận thấy rằng chỉ xét 1 điểm gần nhất có thể dẫn đến kết quả sai nếu điểm đó là nhiễu. Một cách có thể làm tăng độ chính xác là tăng số lượng điểm lân cận lên, ví dụ 10 điểm, và xem xem trong 10 điểm gần nhất, class nào chiếm đa số thì dự đoán kết quả là class đó. Kỹ thuật dựa vào đa số này được gọi là major voting.</p>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN with major voting: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN with major voting: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN with major voting: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre>", "<code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN with major voting: %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code>", "<span class=\"n\">clf</span>", "<span class=\"o\">=</span>", "<span class=\"n\">neighbors</span>", "<span class=\"p\">.</span>", "<span class=\"n\">KNeighborsClassifier</span>", "<span class=\"p\">(</span>", "<span class=\"n\">n_neighbors</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">10</span>", "<span class=\"p\">,</span>", "<span class=\"n\">p</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">)</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">fit</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_train</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_train</span>", "<span class=\"p\">)</span>", "<span class=\"n\">y_pred</span>", "<span class=\"o\">=</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">predict</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_test</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Accuracy of 10NN with major voting: %.2f %%\"</span>", "<span class=\"o\">%</span>", "<span class=\"p\">(</span>", "<span class=\"mi\">100</span>", "<span class=\"o\">*</span>", "<span class=\"n\">accuracy_score</span>", "<span class=\"p\">(</span>", "<span class=\"n\">y_test</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_pred</span>", "<span class=\"p\">))</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 10NN with major voting: 98.00 %\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 10NN with major voting: 98.00 %\n</code></pre></div>", "<pre class=\"highlight\"><code>Accuracy of 10NN with major voting: 98.00 %\n</code></pre>", "<code>Accuracy of 10NN with major voting: 98.00 %\n</code>", "<p>Kết quả đã tăng lên 98%, rất tốt!</p>", "<p><a name=\"danh-trong-so-cho-cac-diem-lan-can\"></a></p>", "<a name=\"danh-trong-so-cho-cac-diem-lan-can\"></a>", "<h4 id=\"đánh-trọng-số-cho-các-điểm-lân-cận\">Đánh trọng số cho các điểm lân cận</h4>", "<p>Là một kẻ tham lam, tôi chưa muốn dừng kết quả ở đây vì thấy rằng mình vẫn có thể cải thiện được. Trong kỹ thuật major voting bên trên, mỗi trong 10 điểm gần nhất được coi là có vai trò như nhau và giá trị <em>lá phiếu</em> của mỗi điểm này là như nhau. Tôi cho rằng như thế là không công bằng, vì rõ ràng rằng những điểm gần hơn nên có trọng số cao hơn (<em>càng thân cận thì càng tin tưởng</em>). Vậy nên tôi sẽ đánh trọng số khác nhau cho mỗi trong 10 điểm gần nhất này. Cách đánh trọng số phải thoải mãn điều kiện là một điểm càng gần điểm test data thì phải được đánh trọng số càng cao (tin tưởng hơn). Cách đơn giản nhất là lấy nghịch đảo của khoảng cách này. (Trong trường hợp test data trùng với 1 điểm dữ liệu trong training data, tức khoảng cách bằng 0, ta lấy luôn label của điểm training data).</p>", "<em>lá phiếu</em>", "<em>càng thân cận thì càng tin tưởng</em>", "<p>Scikit-learn giúp chúng ta đơn giản hóa việc này bằng cách gán gía trị <code class=\"language-plaintext highlighter-rouge\">weights = 'distance'</code>. (Giá trị mặc định của <code class=\"language-plaintext highlighter-rouge\">weights</code> là <code class=\"language-plaintext highlighter-rouge\">'uniform'</code>, tương ứng với việc coi tất cả các điểm lân cận có giá trị như nhau như ở trên).</p>", "<code class=\"language-plaintext highlighter-rouge\">weights = 'distance'</code>", "<code class=\"language-plaintext highlighter-rouge\">weights</code>", "<code class=\"language-plaintext highlighter-rouge\">'uniform'</code>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"s\">'distance'</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (1/distance weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"s\">'distance'</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (1/distance weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"s\">'distance'</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (1/distance weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre>", "<code><span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"s\">'distance'</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (1/distance weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code>", "<span class=\"n\">clf</span>", "<span class=\"o\">=</span>", "<span class=\"n\">neighbors</span>", "<span class=\"p\">.</span>", "<span class=\"n\">KNeighborsClassifier</span>", "<span class=\"p\">(</span>", "<span class=\"n\">n_neighbors</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">10</span>", "<span class=\"p\">,</span>", "<span class=\"n\">p</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">,</span>", "<span class=\"n\">weights</span>", "<span class=\"o\">=</span>", "<span class=\"s\">'distance'</span>", "<span class=\"p\">)</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">fit</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_train</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_train</span>", "<span class=\"p\">)</span>", "<span class=\"n\">y_pred</span>", "<span class=\"o\">=</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">predict</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_test</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Accuracy of 10NN (1/distance weights): %.2f %%\"</span>", "<span class=\"o\">%</span>", "<span class=\"p\">(</span>", "<span class=\"mi\">100</span>", "<span class=\"o\">*</span>", "<span class=\"n\">accuracy_score</span>", "<span class=\"p\">(</span>", "<span class=\"n\">y_test</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_pred</span>", "<span class=\"p\">))</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 10NN (1/distance weights): 100.00 %\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 10NN (1/distance weights): 100.00 %\n</code></pre></div>", "<pre class=\"highlight\"><code>Accuracy of 10NN (1/distance weights): 100.00 %\n</code></pre>", "<code>Accuracy of 10NN (1/distance weights): 100.00 %\n</code>", "<p>Aha, 100%.</p>", "<p><strong>Chú ý:</strong> Ngoài 2 phương pháp đánh trọng số <code class=\"language-plaintext highlighter-rouge\">weights = 'uniform'</code> và <code class=\"language-plaintext highlighter-rouge\">weights = 'distance'</code> ở trên, scikit-learn còn cung cấp cho chúng ta một cách để đánh trọng số một cách tùy chọn. Ví dụ, một cách đánh trọng số phổ biến khác trong Machine Learning là:</p>", "<strong>Chú ý:</strong>", "<code class=\"language-plaintext highlighter-rouge\">weights = 'uniform'</code>", "<code class=\"language-plaintext highlighter-rouge\">weights = 'distance'</code>", "<p>\\[\nw_i = \\exp \\left( \\frac{-||\\mathbf{x} - \\mathbf{x}_i||_2^2}{\\sigma^2} \\right)\n\\]\n<!-- \\\\[\nw_i = \\exp{- \\|\\|\\mathbf{x} - \\mathbf{x}_i\\|\\|_2^2}{\\sigma^2}}\n\\\\] --></p>", "<p>trong đó \\(\\mathbf{x}\\) là test data, \\(\\mathbf{x}_i\\) là một điểm trong K-lân cận của \\(\\mathbf{x}\\), \\(w_i\\) là trọng số của điểm đó (ứng với điểm dữ liệu đang xét \\(\\mathbf{x}\\)), \\(\\sigma\\) là một số dương. Nhận thấy rằng hàm số này cũng thỏa mãn điều kiện: điểm càng gần \\(\\mathbf{x}\\) thì trọng số càng cao (cao nhất bằng 1). Với hàm số này, chúng ta có thể lập trình như sau:</p>", "<div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">myweight</span><span class=\"p\">(</span><span class=\"n\">distances</span><span class=\"p\">):</span>\n    <span class=\"n\">sigma2</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">5</span> <span class=\"c1\"># we can change this number\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">exp</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"n\">distances</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"o\">/</span><span class=\"n\">sigma2</span><span class=\"p\">)</span>\n\n<span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"n\">myweight</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (customized weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">myweight</span><span class=\"p\">(</span><span class=\"n\">distances</span><span class=\"p\">):</span>\n    <span class=\"n\">sigma2</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">5</span> <span class=\"c1\"># we can change this number\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">exp</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"n\">distances</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"o\">/</span><span class=\"n\">sigma2</span><span class=\"p\">)</span>\n\n<span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"n\">myweight</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (customized weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre></div>", "<pre class=\"highlight\"><code><span class=\"k\">def</span> <span class=\"nf\">myweight</span><span class=\"p\">(</span><span class=\"n\">distances</span><span class=\"p\">):</span>\n    <span class=\"n\">sigma2</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">5</span> <span class=\"c1\"># we can change this number\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">exp</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"n\">distances</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"o\">/</span><span class=\"n\">sigma2</span><span class=\"p\">)</span>\n\n<span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"n\">myweight</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (customized weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code></pre>", "<code><span class=\"k\">def</span> <span class=\"nf\">myweight</span><span class=\"p\">(</span><span class=\"n\">distances</span><span class=\"p\">):</span>\n    <span class=\"n\">sigma2</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">5</span> <span class=\"c1\"># we can change this number\n</span>    <span class=\"k\">return</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">exp</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"n\">distances</span><span class=\"o\">**</span><span class=\"mi\">2</span><span class=\"o\">/</span><span class=\"n\">sigma2</span><span class=\"p\">)</span>\n\n<span class=\"n\">clf</span> <span class=\"o\">=</span> <span class=\"n\">neighbors</span><span class=\"p\">.</span><span class=\"n\">KNeighborsClassifier</span><span class=\"p\">(</span><span class=\"n\">n_neighbors</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"n\">p</span> <span class=\"o\">=</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"n\">weights</span> <span class=\"o\">=</span> <span class=\"n\">myweight</span><span class=\"p\">)</span>\n<span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">fit</span><span class=\"p\">(</span><span class=\"n\">X_train</span><span class=\"p\">,</span> <span class=\"n\">y_train</span><span class=\"p\">)</span>\n<span class=\"n\">y_pred</span> <span class=\"o\">=</span> <span class=\"n\">clf</span><span class=\"p\">.</span><span class=\"n\">predict</span><span class=\"p\">(</span><span class=\"n\">X_test</span><span class=\"p\">)</span>\n\n<span class=\"k\">print</span> <span class=\"s\">\"Accuracy of 10NN (customized weights): %.2f %%\"</span> <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"mi\">100</span><span class=\"o\">*</span><span class=\"n\">accuracy_score</span><span class=\"p\">(</span><span class=\"n\">y_test</span><span class=\"p\">,</span> <span class=\"n\">y_pred</span><span class=\"p\">))</span>\n</code>", "<span class=\"k\">def</span>", "<span class=\"nf\">myweight</span>", "<span class=\"p\">(</span>", "<span class=\"n\">distances</span>", "<span class=\"p\">):</span>", "<span class=\"n\">sigma2</span>", "<span class=\"o\">=</span>", "<span class=\"p\">.</span>", "<span class=\"mi\">5</span>", "<span class=\"c1\"># we can change this number\n</span>", "<span class=\"k\">return</span>", "<span class=\"n\">np</span>", "<span class=\"p\">.</span>", "<span class=\"n\">exp</span>", "<span class=\"p\">(</span>", "<span class=\"o\">-</span>", "<span class=\"n\">distances</span>", "<span class=\"o\">**</span>", "<span class=\"mi\">2</span>", "<span class=\"o\">/</span>", "<span class=\"n\">sigma2</span>", "<span class=\"p\">)</span>", "<span class=\"n\">clf</span>", "<span class=\"o\">=</span>", "<span class=\"n\">neighbors</span>", "<span class=\"p\">.</span>", "<span class=\"n\">KNeighborsClassifier</span>", "<span class=\"p\">(</span>", "<span class=\"n\">n_neighbors</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">10</span>", "<span class=\"p\">,</span>", "<span class=\"n\">p</span>", "<span class=\"o\">=</span>", "<span class=\"mi\">2</span>", "<span class=\"p\">,</span>", "<span class=\"n\">weights</span>", "<span class=\"o\">=</span>", "<span class=\"n\">myweight</span>", "<span class=\"p\">)</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">fit</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_train</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_train</span>", "<span class=\"p\">)</span>", "<span class=\"n\">y_pred</span>", "<span class=\"o\">=</span>", "<span class=\"n\">clf</span>", "<span class=\"p\">.</span>", "<span class=\"n\">predict</span>", "<span class=\"p\">(</span>", "<span class=\"n\">X_test</span>", "<span class=\"p\">)</span>", "<span class=\"k\">print</span>", "<span class=\"s\">\"Accuracy of 10NN (customized weights): %.2f %%\"</span>", "<span class=\"o\">%</span>", "<span class=\"p\">(</span>", "<span class=\"mi\">100</span>", "<span class=\"o\">*</span>", "<span class=\"n\">accuracy_score</span>", "<span class=\"p\">(</span>", "<span class=\"n\">y_test</span>", "<span class=\"p\">,</span>", "<span class=\"n\">y_pred</span>", "<span class=\"p\">))</span>", "<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 10NN (customized weights): 98.00 %\n</code></pre></div></div>", "<div class=\"highlight\"><pre class=\"highlight\"><code>Accuracy of 10NN (customized weights): 98.00 %\n</code></pre></div>", "<pre class=\"highlight\"><code>Accuracy of 10NN (customized weights): 98.00 %\n</code></pre>", "<code>Accuracy of 10NN (customized weights): 98.00 %\n</code>", "<p>Trong trường hợp này, kết quả tương đương với kỹ thuật major voting. Để đánh giá chính xác hơn kết quả của KNN với K khác nhau, cách định nghĩa khoảng cách khác nhau và cách đánh trọng số khác nhau, chúng ta cần thực hiện quá trình trên với nhiều cách chia dữ liệu <em>training</em> và <em>test</em> khác nhau rồi lấy kết quả trung bình, vì rất có thể dữ liệu phân chia trong 1 trường hợp cụ thể là rất tốt hoặc rất xấu (bias). Đây cũng là cách thường được dùng khi đánh giá hiệu năng của một thuật toán cụ thể nào đó.</p>", "<em>training</em>", "<em>test</em>", "<p><a name=\"-thao-luan\"></a></p>", "<a name=\"-thao-luan\"></a>"]}}