{"topic": "<ul class=\"tags\">\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#Linear-models\">Linear-models</a>\n<a class=\"tag\" href=\"https://machinelearningcoban.com/tags#Classification\">Classification</a>\n</ul>", "title": "<h1 class=\"post-title\" itemprop=\"name\">Bài 22: Multi-class Support Vector Machine</h1>", "introduction": {"title": "<h2 id=\"1-giới-thiệu\">1. Giới thiệu</h2>", "content": "<p><a name=\"tu-binary-classification-toi-multi-class-classification\"></a></p><h3 id=\"11từ-binary-classification-tới-multi-class-classification\">1.1.Từ Binary classification tới multi-class classification</h3><p>Các phương pháp Support Vector Machine đã đề cập (Hard Margin, Soft Margin, Kernel) đều được xây dựng nhằm giải quyết bài toán <a href=\"https://machinelearningcoban.com/2017/02/11/binaryclassifiers/\">Binary Classification</a>, tức bài toán phân lớp với chỉ hai classes. Việc này cũng tương tự như <a href=\"https://machinelearningcoban.com/2017/01/21/perceptron/\">Percetron Learning Algorithm</a> hay <a href=\"https://machinelearningcoban.com/2017/01/27/logisticregression/\">Logistic Regression</a> vậy. Các mô hình làm việc với bài toán có 2 classes còn được gọi là Binary classifiers. Một cách tự nhiên để mở rộng các mô hình này áp dụng cho các bài toán multi-class classification, tức có nhiều classes dữ liệu khác nhau, là <a href=\"https://machinelearningcoban.com/2017/02/11/binaryclassifiers/#-binary-classifiers-cho-multi-class-classification-problems\">sử dụng nhiều binary classifiers và các kỹ thuật như one-vs-one hoặc one-vs-rest</a>. Cách làm này có những hạn chế như đã trình bày trong bài <a href=\"https://machinelearningcoban.com/2017/02/17/softmax/\">Softmax Regression</a>.</p><p><a name=\"-mo-hinh-end-to-end\"></a></p><h3 id=\"12-mô-hình-end-to-end\">1.2. Mô hình end-to-end</h3><p>Softmax Regression là mở rộng của Logistic Regression cho bài toán multi-class classification, có thể được coi là một layer của Neural Networks. Nhờ đó, Softmax Regression thường đươc sử dụng rất nhiều trong các bộ phân lớp hiện nay. Các bộ phân lớp cho kết quả cao nhất thường là một Neural Network với rất nhiều layers và layer cuối là một softmax regression, đặc biệt là các Convolutional Neural Networks. Các layer trước thường là kết hợp của các Convolutional layers và các nonlinear activation functions và pooling, các bạn tạm thời chưa cần quan tâm đến các layers phía trước này, tôi sẽ giới thiệu khi có dịp. Có thể coi các layer trước layer cuối là một công cụ giúp trích chọn đặc trưng của dữ liệu (Feature extraction), layer cuối là softmax regression, là một bộ phân lớp tuyến tính đơn giản nhưng rất hiệu quả. Bằng cách này, ta có thể coi là nhiều one-vs-rest classifers được huấn luyện cùng nhau, hỗ trợ lẫn nhau, vì vậy, một cách tự nhiên, sẽ có thể tốt hơn là huấn luyện từng classifier riêng lẻ.</p><p>Sự hiệu quả của Softmax Regression nói riêng và Convolutional Neural Networks nói chung là cả <em>bộ trích chọn đặc trưng</em> (feature extractor) và <em>bộ phân lớp</em> (classifier) được <em>huấn luyện</em> đồng thời. Điều này nghĩa là hai <em>bộ phận</em> này bổ trợ cho nhau trong quá trình huấn luyện. Classifier giúp tìm ra các hệ số hợp lý phù hợp với feature vector tìm được, ngược lại, feature extractor lại điều chỉnh các hệ số của các convolutional layer sao cho feature thu được là tuyến tính, phù hợp với classifier ở layer cuối cùng.</p><p>Tôi viết đến đây không phải là để giới thiệu về Softmax Regression, mà là đang nói chung đến các mô hình phân lớp <em>hiện đại</em>. Đặc điểm chung của chúng là feature extractor và classifier được huấn luyện một cách đồng thời. Những mô hình như thế này còn được gọi là <em>end-to-end</em>. Cùng xem lại mô hình chung cho các bài toán Machine Learning mà tôi đã đề cập trong Bài 11:</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/ML_models.png\" width=\"800\"/>\n<div class=\"thecap\">Hình 1: Mô hình chung cho các bài toán Machine Learning.</div>\n</div><hr/><p>Trong Hình 1, phần TRAINING PHASE, chúng ta có thể thấy rằng có hai khối chính là <em>Feature Extraction</em> và <em>Classification/Regression/Clustering…</em> Các phương pháp <em>truyền thống</em> thường xây dựng hai khối này qua các bước riêng rẽ. Phần Feature Extraction với dữ liệu ảnh có thể dùng các feature descriptor như <a href=\"http://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_feature2d/py_sift_intro/py_sift_intro.html\">SIFT</a>, <a href=\"http://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_feature2d/py_surf_intro/py_surf_intro.html\">SURF</a>, <a href=\"http://www.learnopencv.com/histogram-of-oriented-gradients/\">HOG</a>; với dữ liệu văn bản thì có thể là <a href=\"https://machinelearningcoban.com/2017/04/28/multiclasssmv/2017/02/06/featureengineering/#bag-of-words\">Bag of Words</a> hoặc <a href=\"http://www.tfidf.com/\">TF-IDF</a>. Nếu là các bài toán classification, phần còn lại có thể là SVM thông thường hay các bộ phân lớp <em>truyền thống</em> khác.</p><p>Với sự phát triển của Deep Learning trong những năm gần đây, người ta cho rằng các hệ thống <em>end-to-end</em> (từ đầu đến cuối) mang lại kết quả tốt hơn nhờ và việc các hai khối phía trên được huấn luyện cùng nhau, bổ trợ lẫn nhau. Thực tế cho thấy, các phương pháp <em>state-of-the-art</em> thường là các mô hình <em>end-to-end</em>.</p><p>Các phương pháp Support Vector Machine được chứng minh là tốt hơn Logistic Regression vì chúng có quan tâm đến việc tạo <em>margin</em> lớn nhất giữa các classes. Câu hỏi đặt ra là:</p><p><strong>Liệu có cách nào giúp kết hợp SVM với Neural Networks để tạo ra một bộ phân lớp tốt với bài toán multi-class classification? Hơn nữa, toàn bộ hệ thống có thể được huấn luyện theo kiểu <em>end-to-end</em>?</strong></p><p>Câu trả lời sẽ được tìm thấy trong bài viết này, bằng một phương pháp được gọi là <em>Multi-class Support Vector Machine</em>.</p><p>Và để cho bài viết hấp dẫn hơn, tôi xin giới thiệu luôn, ở phần cuối, chúng ta sẽ cùng lập trình từ đầu đến cuối để giải quyết bài toán phân lớp với bộ cơ sở dữ liệu nổi tiếng: CIFAR10.</p><p><a name=\"-bo-co-so-du-lieu-cifar\"></a></p><h3 id=\"13-bộ-cơ-sở-dữ-liệu-cifar10\">1.3. Bộ cơ sở dữ liệu CIFAR10</h3><p>Bộ cơ sở dữ liệu CIFAR10 gồm 51000 ảnh khác nhau thuộc 10 classes: <em>plane, car, bird, cat, deer, dog, frog, horse, ship, và truck</em>. Mỗi bức ảnh có kích thước <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-2-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-4\"><span class=\"mjx-mrow\" id=\"MJXc-Node-5\"><span class=\"mjx-mn\" id=\"MJXc-Node-6\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-7\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-8\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>32</mn><mo>×</mo><mn>32</mn></math></span></span><script id=\"MathJax-Element-2\" type=\"math/tex\">32 \\times 32</script> pixel. Một vài ví dụ cho mỗi class được cho trong Hình 2 dưới đây. 50000 ảnh được sử dụng cho training, 1000 ảnh còn lại được dùng cho test. Trong số 50000 ảnh training, 1000 ảnh sẽ được lấy ra ngẫu nghiên để làm <a href=\"https://machinelearningcoban.com/2017/03/04/overfitting/#-validation-1\">validation set</a>.</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/cifar.png\" width=\"800\"/>\n<div class=\"thecap\">Hình 2: Ví dụ về 10 classes trong bộ dữ liệu CIFAR10.</div>\n</div><p>Đây là một bộ cơ sở dữ liệu tương đối khó vì ảnh nhỏ và object trong cùng một class cũng biến đổi rất nhiều về màu sắc, hình dáng, kích thước. <a href=\"http://rodrigob.github.io/are_we_there_yet/build/classification_datasets_results.html#43494641522d3130\">Thuật toán tốt nhất hiện nay cho bài toán này</a> đã đạt được độ chính xác trên 90%, sử dụng một Convolutional Neural Network nhiều lớp kết hợp với Softmax regression ở layer cuối cùng. Trong bài này, chúng ta sẽ sử dụng một mô hình neural network đơn giản không có hidden layer nào để giải quyết, kết quả đạt được là khoảng 40%, nhưng cũng là đã rất ấn tượng. Layer cuối là một layer Multi-class SVM. Tôi sẽ hướng dẫn các bạn lập trình cho mô hình này <em>từ đầu đến cuối</em> mà không sử dụng một thư viện đặc biệt nào ngoài numpy.</p><p>Bài toán này cũng như nội dung chính của bài viết được lấy từ Lecture notes: <a href=\"http://cs231n.github.io/linear-classify/\">Linear Classifier II</a> và <a href=\"http://cs231n.github.io/assignments2016/assignment1/\">Assignment #1</a> trong khoá học <a href=\"http://cs231n.github.io/\"><em>CS231n: Convolutional Neural Networks for Visual Recognition</em></a> kỳ Winter 2016 của Stanford.</p><p>Trước khi đi vào mục xây dựng hàm mất mát cho Multi-class SVM, tôi muốn nhắc lại một chút về một chút <em>feature engineering</em> cho ảnh trong CIFAR-10 và <strong>bias trick</strong> nói chung trong Neural Networks.</p><p><a name=\"-image-data-preprocessing\"></a></p><h3 id=\"14-image-data-preprocessing\">1.4. Image data preprocessing</h3><p>Để cho mọi thứ được đơn giản và có được một mô hình hoàn chỉnh, chúng ta sẽ sử dụng phương pháp <em>feature engineering</em> đơn giản nhất: lấy trực tiếp tất cả các pixel trong mỗi ảnh và thêm một chút normalization.</p><ul>\n<li>\n<p>Mỗi ảnh của CIFAR-10 đã có kích thước giống nhau <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-3-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-9\"><span class=\"mjx-mrow\" id=\"MJXc-Node-10\"><span class=\"mjx-mn\" id=\"MJXc-Node-11\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-12\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-13\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>32</mn><mo>×</mo><mn>32</mn></math></span></span><script id=\"MathJax-Element-3\" type=\"math/tex\">32 \\times 32</script> pixel, vì vậy việc đầu tiên chúng ta cần làm là <em>kéo dài</em> mỗi trong ba channels Red, Green, Blue của bức ảnh ra thành một vector có kích thước là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3072&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-4-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-14\"><span class=\"mjx-mrow\" id=\"MJXc-Node-15\"><span class=\"mjx-mn\" id=\"MJXc-Node-16\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-17\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-18\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-19\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-20\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-21\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-22\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3072</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>3</mn><mo>×</mo><mn>32</mn><mo>×</mo><mn>32</mn><mo>=</mo><mn>3072</mn></math></span></span><script id=\"MathJax-Element-4\" type=\"math/tex\">3 \\times 32 \\times 32 = 3072</script>.</p>\n</li>\n<li>\n<p>Vì mỗi pixel có giá trị là một số tự nhiên từ 0 đến 255 nên chúng ta cần một chút <a href=\"https://machinelearningcoban.com/general/2017/02/06/featureengineering/#feature-scaling-and-normalization\">chuẩn hóa dữ liệu</a>. Trong Machine Learning, một cách đơn giản nhất để chuẩn hóa dữ liệu là <strong>center data</strong>, tức làm cho mỗi feature có trung bình cộng bằng 0. Một cách đơn giản để làm việc này là ta tính trung bình cộng của tất cả các ảnh trong tập training để được <em>ảnh trung bình</em>, sau đó trừ từ tất cả các ảnh đi <em>ảnh trung bình</em> này. Tương tự, ta cũng dùng <em>ảnh trung bình</em> này để chuẩn hoá dữ liệu trong <em>validation set</em> và <em>test set</em>.</p>\n</li>\n</ul><p><a name=\"-bias-trick\"></a></p><h3 id=\"15-bias-trick\">1.5. Bias trick</h3><p>Thông thường, với một ma trận hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"double-struck\"&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-5-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-23\"><span class=\"mjx-mrow\" id=\"MJXc-Node-24\"><span class=\"mjx-texatom\" id=\"MJXc-Node-25\"><span class=\"mjx-mrow\" id=\"MJXc-Node-26\"><span class=\"mjx-mi\" id=\"MJXc-Node-27\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-28\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">∈</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-29\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-30\"><span class=\"mjx-mrow\" id=\"MJXc-Node-31\"><span class=\"mjx-mi\" id=\"MJXc-Node-32\"><span class=\"mjx-char MJXc-TeX-ams-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">R</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-33\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-34\"><span class=\"mjx-mi\" id=\"MJXc-Node-35\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.003em;\">d</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-36\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-37\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>d</mi><mo>×</mo><mi>C</mi></mrow></msup></math></span></span><script id=\"MathJax-Element-5\" type=\"math/tex\">\\mathbf{W} \\in \\mathbb{R}^{d\\times C}</script>, một đầu vào <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"double-struck\"&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;d&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-6-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-38\"><span class=\"mjx-mrow\" id=\"MJXc-Node-39\"><span class=\"mjx-texatom\" id=\"MJXc-Node-40\"><span class=\"mjx-mrow\" id=\"MJXc-Node-41\"><span class=\"mjx-mi\" id=\"MJXc-Node-42\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-43\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">∈</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-44\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-45\"><span class=\"mjx-mrow\" id=\"MJXc-Node-46\"><span class=\"mjx-mi\" id=\"MJXc-Node-47\"><span class=\"mjx-char MJXc-TeX-ams-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">R</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-48\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.003em;\">d</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mi>d</mi></msup></math></span></span><script id=\"MathJax-Element-6\" type=\"math/tex\">\\mathbf{x} \\in \\mathbb{R}^d</script> và vector bias <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"double-struck\"&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-7-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-49\"><span class=\"mjx-mrow\" id=\"MJXc-Node-50\"><span class=\"mjx-texatom\" id=\"MJXc-Node-51\"><span class=\"mjx-mrow\" id=\"MJXc-Node-52\"><span class=\"mjx-mi\" id=\"MJXc-Node-53\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">b</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-54\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">∈</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-55\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-56\"><span class=\"mjx-mrow\" id=\"MJXc-Node-57\"><span class=\"mjx-mi\" id=\"MJXc-Node-58\"><span class=\"mjx-char MJXc-TeX-ams-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">R</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-59\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">b</mi></mrow><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mi>C</mi></msup></math></span></span><script id=\"MathJax-Element-7\" type=\"math/tex\">\\mathbf{b} \\in \\mathbb{R}^C</script>, chúng ta có thể tính được đầu ra của layer này là:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-8-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-60\"><span class=\"mjx-mrow\" id=\"MJXc-Node-61\"><span class=\"mjx-mi\" id=\"MJXc-Node-62\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.483em; padding-right: 0.06em;\">f</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-63\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-64\"><span class=\"mjx-mrow\" id=\"MJXc-Node-65\"><span class=\"mjx-mi\" id=\"MJXc-Node-66\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-67\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-68\"><span class=\"mjx-mrow\" id=\"MJXc-Node-69\"><span class=\"mjx-mi\" id=\"MJXc-Node-70\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-71\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-72\"><span class=\"mjx-mrow\" id=\"MJXc-Node-73\"><span class=\"mjx-mi\" id=\"MJXc-Node-74\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">b</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-75\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-76\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-77\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-78\"><span class=\"mjx-mrow\" id=\"MJXc-Node-79\"><span class=\"mjx-mi\" id=\"MJXc-Node-80\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.619em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-81\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-82\"><span class=\"mjx-mrow\" id=\"MJXc-Node-83\"><span class=\"mjx-mi\" id=\"MJXc-Node-84\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-85\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-texatom MJXc-space2\" id=\"MJXc-Node-86\"><span class=\"mjx-mrow\" id=\"MJXc-Node-87\"><span class=\"mjx-mi\" id=\"MJXc-Node-88\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">b</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>f</mi><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">b</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo>+</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">b</mi></mrow></math></span></span></span><script id=\"MathJax-Element-8\" type=\"math/tex; mode=display\">\nf(\\mathbf{x}, \\mathbf{W}, \\mathbf{b}) = \\mathbf{W}^T\\mathbf{x} + \\mathbf{b}\n</script></p><p>Để cho biểu thức trên đơn giản hơn, ta có thể thêm một phần từ bằng 1 vào cuối của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-9-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-89\"><span class=\"mjx-mrow\" id=\"MJXc-Node-90\"><span class=\"mjx-texatom\" id=\"MJXc-Node-91\"><span class=\"mjx-mrow\" id=\"MJXc-Node-92\"><span class=\"mjx-mi\" id=\"MJXc-Node-93\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-9\" type=\"math/tex\">\\mathbf{x}</script> và <em>ghép</em> vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-10-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-94\"><span class=\"mjx-mrow\" id=\"MJXc-Node-95\"><span class=\"mjx-texatom\" id=\"MJXc-Node-96\"><span class=\"mjx-mrow\" id=\"MJXc-Node-97\"><span class=\"mjx-mi\" id=\"MJXc-Node-98\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">b</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">b</mi></mrow></math></span></span><script id=\"MathJax-Element-10\" type=\"math/tex\">\\mathbf{b}</script> vào ma trận <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-11-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-99\"><span class=\"mjx-mrow\" id=\"MJXc-Node-100\"><span class=\"mjx-texatom\" id=\"MJXc-Node-101\"><span class=\"mjx-mrow\" id=\"MJXc-Node-102\"><span class=\"mjx-mi\" id=\"MJXc-Node-103\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-11\" type=\"math/tex\">\\mathbf{W}</script> như ví dụ dưới đây:</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/biastrick.png\" width=\"800\"/>\n<div class=\"thecap\">Hình 3: Bias trick.</div>\n</div><hr/><p>Bây giờ thì ta chỉ còn 1 biến dữ liệu là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-12-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-104\"><span class=\"mjx-mrow\" id=\"MJXc-Node-105\"><span class=\"mjx-texatom\" id=\"MJXc-Node-106\"><span class=\"mjx-mrow\" id=\"MJXc-Node-107\"><span class=\"mjx-mi\" id=\"MJXc-Node-108\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-12\" type=\"math/tex\">\\mathbf{W}</script> thay vì hai biến dữ liệu như trước. Từ giờ trở đi, khi viết <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-13-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-109\"><span class=\"mjx-mrow\" id=\"MJXc-Node-110\"><span class=\"mjx-texatom\" id=\"MJXc-Node-111\"><span class=\"mjx-mrow\" id=\"MJXc-Node-112\"><span class=\"mjx-mi\" id=\"MJXc-Node-113\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-13\" type=\"math/tex\">\\mathbf{W}</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-14-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-114\"><span class=\"mjx-mrow\" id=\"MJXc-Node-115\"><span class=\"mjx-texatom\" id=\"MJXc-Node-116\"><span class=\"mjx-mrow\" id=\"MJXc-Node-117\"><span class=\"mjx-mi\" id=\"MJXc-Node-118\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-14\" type=\"math/tex\">\\mathbf{x}</script>, chúng ta ngầm hiểu là biến mới và dữ liệu mới như ở phần bên phải của Hình 3. \n<a name=\"-xay-dung-ham-mat-mat-cho-multi-class-support-vector-machine\"></a></p>"}, "formulas": {"title": "<h2 id=\"2-xây-dựng-hàm-mất-mát-cho-multi-class-support-vector-machine\">2. Xây dựng hàm mất mát cho Multi-class Support Vector Machine</h2>", "content": "<p>Chúng ta cùng quay lại một chút với ý tưởng của Softmax Regression với hàm mất mát Cross-entropy. Sau đó, chúng ta sẽ làm quen với Multi-class SVM với hàm mất mát hinge loss mở rộng.</p><p><a name=\"-nhac-lai-softmax-regression\"></a></p><h3 id=\"21-nhắc-lại-softmax-regression\">2.1. Nhắc lại Softmax Regression.</h3><p>Chúng ta cùng xem lại <a href=\"https://machinelearningcoban.com/2017/02/17/softmax/#-softmax-function\">Softmax layer đã được trình bày trong Bài 13</a>.</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/softmax_nn.png\" width=\"800\"/>\n<div class=\"thecap\">Hình 4: Mô hình Softmax Regression dưới dạng Neural network.</div>\n</div><hr/><p>Trong Hình 4 ở trên, dữ liệu trong lớp màu xanh lục được coi như <em>feature vector</em> của dữ liệu. Với dữ liệu CIFAR-10, nếu ta coi mỗi feature là giá trị của từng pixel trong ảnh, tổng số chiều của <em>feature vector</em> cho mỗi bức ảnh là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;3073&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-15-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-119\"><span class=\"mjx-mrow\" id=\"MJXc-Node-120\"><span class=\"mjx-mn\" id=\"MJXc-Node-121\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-122\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-123\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-124\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-125\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-126\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-127\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-128\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-129\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3073</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>32</mn><mo>×</mo><mn>32</mn><mo>×</mo><mn>3</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>3073</mn></math></span></span><script id=\"MathJax-Element-15\" type=\"math/tex\">32\\times 32 \\times 3 +1 = 3073</script>, với 3 là số channels trong bức ảnh (Red, Green, Blue).</p><p>Qua ma trận hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-16-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-130\"><span class=\"mjx-mrow\" id=\"MJXc-Node-131\"><span class=\"mjx-texatom\" id=\"MJXc-Node-132\"><span class=\"mjx-mrow\" id=\"MJXc-Node-133\"><span class=\"mjx-mi\" id=\"MJXc-Node-134\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-16\" type=\"math/tex\">\\mathbf{W}</script>, dữ liệu ban đầu trở thành <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-17-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-135\"><span class=\"mjx-mrow\" id=\"MJXc-Node-136\"><span class=\"mjx-texatom\" id=\"MJXc-Node-137\"><span class=\"mjx-mrow\" id=\"MJXc-Node-138\"><span class=\"mjx-mi\" id=\"MJXc-Node-139\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-140\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-141\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-142\"><span class=\"mjx-mrow\" id=\"MJXc-Node-143\"><span class=\"mjx-mi\" id=\"MJXc-Node-144\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.619em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-145\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-146\"><span class=\"mjx-mrow\" id=\"MJXc-Node-147\"><span class=\"mjx-mi\" id=\"MJXc-Node-148\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow><mo>=</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-17\" type=\"math/tex\">\\mathbf{z} = \\mathbf{W}^T\\mathbf{x}</script>.</p><p>Lúc này, ứng với mỗi một trong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-18-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-149\"><span class=\"mjx-mrow\" id=\"MJXc-Node-150\"><span class=\"mjx-mi\" id=\"MJXc-Node-151\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi></math></span></span><script id=\"MathJax-Element-18\" type=\"math/tex\">C</script> classes, chúng ta nhận được một giá trị tương ứng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-19-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-152\"><span class=\"mjx-mrow\" id=\"MJXc-Node-153\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-154\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-155\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-156\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-19\" type=\"math/tex\">z_i</script> ứng với class thứ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-20-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-157\"><span class=\"mjx-mrow\" id=\"MJXc-Node-158\"><span class=\"mjx-mi\" id=\"MJXc-Node-159\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script id=\"MathJax-Element-20\" type=\"math/tex\">i</script>. Giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-21-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-160\"><span class=\"mjx-mrow\" id=\"MJXc-Node-161\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-162\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-163\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-164\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-21\" type=\"math/tex\">z_i</script> này còn được gọi là <em>score</em> của dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-22-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-165\"><span class=\"mjx-mrow\" id=\"MJXc-Node-166\"><span class=\"mjx-texatom\" id=\"MJXc-Node-167\"><span class=\"mjx-mrow\" id=\"MJXc-Node-168\"><span class=\"mjx-mi\" id=\"MJXc-Node-169\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-22\" type=\"math/tex\">\\mathbf{x}</script> ứng với class thứ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-23-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-170\"><span class=\"mjx-mrow\" id=\"MJXc-Node-171\"><span class=\"mjx-mi\" id=\"MJXc-Node-172\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>i</mi></math></span></span><script id=\"MathJax-Element-23\" type=\"math/tex\">i</script>.</p><p>Ý tưởng chính trong Sofftmax Regression là đi tìm ma trận hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-24-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-173\"><span class=\"mjx-mrow\" id=\"MJXc-Node-174\"><span class=\"mjx-texatom\" id=\"MJXc-Node-175\"><span class=\"mjx-mrow\" id=\"MJXc-Node-176\"><span class=\"mjx-mi\" id=\"MJXc-Node-177\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-24\" type=\"math/tex\">\\mathbf{W}</script>, mỗi cột của ma trận này ứng với một class, sao cho <em>score vector</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-25-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-178\"><span class=\"mjx-mrow\" id=\"MJXc-Node-179\"><span class=\"mjx-texatom\" id=\"MJXc-Node-180\"><span class=\"mjx-mrow\" id=\"MJXc-Node-181\"><span class=\"mjx-mi\" id=\"MJXc-Node-182\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script id=\"MathJax-Element-25\" type=\"math/tex\">\\mathbf{z}</script> đạt giá trị lớn nhất tại phần tử tương ứng với class chính xác của nó. Sau khi mô hình đã được <em>trained</em>, <em>nhãn</em> của một điểm dữ liệu mới được tính là vị trí của thành phần score có giá trị lớn nhất trong <em>score vector</em>. Xem ví dụ trong Hình 5 dưới đây:</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/scores.png\" width=\"800\"/>\n<div class=\"thecap\">Hình 5: Ví dụ về cách tính score vector. Khi test, nhãn của dữ liệu được xác định dựa trên class có score cao nhất.</div>\n</div><hr/><p>Để huấn luyện trên tập các cặp (<em>dữ liệu</em>, <em>nhãn</em>), Softmax Regression sử dụng hàm softmax để đưa <em>score vector</em> về dạng phân phối xác suất có các phần tử là dương và có tổng bằng 1. Sau đó dùng hàm cross entropy để <em>ép</em> vector xác suất này gần với vector xác suất <em>thật sự</em> của dữ liệu - tức one-hot vector mà chỉ có đúng 1 phần tử bằng 1 tại class tương ứng, các phần tử còn lại bằng 0.</p><p><a name=\"-hinge-losss-tong-quat-cho-multi-class-svm\"></a></p><h3 id=\"23-hinge-losss-tổng-quát-cho-multi-class-svm\">2.3. Hinge losss tổng quát cho Multi-class SVM</h3><p>Với Multi-class SVM, trong khi tesst, class của một input cũng được xác định bởi thành phần có giá trị lớn nhất trong score vector. Điều này giống với Softmax Regression.</p><p>Softmax Regression sử dụng cross-entropy để <em>ép</em> hai vector xác suất bằng nhau, tức ép phần tử tương ứng với <em>correct class</em> trong vector xác suất gần với 1, đồng thời, các phần tử còn lại trong vector đó gần với 0. Nói cách khác, cách làm này khiến cho phần tử tương ứng với <em>correct class</em> càng lớn hơn các phần tử còn lại càng tốt. Trong khi đó, Multi-class SVM sử dụng một chiến thuật khác cho mục đích tương tự dựa trên <em>score vector</em>. Điểm khác biệt là Multi-class SVM xây dựng hàm mất mát dựa trên định nghĩa của <em>biên an toàn</em>, giống như trong Hard/Soft Margin vậy. Multi-class SVM <em>muốn</em> thành phần ứng với <em>correct class</em> của <em>score vector</em> lớn hơn các phần tử khác, không những thế, nó còn lớn hơn một đại lượng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-26-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-183\"><span class=\"mjx-mrow\" id=\"MJXc-Node-184\"><span class=\"mjx-mi\" id=\"MJXc-Node-185\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-186\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">&gt;</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-187\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi><mo>&gt;</mo><mn>0</mn></math></span></span><script id=\"MathJax-Element-26\" type=\"math/tex\">\\Delta > 0</script> gọi là <em>biên an toàn</em>. Hãy xem Hình 6 dưới đây:</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/hinge.png\" width=\"800\"/>\n<div align=\"justify\" class=\"thecap\">Hình 6: Mô tả hinge loss cho Multi-class Support Vector Machine. Multi-class SVM <em> muốn </em> score của <em> correct class </em>, được minh hoạ bởi điểm màu lam, cao hơn các scores khác, minh hoạ bởi các điểm màu lục, một khoảng cách an toàn <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-27-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-188\"><span class=\"mjx-mrow\" id=\"MJXc-Node-189\"><span class=\"mjx-mi\" id=\"MJXc-Node-190\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.369em;\">Δ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi></math></span></span><script id=\"MathJax-Element-27\" type=\"math/tex\">\\Delta</script> là đoạn màu đỏ. Những scores khác nằm trong vùng an toàn (phía trái của điểm x màu đỏ) sẽ không gây ra mất mát gì, những scores nằm trong hoặc bên phải vùng màu đỏ đã <em>vi phạm</em> quy tắc và cần được <em>xử phạt</em>. </div>\n</div><hr/><p>Với cách xác định biên như trên, Multi-class SVM sẽ <em>cho qua</em> những scores nằm về phía trước vùng màu đỏ. Những điểm có scores nằm phía phải của ngưỡng (chữ x màu đỏ) sẽ bị <em>xử phạt</em>, và càng vi phạm nhiều sẽ càng bị xử lý ở mức cao.</p><p>Để mô tả các mức vi phạm này dưới dạng toán học, trước hết ta giả sử rằng các thành phần của score vector được đánh số thứ tự từ 1. Các classes cũng được đánh số thứ tự từ 1. Giả sử rằng điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-28-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-191\"><span class=\"mjx-mrow\" id=\"MJXc-Node-192\"><span class=\"mjx-texatom\" id=\"MJXc-Node-193\"><span class=\"mjx-mrow\" id=\"MJXc-Node-194\"><span class=\"mjx-mi\" id=\"MJXc-Node-195\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-28\" type=\"math/tex\">\\mathbf{x}</script> đang xét thuộc class <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-29-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-196\"><span class=\"mjx-mrow\" id=\"MJXc-Node-197\"><span class=\"mjx-mi\" id=\"MJXc-Node-198\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>y</mi></math></span></span><script id=\"MathJax-Element-29\" type=\"math/tex\">y</script> và score vector của nó là vector <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-30-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-199\"><span class=\"mjx-mrow\" id=\"MJXc-Node-200\"><span class=\"mjx-texatom\" id=\"MJXc-Node-201\"><span class=\"mjx-mrow\" id=\"MJXc-Node-202\"><span class=\"mjx-mi\" id=\"MJXc-Node-203\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow></math></span></span><script id=\"MathJax-Element-30\" type=\"math/tex\">\\mathbf{z}</script>. Thế thì score của <em>correct class</em> là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-31-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-204\"><span class=\"mjx-mrow\" id=\"MJXc-Node-205\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-206\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-207\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-208\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>y</mi></msub></math></span></span><script id=\"MathJax-Element-31\" type=\"math/tex\">z_y</script>, scores của các classes khác là các <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-32-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-209\"><span class=\"mjx-mrow\" id=\"MJXc-Node-210\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-211\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-212\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-213\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-214\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-215\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-216\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-217\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub><mo>,</mo><mi>i</mi><mo>≠</mo><mi>y</mi></math></span></span><script id=\"MathJax-Element-32\" type=\"math/tex\">z_i, i \\neq y</script>. Xét ví dụ như trong Hình 6 với hai score <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-33-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-218\"><span class=\"mjx-mrow\" id=\"MJXc-Node-219\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-220\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-221\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-222\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-33\" type=\"math/tex\">z_i</script> trong vùng an toàn và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-34-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-223\"><span class=\"mjx-mrow\" id=\"MJXc-Node-224\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-225\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-226\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-227\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>j</mi></msub></math></span></span><script id=\"MathJax-Element-34\" type=\"math/tex\">z_j</script> trong vùng vi phạm.</p><ul>\n<li>\n<p>Với mỗi score <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-35-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-228\"><span class=\"mjx-mrow\" id=\"MJXc-Node-229\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-230\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-231\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-232\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-35\" type=\"math/tex\">z_i</script> trong vùng an toàn, <em>loss</em> bằng 0.</p>\n</li>\n<li>\n<p>Với mỗi socre <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-36-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-233\"><span class=\"mjx-mrow\" id=\"MJXc-Node-234\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-235\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-236\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-237\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>j</mi></msub></math></span></span><script id=\"MathJax-Element-36\" type=\"math/tex\">z_j</script> vượt quá điểm an toàn (điểm x đỏ), <em>loss</em> do nó gây ra được tính bằng lượng vượt quá so với điểm x đỏ, đại lượng này có thể tính được là: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-37-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-238\"><span class=\"mjx-mrow\" id=\"MJXc-Node-239\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-240\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-241\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-242\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-243\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-244\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-245\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-246\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-247\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-248\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mi MJXc-space2\" id=\"MJXc-Node-249\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-250\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-251\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-252\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-253\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-254\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-255\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-256\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-257\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-258\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-259\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-260\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>j</mi></msub><mo>−</mo><mo stretchy=\"false\">(</mo><msub><mi>z</mi><mi>y</mi></msub><mo>−</mo><mi mathvariant=\"normal\">Δ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msub><mi>z</mi><mi>y</mi></msub><mo>+</mo><msub><mi>z</mi><mi>j</mi></msub></math></span></span><script id=\"MathJax-Element-37\" type=\"math/tex\">z_j - (z_y - \\Delta) = \\Delta - z_y + z_j</script>.</p>\n</li>\n</ul><p>Tóm lại, với một score <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-38-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-261\"><span class=\"mjx-mrow\" id=\"MJXc-Node-262\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-263\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-264\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-265\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-266\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-267\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-268\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-269\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>z</mi><mi>j</mi></msub><mo>,</mo><mi>j</mi><mo>≠</mo><mi>y</mi></math></span></span><script id=\"MathJax-Element-38\" type=\"math/tex\">z_j, j \\neq y</script>, <em>loss</em> do nó gây ra có thể được viết gọn thành:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-39-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-270\"><span class=\"mjx-mrow\" id=\"MJXc-Node-271\"><span class=\"mjx-mo\" id=\"MJXc-Node-272\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-273\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-274\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-275\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-276\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-277\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-278\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-279\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-280\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-281\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-282\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-283\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-284\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-285\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-286\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-287\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-288\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-289\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-290\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-291\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-292\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-293\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-294\"><span class=\"mjx-mrow\" id=\"MJXc-Node-295\"><span class=\"mjx-mi\" id=\"MJXc-Node-296\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-298\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-297\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-299\"><span class=\"mjx-mrow\" id=\"MJXc-Node-300\"><span class=\"mjx-mi\" id=\"MJXc-Node-301\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-302\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-303\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-304\"><span class=\"mjx-mrow\" id=\"MJXc-Node-305\"><span class=\"mjx-mi\" id=\"MJXc-Node-306\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-308\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-307\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-309\"><span class=\"mjx-mrow\" id=\"MJXc-Node-310\"><span class=\"mjx-mi\" id=\"MJXc-Node-311\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-312\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-313\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-314\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-315\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-316\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-317\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-318\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-319\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-320\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msub><mi>z</mi><mi>y</mi></msub><mo>+</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>y</mi><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-39\" type=\"math/tex; mode=display\">\n\\max(0, \\Delta - z_y + z_j) = \\max(0, \\Delta - \\mathbf{w}_y^T\\mathbf{x} + \\mathbf{w}_j^T\\mathbf{x}) ~~~~~ (1)\n</script>\ntrong đó <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-40-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-321\"><span class=\"mjx-mrow\" id=\"MJXc-Node-322\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-323\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-324\"><span class=\"mjx-mrow\" id=\"MJXc-Node-325\"><span class=\"mjx-mi\" id=\"MJXc-Node-326\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-327\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi></msub></math></span></span><script id=\"MathJax-Element-40\" type=\"math/tex\">\\mathbf{w}_j</script> là <em>cột</em> thứ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-41-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-328\"><span class=\"mjx-mrow\" id=\"MJXc-Node-329\"><span class=\"mjx-mi\" id=\"MJXc-Node-330\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>j</mi></math></span></span><script id=\"MathJax-Element-41\" type=\"math/tex\">j</script> của ma trận hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-42-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-331\"><span class=\"mjx-mrow\" id=\"MJXc-Node-332\"><span class=\"mjx-texatom\" id=\"MJXc-Node-333\"><span class=\"mjx-mrow\" id=\"MJXc-Node-334\"><span class=\"mjx-mi\" id=\"MJXc-Node-335\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-42\" type=\"math/tex\">\\mathbf{W}</script>.</p><p>Như vậy, với một điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-43-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-336\"><span class=\"mjx-mrow\" id=\"MJXc-Node-337\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-338\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-339\"><span class=\"mjx-mrow\" id=\"MJXc-Node-340\"><span class=\"mjx-mi\" id=\"MJXc-Node-341\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-342\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-343\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-344\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-345\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-346\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-347\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-348\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-349\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-350\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-351\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-352\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>,</mo><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi></math></span></span><script id=\"MathJax-Element-43\" type=\"math/tex\">\\mathbf{x}_n, n = 1, 2, \\dots, N</script>, tổng cộng <em>loss</em> do nó gây ra là:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-44-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-353\"><span class=\"mjx-mrow\" id=\"MJXc-Node-354\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-355\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-356\"><span class=\"mjx-mrow\" id=\"MJXc-Node-357\"><span class=\"mjx-mi\" id=\"MJXc-Node-358\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-359\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-360\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-munderover MJXc-space3\" id=\"MJXc-Node-361\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.034em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-362\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-363\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-364\"><span class=\"mjx-mi\" id=\"MJXc-Node-365\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-366\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-367\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-368\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-369\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-370\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-371\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-372\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-373\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-374\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-375\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-376\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-377\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-383\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-378\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-379\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-380\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-381\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-382\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-384\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-385\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-386\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-388\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-387\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-389\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>n</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msubsup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>n</mi></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>j</mi><mi>n</mi></msubsup><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-44\" type=\"math/tex; mode=display\">\n\\mathcal{L}_n = \\sum_{j \\neq y_n} \\max(0, \\Delta  - z_{y_n}^n + z_j^n)\n</script></p><p>trong đó <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;msup&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"double-struck\"&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;' id=\"MathJax-Element-45-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-390\"><span class=\"mjx-mrow\" id=\"MJXc-Node-391\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-392\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-393\"><span class=\"mjx-mrow\" id=\"MJXc-Node-394\"><span class=\"mjx-mi\" id=\"MJXc-Node-395\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">z</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-396\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-397\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-398\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-399\"><span class=\"mjx-mrow\" id=\"MJXc-Node-400\"><span class=\"mjx-mi\" id=\"MJXc-Node-401\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-402\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-403\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-404\"><span class=\"mjx-mrow\" id=\"MJXc-Node-405\"><span class=\"mjx-mi\" id=\"MJXc-Node-406\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-407\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-408\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-409\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-410\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-411\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-413\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-412\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-414\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-415\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-416\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-418\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-417\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-419\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-420\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-421\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-422\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-423\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.343em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-425\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-424\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-426\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-427\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-428\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-429\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">∈</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-430\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-431\"><span class=\"mjx-mrow\" id=\"MJXc-Node-432\"><span class=\"mjx-mi\" id=\"MJXc-Node-433\"><span class=\"mjx-char MJXc-TeX-ams-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">R</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.615em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-434\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-435\"><span class=\"mjx-mi\" id=\"MJXc-Node-436\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-437\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-438\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">z</mi></mrow><mi>n</mi></msup><mo>=</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>T</mi></msup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>=</mo><mo stretchy=\"false\">[</mo><msubsup><mi>z</mi><mn>1</mn><mi>n</mi></msubsup><mo>,</mo><msubsup><mi>z</mi><mn>2</mn><mi>n</mi></msubsup><mo>,</mo><mo>…</mo><mo>,</mo><msubsup><mi>z</mi><mi>C</mi><mi>n</mi></msubsup><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup><mo>∈</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"double-struck\">R</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>C</mi><mo>×</mo><mn>1</mn></mrow></msup></math></span></span><script id=\"MathJax-Element-45\" type=\"math/tex\">\\mathbf{z}^n = \\mathbf{w}^T\\mathbf{x}_n = [z^n_1, z^n_2, \\dots, z^n_C]^T \\in \\mathbb{R}^{C \\times 1}</script> là scores tương ứng với điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-46-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-439\"><span class=\"mjx-mrow\" id=\"MJXc-Node-440\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-441\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-442\"><span class=\"mjx-mrow\" id=\"MJXc-Node-443\"><span class=\"mjx-mi\" id=\"MJXc-Node-444\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-445\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub></math></span></span><script id=\"MathJax-Element-46\" type=\"math/tex\">\\mathbf{x}_n</script>; <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-47-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-446\"><span class=\"mjx-mrow\" id=\"MJXc-Node-447\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-448\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-449\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-450\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>n</mi></msub></math></span></span><script id=\"MathJax-Element-47\" type=\"math/tex\">y_n</script> là <em>correct class</em> của điểm dữ liệu đó.</p><p>Với toàn bộ các điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-48-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-451\"><span class=\"mjx-mrow\" id=\"MJXc-Node-452\"><span class=\"mjx-texatom\" id=\"MJXc-Node-453\"><span class=\"mjx-mrow\" id=\"MJXc-Node-454\"><span class=\"mjx-mi\" id=\"MJXc-Node-455\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-456\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-457\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-458\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-459\"><span class=\"mjx-mrow\" id=\"MJXc-Node-460\"><span class=\"mjx-mi\" id=\"MJXc-Node-461\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-462\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-463\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-464\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-465\"><span class=\"mjx-mrow\" id=\"MJXc-Node-466\"><span class=\"mjx-mi\" id=\"MJXc-Node-467\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-468\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-469\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-470\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-471\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-472\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-473\"><span class=\"mjx-mrow\" id=\"MJXc-Node-474\"><span class=\"mjx-mi\" id=\"MJXc-Node-475\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-476\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-477\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>N</mi></msub><mo stretchy=\"false\">]</mo></math></span></span><script id=\"MathJax-Element-48\" type=\"math/tex\">\\mathbf{X} = [\\mathbf{x}_1, \\mathbf{x}_2, \\dots, \\mathbf{x}_N ]</script>, <em>loss</em> tổng cộng là:\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-49-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-478\"><span class=\"mjx-mrow\" id=\"MJXc-Node-479\"><span class=\"mjx-texatom\" id=\"MJXc-Node-480\"><span class=\"mjx-mrow\" id=\"MJXc-Node-481\"><span class=\"mjx-mi\" id=\"MJXc-Node-482\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-483\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-484\"><span class=\"mjx-mrow\" id=\"MJXc-Node-485\"><span class=\"mjx-mi\" id=\"MJXc-Node-486\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-487\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-488\"><span class=\"mjx-mrow\" id=\"MJXc-Node-489\"><span class=\"mjx-mi\" id=\"MJXc-Node-490\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-491\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-492\"><span class=\"mjx-mrow\" id=\"MJXc-Node-493\"><span class=\"mjx-mi\" id=\"MJXc-Node-494\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-495\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-496\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mfrac MJXc-space3\" id=\"MJXc-Node-497\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 1.088em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 1.088em; top: -1.368em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-498\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span><span class=\"mjx-denominator\" style=\"width: 1.088em; bottom: -0.711em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-499\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 1.088em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.078em; vertical-align: -0.711em;\"></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-500\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-507\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-501\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.082em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-502\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-503\"><span class=\"mjx-mi\" id=\"MJXc-Node-504\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-505\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-506\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-508\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.034em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-509\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-510\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-511\"><span class=\"mjx-mi\" id=\"MJXc-Node-512\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-513\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-514\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-515\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-516\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-517\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-518\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-519\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-520\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-521\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-522\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-523\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-524\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-530\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-525\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-526\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-527\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-528\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-529\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-531\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-532\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-533\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-535\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-534\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-536\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-537\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-538\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-539\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-540\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-541\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-542\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-543\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-544\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msubsup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>n</mi></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>j</mi><mi>n</mi></msubsup><mo stretchy=\"false\">)</mo><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-49\" type=\"math/tex; mode=display\">\n\\mathcal{L}(\\mathbf{X}, \\mathbf{y}, \\mathbf{W}) = \\frac{1}{N}\\sum_{n=1}^N \\sum_{j \\neq y_n} \\max(0, \\Delta - z_{y_n}^n + z_j^n) ~~~~~ (2)\n</script>\nvới <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;[&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;]&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-50-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-545\"><span class=\"mjx-mrow\" id=\"MJXc-Node-546\"><span class=\"mjx-texatom\" id=\"MJXc-Node-547\"><span class=\"mjx-mrow\" id=\"MJXc-Node-548\"><span class=\"mjx-mi\" id=\"MJXc-Node-549\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-550\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-551\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">[</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-552\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-553\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-554\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-555\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-556\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-557\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-558\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-559\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-560\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-561\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-562\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-563\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-564\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-565\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">]</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><msub><mi>y</mi><mn>2</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>y</mi><mi>N</mi></msub><mo stretchy=\"false\">]</mo></math></span></span><script id=\"MathJax-Element-50\" type=\"math/tex\">\\mathbf{y} = [y_1, y_2, \\dots, y_N]</script> là vector chứa <em>corect class</em> của toàn bộ các điểm dữ liệu trong <em>training set</em>. Hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;' id=\"MathJax-Element-51-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-566\"><span class=\"mjx-mrow\" id=\"MJXc-Node-567\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-568\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 0.769em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"font-size: 70.7%; width: 1.088em; top: -1.301em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-569\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span><span class=\"mjx-denominator\" style=\"font-size: 70.7%; width: 1.088em; bottom: -0.611em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-570\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 0.769em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 1.352em; vertical-align: -0.432em;\"></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mn>1</mn><mi>N</mi></mfrac></math></span></span><script id=\"MathJax-Element-51\" type=\"math/tex\">\\frac{1}{N}</script> tính trung bình của <em>loss</em> để tránh việc biểu thức này quá lớn gây tràn số máy tính.</p><p>Có một <em>bug</em> trong lỗi này, chúng ta cùng phân tích tiếp.</p><p><a name=\"-regularization\"></a></p><h3 id=\"24-regularization\">2.4. Regularization</h3><p>Điều gì sẽ xảy ra nếu nghiệm tìm được <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-52-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-571\"><span class=\"mjx-mrow\" id=\"MJXc-Node-572\"><span class=\"mjx-texatom\" id=\"MJXc-Node-573\"><span class=\"mjx-mrow\" id=\"MJXc-Node-574\"><span class=\"mjx-mi\" id=\"MJXc-Node-575\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow></math></span></span><script id=\"MathJax-Element-52\" type=\"math/tex\">\\mathbf{w}</script> là <em>hoàn hảo</em>, tức không có score nào <em>vi phạm</em> và biểu thức <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-53-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-576\"><span class=\"mjx-mrow\" id=\"MJXc-Node-577\"><span class=\"mjx-mo\" id=\"MJXc-Node-578\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-579\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-580\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-53\" type=\"math/tex\">(2)</script> đạt giá trị bằng 0? Nói cách khác: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msubsup&gt;&lt;mo&gt;=&amp;#x2264;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;&amp;#x21D4;&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-54-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-581\"><span class=\"mjx-mrow\" id=\"MJXc-Node-582\"><span class=\"mjx-mi\" id=\"MJXc-Node-583\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-584\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-585\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-586\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-592\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-587\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-588\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-589\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-590\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-591\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-593\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-594\"><span class=\"mjx-base\" style=\"margin-right: -0.003em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-595\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em; padding-right: 0.003em;\">z</span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0.076em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-597\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-596\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-598\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.163em;\">=<span class=\"mjx-charbox MJXc-TeX-main-R\" style=\"padding-bottom: 0.314em;\">≤</span></span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-599\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-600\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.377em;\">⇔</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-601\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-602\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.483em;\">≤</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-603\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-604\"><span class=\"mjx-mrow\" id=\"MJXc-Node-605\"><span class=\"mjx-mi\" id=\"MJXc-Node-606\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-612\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-607\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-608\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-609\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-610\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-611\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-613\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-614\"><span class=\"mjx-mrow\" id=\"MJXc-Node-615\"><span class=\"mjx-mi\" id=\"MJXc-Node-616\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-617\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-618\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-619\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-620\"><span class=\"mjx-mrow\" id=\"MJXc-Node-621\"><span class=\"mjx-mi\" id=\"MJXc-Node-622\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-624\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-623\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-625\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-626\"><span class=\"mjx-mrow\" id=\"MJXc-Node-627\"><span class=\"mjx-mi\" id=\"MJXc-Node-628\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-629\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-630\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mi\" id=\"MJXc-Node-631\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">∀</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-632\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-633\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-634\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-635\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-636\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-637\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-638\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-639\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-640\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-641\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-642\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-643\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-644\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-645\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-646\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-647\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-648\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-649\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-650\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-651\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">;</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-652\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-653\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-654\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-655\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-656\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msubsup><mi>z</mi><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>n</mi></msubsup><mo>+</mo><msubsup><mi>z</mi><mi>j</mi><mi>n</mi></msubsup><mo>=≤</mo><mn>0</mn><mo stretchy=\"false\">⇔</mo><mi mathvariant=\"normal\">Δ</mi><mo>≤</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mtext> </mtext><mi mathvariant=\"normal\">∀</mi><mi>n</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi><mo>;</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>C</mi><mo>;</mo><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></math></span></span></span><script id=\"MathJax-Element-54\" type=\"math/tex; mode=display\">\n \\Delta - z_{y_n}^n + z_j^n =  \\leq 0 \\Leftrightarrow \\Delta \\leq \\mathbf{w}_{y_n}^T \\mathbf{x}_n - \\mathbf{w}_j^T\\mathbf{x}_n~\\forall n = 1, 2, \\dots, N; j = 1, 2, \\dots, C; j \\neq y_n\n</script></p><p>Điều này có nghĩa là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-55-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-657\"><span class=\"mjx-mrow\" id=\"MJXc-Node-658\"><span class=\"mjx-mi\" id=\"MJXc-Node-659\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-660\"><span class=\"mjx-mrow\" id=\"MJXc-Node-661\"><span class=\"mjx-mi\" id=\"MJXc-Node-662\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-55\" type=\"math/tex\">k\\mathbf{W}</script> cũng là một nghiệm của bài toán với <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-56-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-663\"><span class=\"mjx-mrow\" id=\"MJXc-Node-664\"><span class=\"mjx-mi\" id=\"MJXc-Node-665\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">k</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-666\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">&gt;</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-667\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>k</mi><mo>&gt;</mo><mn>1</mn></math></span></span><script id=\"MathJax-Element-56\" type=\"math/tex\">k > 1</script> bất kỳ. Việc bài toán có vô số nghiệm và có những nghiệm có những phần tử tiến tới vô cùng khiến cho bài toán rất <em>unstable</em> khi giải. Một phương pháp quen thuộc để tránh hiện tượng này là cộng thêm số hạng <a href=\"https://machinelearningcoban.com/2017/03/04/overfitting/#-regularization\"><em>regularization</em></a> vào hàm mất mát. Số hạng này giúp <em>ngăn chặn</em> việc các hệ số của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-57-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-668\"><span class=\"mjx-mrow\" id=\"MJXc-Node-669\"><span class=\"mjx-texatom\" id=\"MJXc-Node-670\"><span class=\"mjx-mrow\" id=\"MJXc-Node-671\"><span class=\"mjx-mi\" id=\"MJXc-Node-672\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-57\" type=\"math/tex\">\\mathbf{W}</script> trở nên quá lớn. Và để cho hàm mất mát vẫn có đạo hàm đơn giản, chúng ta lại sử dụng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-58-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-673\"><span class=\"mjx-mrow\" id=\"MJXc-Node-674\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-675\"><span class=\"mjx-base\"><span class=\"mjx-mi\" id=\"MJXc-Node-676\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">l</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-677\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>l</mi><mn>2</mn></msub></math></span></span><script id=\"MathJax-Element-58\" type=\"math/tex\">l_2</script> regularization:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mtext&gt;data loss&amp;#xA0;&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"&gt;&lt;munder&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DF;&lt;/mo&gt;&lt;/munder&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mtext&gt;regularization loss&lt;/mtext&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-59-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-678\"><span class=\"mjx-mrow\" id=\"MJXc-Node-679\"><span class=\"mjx-texatom\" id=\"MJXc-Node-680\"><span class=\"mjx-mrow\" id=\"MJXc-Node-681\"><span class=\"mjx-mi\" id=\"MJXc-Node-682\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-683\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-684\"><span class=\"mjx-mrow\" id=\"MJXc-Node-685\"><span class=\"mjx-mi\" id=\"MJXc-Node-686\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-687\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-688\"><span class=\"mjx-mrow\" id=\"MJXc-Node-689\"><span class=\"mjx-mi\" id=\"MJXc-Node-690\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-691\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-692\"><span class=\"mjx-mrow\" id=\"MJXc-Node-693\"><span class=\"mjx-mi\" id=\"MJXc-Node-694\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-695\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-696\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-munderover MJXc-space3\" id=\"MJXc-Node-697\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\"><span class=\"mjx-texatom\" id=\"MJXc-Node-698\"><span class=\"mjx-mrow\" id=\"MJXc-Node-699\"><span class=\"mjx-munderover\" id=\"MJXc-Node-700\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\"><span class=\"mjx-mrow\" id=\"MJXc-Node-701\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-702\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 1.088em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 1.088em; top: -1.368em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-703\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span><span class=\"mjx-denominator\" style=\"width: 1.088em; bottom: -0.711em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-704\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 1.088em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.078em; vertical-align: -0.711em;\"></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-705\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-712\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-706\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.082em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-707\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-708\"><span class=\"mjx-mi\" id=\"MJXc-Node-709\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-710\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-711\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-713\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.034em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-714\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-715\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-716\"><span class=\"mjx-mi\" id=\"MJXc-Node-717\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-718\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-719\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-720\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-721\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-722\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-723\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-724\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-725\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi MJXc-space1\" id=\"MJXc-Node-726\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-727\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-728\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-729\"><span class=\"mjx-mrow\" id=\"MJXc-Node-730\"><span class=\"mjx-mi\" id=\"MJXc-Node-731\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-737\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-732\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-733\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-734\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-735\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-736\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-738\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-739\"><span class=\"mjx-mrow\" id=\"MJXc-Node-740\"><span class=\"mjx-mi\" id=\"MJXc-Node-741\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-742\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-743\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-744\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-745\"><span class=\"mjx-mrow\" id=\"MJXc-Node-746\"><span class=\"mjx-mi\" id=\"MJXc-Node-747\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-749\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-748\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-750\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-751\"><span class=\"mjx-mrow\" id=\"MJXc-Node-752\"><span class=\"mjx-mi\" id=\"MJXc-Node-753\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-754\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-755\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"padding-top: 0.12em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-756\"><span class=\"mjx-delim-h\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.01em 0px 0.024em;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.088em 0px -0.068em; letter-spacing: -0.086em;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"margin-top: 0px; padding-bottom: 0.488em; margin-right: 0.01em; padding-top: 0.108em; margin-bottom: 0px;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.088em 0px -0.068em; letter-spacing: -0.086em;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin-right: 0.024em; margin-bottom: 0px; margin-top: 0px;\"></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 9.555em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-757\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-758\"><span class=\"mjx-mtext\" id=\"MJXc-Node-759\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">data loss </span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-760\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-munderover MJXc-space2\" id=\"MJXc-Node-761\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.821em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-762\"><span class=\"mjx-mrow\" id=\"MJXc-Node-763\"><span class=\"mjx-munderover\" id=\"MJXc-Node-764\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\"><span class=\"mjx-mrow\" id=\"MJXc-Node-765\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-766\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 0.783em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 0.783em; top: -1.396em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-767\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">λ</span></span></span><span class=\"mjx-denominator\" style=\"width: 0.783em; bottom: -0.711em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-768\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 0.783em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.106em; vertical-align: -0.711em;\"></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-769\"><span class=\"mjx-mrow\" id=\"MJXc-Node-770\"><span class=\"mjx-mo\" id=\"MJXc-Node-771\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-772\"><span class=\"mjx-mrow\" id=\"MJXc-Node-773\"><span class=\"mjx-mo\" id=\"MJXc-Node-774\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-775\"><span class=\"mjx-mrow\" id=\"MJXc-Node-776\"><span class=\"mjx-mi\" id=\"MJXc-Node-777\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-778\"><span class=\"mjx-mrow\" id=\"MJXc-Node-779\"><span class=\"mjx-mo\" id=\"MJXc-Node-780\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-781\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-782\"><span class=\"mjx-mrow\" id=\"MJXc-Node-783\"><span class=\"mjx-mo\" id=\"MJXc-Node-784\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.309em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.417em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-786\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-785\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.106em;\">F</span></span></span></span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"padding-top: 0.12em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-787\"><span class=\"mjx-delim-h\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.01em 0px 0.024em;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.12em 0px -0.1em; letter-spacing: -0.15em;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"margin-top: 0px; padding-bottom: 0.488em; margin-right: 0.01em; padding-top: 0.108em; margin-bottom: 0px;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin: 0px 0.12em 0px -0.1em; letter-spacing: -0.15em;\"></span><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 0.108em; padding-bottom: 0.488em; margin-right: 0.024em; margin-bottom: 0px; margin-top: 0px;\"></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-788\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-789\"><span class=\"mjx-mtext\" id=\"MJXc-Node-790\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">regularization loss</span></span></span></span></span></span></span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-791\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-792\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-793\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-794\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-795\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-796\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-797\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-798\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mi mathvariant=\"normal\">Δ</mi><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>data loss </mtext></mrow></munder><mo>+</mo><munder><mrow class=\"MJX-TeXAtom-OP MJX-fixedlimits\"><munder><mrow><mfrac><mi>λ</mi><mn>2</mn></mfrac><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>F</mi><mn>2</mn></msubsup></mrow><mo>⏟</mo></munder></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mtext>regularization loss</mtext></mrow></munder><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-59\" type=\"math/tex; mode=display\">\n\\mathcal{L}(\\mathbf{X}, \\mathbf{y}, \\mathbf{W}) = \\underbrace{\\frac{1}{N}\\sum_{n=1}^N \\sum_{j \\neq y_n} \\max(0, \\Delta - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n)}_{\\text{data loss }} + \\underbrace{\\frac{\\lambda}{2} ||\\mathbf{W}||_F^2}_{\\text{regularization loss}}~~~~~ (3)\n</script>\nvới <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-60-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-799\"><span class=\"mjx-mrow\" id=\"MJXc-Node-800\"><span class=\"mjx-texatom\" id=\"MJXc-Node-801\"><span class=\"mjx-mrow\" id=\"MJXc-Node-802\"><span class=\"mjx-mo\" id=\"MJXc-Node-803\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-804\"><span class=\"mjx-mrow\" id=\"MJXc-Node-805\"><span class=\"mjx-mo\" id=\"MJXc-Node-806\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-807\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.323em;\">∙</span></span><span class=\"mjx-texatom MJXc-space2\" id=\"MJXc-Node-808\"><span class=\"mjx-mrow\" id=\"MJXc-Node-809\"><span class=\"mjx-mo\" id=\"MJXc-Node-810\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-811\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-812\"><span class=\"mjx-mrow\" id=\"MJXc-Node-813\"><span class=\"mjx-mo\" id=\"MJXc-Node-814\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.437em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-815\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.106em;\">F</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mo>∙</mo><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msub><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>F</mi></msub></math></span></span><script id=\"MathJax-Element-60\" type=\"math/tex\">||\\bullet||_F</script> là <a href=\"https://machinelearningcoban.com/math/#chuan-cua-ma-tran\">Frobenius norm</a>, và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-61-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-816\"><span class=\"mjx-mrow\" id=\"MJXc-Node-817\"><span class=\"mjx-mi\" id=\"MJXc-Node-818\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">λ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script id=\"MathJax-Element-61\" type=\"math/tex\">\\lambda</script> là một giá trị dương giúp cân bằng giữa <em>data loss</em> và <em>regularization loss</em>, thường được chọn bằng <a href=\"https://machinelearningcoban.com/2017/03/04/overfitting/#-cross-validation\">cross-validation</a>.</p><p><a name=\"-chon-gia-tri-\\\\\\delta\\\\\"></a></p><h3 id=\"25-chọn-giá-trị-delta\">2.5. Chọn giá trị <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-62-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-819\"><span class=\"mjx-mrow\" id=\"MJXc-Node-820\"><span class=\"mjx-mi\" id=\"MJXc-Node-821\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.444em; padding-bottom: 0.333em;\">Δ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi></math></span></span><script id=\"MathJax-Element-62\" type=\"math/tex\">\\Delta</script></h3><p>Có hai <em>hyperparameter</em> trong hàm mất mát <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-63-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-822\"><span class=\"mjx-mrow\" id=\"MJXc-Node-823\"><span class=\"mjx-mo\" id=\"MJXc-Node-824\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-825\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-826\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-63\" type=\"math/tex\">(3)</script> là <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-64-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-827\"><span class=\"mjx-mrow\" id=\"MJXc-Node-828\"><span class=\"mjx-mi\" id=\"MJXc-Node-829\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi></math></span></span><script id=\"MathJax-Element-64\" type=\"math/tex\">\\Delta</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-65-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-830\"><span class=\"mjx-mrow\" id=\"MJXc-Node-831\"><span class=\"mjx-mi\" id=\"MJXc-Node-832\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">λ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script id=\"MathJax-Element-65\" type=\"math/tex\">\\lambda</script>, câu hỏi đặt ra là làm thế nào để chọn ra cặp giá trị hợp lý nhất cho từng bài toán. Liệu chúng ta có cần làm <a href=\"https://machinelearningcoban.com/2017/03/04/overfitting/#-cross-validation\">cross-validation</a> cho từng giá trị không?</p><p>Trong thực tế, người ta nhận thấy rằng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-66-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-833\"><span class=\"mjx-mrow\" id=\"MJXc-Node-834\"><span class=\"mjx-mi\" id=\"MJXc-Node-835\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi></math></span></span><script id=\"MathJax-Element-66\" type=\"math/tex\">\\Delta</script> có thể được chọn bằng 1 mà không ảnh hưởng nhiều tới chất lượng của nghiệm. Thực tế cho thấy cả hai tham số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-67-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-836\"><span class=\"mjx-mrow\" id=\"MJXc-Node-837\"><span class=\"mjx-mi\" id=\"MJXc-Node-838\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi></math></span></span><script id=\"MathJax-Element-67\" type=\"math/tex\">\\Delta</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-68-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-839\"><span class=\"mjx-mrow\" id=\"MJXc-Node-840\"><span class=\"mjx-mi\" id=\"MJXc-Node-841\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">λ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script id=\"MathJax-Element-68\" type=\"math/tex\">\\lambda</script> đều giúp cân bằng giữa <em>data loss</em> và <em>regularization loss</em>. Thực vậy, độ lớn của các hệ số trong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-69-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-842\"><span class=\"mjx-mrow\" id=\"MJXc-Node-843\"><span class=\"mjx-texatom\" id=\"MJXc-Node-844\"><span class=\"mjx-mrow\" id=\"MJXc-Node-845\"><span class=\"mjx-mi\" id=\"MJXc-Node-846\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-69\" type=\"math/tex\">\\mathbf{W}</script> có tác động trực tiếp lên các <em>score vectors</em>, và vì vậy ảnh hưởng tới sự khác nhau giữa chúng. Khi chúng ta giảm các hệ số của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-70-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-847\"><span class=\"mjx-mrow\" id=\"MJXc-Node-848\"><span class=\"mjx-texatom\" id=\"MJXc-Node-849\"><span class=\"mjx-mrow\" id=\"MJXc-Node-850\"><span class=\"mjx-mi\" id=\"MJXc-Node-851\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-70\" type=\"math/tex\">\\mathbf{W}</script>, sự khác nhau giữa các scores cũng giảm một tỉ lệ tương tự; và khi ta tăng các hệ số của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-71-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-852\"><span class=\"mjx-mrow\" id=\"MJXc-Node-853\"><span class=\"mjx-texatom\" id=\"MJXc-Node-854\"><span class=\"mjx-mrow\" id=\"MJXc-Node-855\"><span class=\"mjx-mi\" id=\"MJXc-Node-856\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-71\" type=\"math/tex\">\\mathbf{W}</script>, sự khác nhau giữa các scores cũng tăng lên. Bởi vậy, giá trị chính xác <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x0394;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-72-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-857\"><span class=\"mjx-mrow\" id=\"MJXc-Node-858\"><span class=\"mjx-mi\" id=\"MJXc-Node-859\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">Δ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi mathvariant=\"normal\">Δ</mi></math></span></span><script id=\"MathJax-Element-72\" type=\"math/tex\">\\Delta</script> của <em>margin</em> giữa các scores trở nên không quan trọng vì chúng ta có thể tăng hoặc giảm <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-73-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-860\"><span class=\"mjx-mrow\" id=\"MJXc-Node-861\"><span class=\"mjx-texatom\" id=\"MJXc-Node-862\"><span class=\"mjx-mrow\" id=\"MJXc-Node-863\"><span class=\"mjx-mi\" id=\"MJXc-Node-864\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-73\" type=\"math/tex\">\\mathbf{W}</script> một cách tùy ý. Việc quan trọng hơn là hạn chế việc <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-74-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-865\"><span class=\"mjx-mrow\" id=\"MJXc-Node-866\"><span class=\"mjx-texatom\" id=\"MJXc-Node-867\"><span class=\"mjx-mrow\" id=\"MJXc-Node-868\"><span class=\"mjx-mi\" id=\"MJXc-Node-869\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-74\" type=\"math/tex\">\\mathbf{W}</script> trở nên quá lớn. Việc này đã được điều chỉnh bởi tham số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;/math&gt;' id=\"MathJax-Element-75-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-870\"><span class=\"mjx-mrow\" id=\"MJXc-Node-871\"><span class=\"mjx-mi\" id=\"MJXc-Node-872\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">λ</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>λ</mi></math></span></span><script id=\"MathJax-Element-75\" type=\"math/tex\">\\lambda</script>.</p><p>Cuối cùng, chúng ta sẽ đi tối ưu hàm mất mát sau đây cho Multi-class SVM:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo stretchy=\"false\"&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;F&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-76-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-873\"><span class=\"mjx-mrow\" id=\"MJXc-Node-874\"><span class=\"mjx-texatom\" id=\"MJXc-Node-875\"><span class=\"mjx-mrow\" id=\"MJXc-Node-876\"><span class=\"mjx-mi\" id=\"MJXc-Node-877\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-878\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-879\"><span class=\"mjx-mrow\" id=\"MJXc-Node-880\"><span class=\"mjx-mi\" id=\"MJXc-Node-881\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-882\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-883\"><span class=\"mjx-mrow\" id=\"MJXc-Node-884\"><span class=\"mjx-mi\" id=\"MJXc-Node-885\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.59em;\">y</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-886\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-texatom MJXc-space1\" id=\"MJXc-Node-887\"><span class=\"mjx-mrow\" id=\"MJXc-Node-888\"><span class=\"mjx-mi\" id=\"MJXc-Node-889\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-890\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-891\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mfrac MJXc-space3\" id=\"MJXc-Node-892\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 1.088em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 1.088em; top: -1.368em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-893\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span><span class=\"mjx-denominator\" style=\"width: 1.088em; bottom: -0.711em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-894\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 1.088em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.078em; vertical-align: -0.711em;\"></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-895\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"font-size: 70.7%; padding-bottom: 0.258em; padding-top: 0.141em; padding-left: 0.577em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-902\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mo\" id=\"MJXc-Node-896\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em; padding-left: 0.082em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-897\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-898\"><span class=\"mjx-mi\" id=\"MJXc-Node-899\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-900\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-901\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-903\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.034em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-904\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-905\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-906\"><span class=\"mjx-mi\" id=\"MJXc-Node-907\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-908\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-909\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-910\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-911\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-912\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-913\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-914\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-915\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-916\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-917\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-918\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-919\"><span class=\"mjx-mrow\" id=\"MJXc-Node-920\"><span class=\"mjx-mi\" id=\"MJXc-Node-921\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-927\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-922\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-923\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-924\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-925\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-926\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-928\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-929\"><span class=\"mjx-mrow\" id=\"MJXc-Node-930\"><span class=\"mjx-mi\" id=\"MJXc-Node-931\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-932\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-933\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-934\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-935\"><span class=\"mjx-mrow\" id=\"MJXc-Node-936\"><span class=\"mjx-mi\" id=\"MJXc-Node-937\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-939\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-938\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-940\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-941\"><span class=\"mjx-mrow\" id=\"MJXc-Node-942\"><span class=\"mjx-mi\" id=\"MJXc-Node-943\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-944\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-945\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-946\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-mfrac MJXc-space2\" id=\"MJXc-Node-947\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 0.783em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 0.783em; top: -1.396em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-948\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em;\">λ</span></span></span><span class=\"mjx-denominator\" style=\"width: 0.783em; bottom: -0.711em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-949\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 0.783em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.106em; vertical-align: -0.711em;\"></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-950\"><span class=\"mjx-mrow\" id=\"MJXc-Node-951\"><span class=\"mjx-mo\" id=\"MJXc-Node-952\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-953\"><span class=\"mjx-mrow\" id=\"MJXc-Node-954\"><span class=\"mjx-mo\" id=\"MJXc-Node-955\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-956\"><span class=\"mjx-mrow\" id=\"MJXc-Node-957\"><span class=\"mjx-mi\" id=\"MJXc-Node-958\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-959\"><span class=\"mjx-mrow\" id=\"MJXc-Node-960\"><span class=\"mjx-mo\" id=\"MJXc-Node-961\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-962\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-963\"><span class=\"mjx-mrow\" id=\"MJXc-Node-964\"><span class=\"mjx-mo\" id=\"MJXc-Node-965\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">|</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.309em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.417em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-967\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-966\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.106em;\">F</span></span></span></span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-968\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-969\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-970\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-971\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-972\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-973\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-974\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">4</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-975\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">y</mi></mrow><mo>,</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mfrac><mi>λ</mi><mn>2</mn></mfrac><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mo stretchy=\"false\">|</mo></mrow><mi>F</mi><mn>2</mn></msubsup><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-76\" type=\"math/tex; mode=display\">\n\\mathcal{L}(\\mathbf{X}, \\mathbf{y}, \\mathbf{W}) = \\frac{1}{N}\\sum_{n=1}^N \\sum_{j \\neq y_n} \\max(0, 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n) + \\frac{\\lambda}{2} ||\\mathbf{W}||_F^2~~~~~ (4)\n</script></p><p>Một lần nữa, chúng ta có thể dùng <a href=\"https://machinelearningcoban.com/2017/01/12/gradientdescent/\">Gradient Descent</a> để tối ưu bài toán tối ưu không ràng buộc này. Chúng ta sẽ đi sâu vào việc tính đạo hàm của hàm mất mát <em>một cách hiệu quả</em> ở mục 3.</p><p>Trước hết, có một nhận xét thú vị:</p><p><a name=\"-soft-margin-svm-la-mot-truong-hop-dac-biet-cua-multi-class-svm\"></a></p><h3 id=\"26-soft-margin-svm-là-một-trường-hợp-đặc-biệt-của-multi-class-svm\">2.6. Soft Margin SVM là một trường hợp đặc biệt của Multi-class SVM</h3><p>Phát biểu này có vẻ hiển nhiên vì bài toán phân lớp với hai classes là một trường hợp đặc biệt của bài toán phân lớp với nhiều classes! Nhưng điều tôi muốn nói đến là cách xây dựng hàm mất mát. Điều này có thể được nhận ra bằng cách xét từng điểm dữ liệu.</p><p>Trong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-77-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-976\"><span class=\"mjx-mrow\" id=\"MJXc-Node-977\"><span class=\"mjx-mo\" id=\"MJXc-Node-978\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-979\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">4</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-980\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-77\" type=\"math/tex\">(4)</script>, nếu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-78-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-981\"><span class=\"mjx-mrow\" id=\"MJXc-Node-982\"><span class=\"mjx-mi\" id=\"MJXc-Node-983\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-984\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-985\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mi>C</mi><mo>=</mo><mn>2</mn></math></span></span><script id=\"MathJax-Element-78\" type=\"math/tex\">C = 2</script> (số classes bằng 2), hàm mất mát tại mỗi điểm dữ liệu trở thành (tạm bỏ qua <em>regularization loss</em>):\n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-79-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-986\"><span class=\"mjx-mrow\" id=\"MJXc-Node-987\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-988\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-989\"><span class=\"mjx-mrow\" id=\"MJXc-Node-990\"><span class=\"mjx-mi\" id=\"MJXc-Node-991\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-992\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-993\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-munderover MJXc-space3\" id=\"MJXc-Node-994\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.034em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-995\"><span class=\"mjx-char MJXc-TeX-size2-R\" style=\"padding-top: 0.751em; padding-bottom: 0.751em;\">∑</span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-996\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-997\"><span class=\"mjx-mi\" id=\"MJXc-Node-998\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-999\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1000\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1001\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1002\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1003\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1004\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1005\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1006\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1007\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1008\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1009\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1010\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1011\"><span class=\"mjx-mi\" id=\"MJXc-Node-1012\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1018\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1013\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1014\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1015\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1016\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1017\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1019\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1020\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1021\"><span class=\"mjx-mi\" id=\"MJXc-Node-1022\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1023\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1024\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1025\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1026\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1027\"><span class=\"mjx-mi\" id=\"MJXc-Node-1028\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1030\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1029\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1031\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1032\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1033\"><span class=\"mjx-mi\" id=\"MJXc-Node-1034\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1035\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1036\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>n</mi></msub><mo>=</mo><munder><mo>∑</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-79\" type=\"math/tex; mode=display\">\n\\mathcal{L}_n = \\sum_{j \\neq y_n} \\max(0, 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n)\n</script>\nXét hai trường hợp:</p><ul>\n<li>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;&amp;#x21D2;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-80-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1037\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1038\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1039\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1040\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1041\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1042\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1043\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1044\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.377em;\">⇒</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1045\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1046\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1047\"><span class=\"mjx-mi\" id=\"MJXc-Node-1048\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1049\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1050\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1051\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1052\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1053\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1054\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1055\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1056\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1057\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1058\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1059\"><span class=\"mjx-mi\" id=\"MJXc-Node-1060\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1062\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1061\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1063\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1064\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1065\"><span class=\"mjx-mi\" id=\"MJXc-Node-1066\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1067\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1068\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1069\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1070\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1071\"><span class=\"mjx-mi\" id=\"MJXc-Node-1072\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1074\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1073\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1075\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1076\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1077\"><span class=\"mjx-mi\" id=\"MJXc-Node-1078\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1079\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1080\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1081\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1082\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1083\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1084\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1085\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1086\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1087\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1088\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1089\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1090\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1091\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1092\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1093\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1094\"><span class=\"mjx-mi\" id=\"MJXc-Node-1095\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1096\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1097\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1098\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1099\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1100\"><span class=\"mjx-mi\" id=\"MJXc-Node-1101\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1102\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1103\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1104\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1105\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1106\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1107\"><span class=\"mjx-mi\" id=\"MJXc-Node-1108\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1109\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>1</mn><mo stretchy=\"false\">⇒</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>n</mi></msub><mo>=</mo><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-80\" type=\"math/tex\">y_n = 1 \\Rightarrow \\mathcal{L}_n = \\max(0, 1 - \\mathbf{w}_1^T\\mathbf{x}_n + \\mathbf{w}_2^T\\mathbf{x}_n) = \\max(0, 1 - (1)(\\mathbf{w}_1 - \\mathbf{w}_2)^T\\mathbf{x})</script></p>\n</li>\n<li>\n<p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;&amp;#x21D2;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-81-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1110\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1111\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1112\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1113\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1114\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1115\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1116\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1117\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.377em;\">⇒</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1118\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1119\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1120\"><span class=\"mjx-mi\" id=\"MJXc-Node-1121\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1122\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1123\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1124\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1125\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1126\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1127\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1128\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1129\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1130\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1131\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1132\"><span class=\"mjx-mi\" id=\"MJXc-Node-1133\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1135\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1134\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1136\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1137\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1138\"><span class=\"mjx-mi\" id=\"MJXc-Node-1139\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1140\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1141\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1142\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1143\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1144\"><span class=\"mjx-mi\" id=\"MJXc-Node-1145\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.315em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1147\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1146\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1148\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1149\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1150\"><span class=\"mjx-mi\" id=\"MJXc-Node-1151\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1152\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1153\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1154\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1155\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1156\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1157\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1158\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1159\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1160\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1161\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1162\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1163\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1164\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1165\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1166\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1167\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1168\"><span class=\"mjx-mi\" id=\"MJXc-Node-1169\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1170\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1171\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1172\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1173\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1174\"><span class=\"mjx-mi\" id=\"MJXc-Node-1175\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1176\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1177\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1178\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1179\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1180\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1181\"><span class=\"mjx-mi\" id=\"MJXc-Node-1182\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1183\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mn>2</mn><mo stretchy=\"false\">⇒</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>n</mi></msub><mo>=</mo><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-81\" type=\"math/tex\">y_n = 2 \\Rightarrow \\mathcal{L}_n = \\max(0, 1 - \\mathbf{w}_2^T\\mathbf{x}_n + \\mathbf{w}_1^T\\mathbf{x}_n) = \\max(0, 1 - (-1)(\\mathbf{w}_1 - \\mathbf{w}_2)^T\\mathbf{x})</script></p>\n</li>\n</ul><p>Nếu ta thay <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-82-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1184\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1185\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1186\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1187\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1188\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1189\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1190\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1191\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mi>y</mi><mi>n</mi></msub><mo>=</mo><mo>−</mo><mn>1</mn></math></span></span><script id=\"MathJax-Element-82\" type=\"math/tex\">y_n = -1</script> cho dữ liệu thuộc class 2, và đặt <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mover&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;mo mathvariant=\"bold\" stretchy=\"false\"&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-83-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1192\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1193\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1194\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1195\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1196\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1197\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1198\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"height: 0.117em; padding-bottom: 0.06em; padding-left: 0.128em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-1200\" style=\"vertical-align: top;\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.27em; padding-bottom: 0.323em;\">¯</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mi\" id=\"MJXc-Node-1199\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span></span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1201\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1202\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1203\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1204\"><span class=\"mjx-mi\" id=\"MJXc-Node-1205\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1206\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1207\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1208\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1209\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1210\"><span class=\"mjx-mi\" id=\"MJXc-Node-1211\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1212\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi mathvariant=\"bold\">w</mi><mo mathvariant=\"bold\" stretchy=\"false\">¯</mo></mover></mrow></mrow><mo>=</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub></math></span></span><script id=\"MathJax-Element-83\" type=\"math/tex\">\\mathbf{\\bar{w}} = \\mathbf{w}_1 - \\mathbf{w}_2</script>, hai trường hợp trên có thể được viết gọn thành: \n<span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\"&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mover&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;mo mathvariant=\"bold\" stretchy=\"false\"&gt;&amp;#x00AF;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-84-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1213\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1214\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1215\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1216\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1217\"><span class=\"mjx-mi\" id=\"MJXc-Node-1218\"><span class=\"mjx-char MJXc-TeX-cal-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">L</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1219\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1220\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1221\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1222\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1223\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1224\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1225\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1226\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1227\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1228\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1229\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1230\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1231\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1232\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1233\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1234\"><span class=\"mjx-munderover\" id=\"MJXc-Node-1235\"><span class=\"mjx-stack\"><span class=\"mjx-over\" style=\"height: 0.117em; padding-bottom: 0.06em; padding-left: 0.128em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-1237\" style=\"vertical-align: top;\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.27em; padding-bottom: 0.323em;\">¯</span></span></span><span class=\"mjx-op\"><span class=\"mjx-mi\" id=\"MJXc-Node-1236\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.584em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1238\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1239\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1240\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1241\"><span class=\"mjx-mi\" id=\"MJXc-Node-1242\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1243\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1244\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi class=\"MJX-tex-caligraphic\" mathvariant=\"script\">L</mi></mrow><mi>n</mi></msub><mo>=</mo><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msub><mi>y</mi><mi>n</mi></msub><msup><mrow class=\"MJX-TeXAtom-ORD\"><mrow class=\"MJX-TeXAtom-ORD\"><mover><mi mathvariant=\"bold\">w</mi><mo mathvariant=\"bold\" stretchy=\"false\">¯</mo></mover></mrow></mrow><mi>T</mi></msup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></math></span></span></span><script id=\"MathJax-Element-84\" type=\"math/tex; mode=display\">\n\\mathcal{L}_n = \\max(0, 1 - y_n\\mathbf{\\bar{w}}^T\\mathbf{x}_n)\n</script>\ntức chính là Hinge loss cho Soft Margin SVM.</p><p><a name=\"-tinh-toan-ham-mat-mat-va-dao-ham-cua-no\"></a></p><p>Để tối ưu hàm mất mát, chúng ta sử dụng phương pháp Stochastic Gradient Method. Điều này có nghĩa là chúng ta cần tính gradient tại mỗi vòng lặp. Đồng thời, <em>loss</em> sau mỗi vòng lặp cũng cần được tính để kiểm tra liệu thuật toán có hoạt động như ý muốn hay không.</p><p>Việc tính toán <em>loss</em> và <em>gradient</em> này không những cần phải chính xác mà còn cần được thực hiện càng nhanh càng tốt. Trong khi việc tính <em>loss</em> thường dễ thực hiện, việc tính <em>gradient</em> cần phải được kiểm tra kỹ càng hơn.</p><p>Để đảm bảo rằng <em>loss</em> và <em>gradient</em> được tính một cách chính xác và nhanh, chúng ta sẽ làm từng bước một. Bước thứ nhất là đảm bảo rằng các tính toán là chính xác, dù cách tính có rất chậm. Bước thứ hai là phải đảm bảo có cách tính hiệu quả để thuật toán chạy nhanh hơn. Hai bước này cần được thực hiện trên một lượng dữ liệu nhỏ để đảm bảo chúng được tính chính xác trước khi áp dụng thuật toán vào dữ liệu thật, thường có số điểm dữ liệu lớn và mỗi điểm dữ liệu cũng có số chiều lớn.</p><p>Hai mục nhỏ tiếp theo sẽ mô tả hai bước đã nêu ở trên.</p><p><a name=\"-tinh-ham-mat-mat-va-dao-ham-cua-no-bang-cach-naive\"></a></p><h3 id=\"31-tính-hàm-mất-mát-và-đạo-hàm-của-nó-bằng-cách-naive\">3.1. Tính hàm mất mát và đạo hàm của nó bằng cách <em>naive</em></h3><p><em>Naive</em> dịch tạm ra tiếng Việt có nghĩa là <em>ngây thơ</em>, hoặc <em>ngây ngô</em>. Trong Machine Learning, từ này cũng hay được sử dụng với ý chỉ sự đơn giản.</p><p>Dưới đây là cách tính đơn giản <em>loss</em> và <em>gradient</em> của hàm mất mát trong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-85-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1245\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1246\"><span class=\"mjx-mo\" id=\"MJXc-Node-1247\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1248\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">4</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1249\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-85\" type=\"math/tex\">(4)</script>. Chú ý thành phần <em>regularization</em>.</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"n\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">random</span> <span class=\"kn\">import</span> <span class=\"n\">shuffle</span>\n\n<span class=\"c1\"># naive way to calculate loss and grad\n</span><span class=\"k\">def</span> <span class=\"nf\">svm_loss_naive</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">):</span>\n    <span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span> \n    <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span> \n    \n    <span class=\"c1\">## naive loss and grad\n</span>    <span class=\"n\">loss</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> \n    <span class=\"n\">dW</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">)</span>\n    <span class=\"k\">for</span> <span class=\"n\">n</span> <span class=\"ow\">in</span> <span class=\"nb\">xrange</span><span class=\"p\">(</span><span class=\"n\">N</span><span class=\"p\">):</span>\n        <span class=\"n\">xn</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[:,</span> <span class=\"n\">n</span><span class=\"p\">]</span>\n        <span class=\"n\">score</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">xn</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">j</span> <span class=\"ow\">in</span> <span class=\"nb\">xrange</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">):</span>\n            <span class=\"k\">if</span> <span class=\"n\">j</span> <span class=\"o\">==</span> <span class=\"n\">y</span><span class=\"p\">[</span><span class=\"n\">n</span><span class=\"p\">]:</span>\n                <span class=\"k\">continue</span> \n            <span class=\"n\">margin</span> <span class=\"o\">=</span> <span class=\"mi\">1</span> <span class=\"o\">-</span> <span class=\"n\">score</span><span class=\"p\">[</span><span class=\"n\">y</span><span class=\"p\">[</span><span class=\"n\">n</span><span class=\"p\">]]</span> <span class=\"o\">+</span> <span class=\"n\">score</span><span class=\"p\">[</span><span class=\"n\">j</span><span class=\"p\">]</span>\n            <span class=\"k\">if</span> <span class=\"n\">margin</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n                <span class=\"n\">loss</span> <span class=\"o\">+=</span> <span class=\"n\">margin</span> \n                <span class=\"n\">dW</span><span class=\"p\">[:,</span> <span class=\"n\">j</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"n\">xn</span> \n                <span class=\"n\">dW</span><span class=\"p\">[:,</span> <span class=\"n\">y</span><span class=\"p\">[</span><span class=\"n\">n</span><span class=\"p\">]]</span> <span class=\"o\">-=</span> <span class=\"n\">xn</span>\n    \n    <span class=\"n\">loss</span> <span class=\"o\">/=</span> <span class=\"n\">N</span> \n    <span class=\"n\">loss</span> <span class=\"o\">+=</span> <span class=\"mf\">0.5</span><span class=\"o\">*</span><span class=\"n\">reg</span><span class=\"o\">*</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">W</span> <span class=\"o\">*</span> <span class=\"n\">W</span><span class=\"p\">)</span> <span class=\"c1\"># regularization\n</span>    \n    <span class=\"n\">dW</span> <span class=\"o\">/=</span> <span class=\"n\">N</span> \n    <span class=\"n\">dW</span> <span class=\"o\">+=</span> <span class=\"n\">reg</span><span class=\"o\">*</span><span class=\"n\">W</span> <span class=\"c1\"># gradient off regularization \n</span>    <span class=\"k\">return</span> <span class=\"n\">loss</span><span class=\"p\">,</span> <span class=\"n\">dW</span>\n    \n<span class=\"c1\"># random, small data\n</span><span class=\"n\">N</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">5</span>\n<span class=\"n\">reg</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">1</span> \n<span class=\"n\">W</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randint</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"n\">size</span> <span class=\"o\">=</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># sanity check\n</span><span class=\"k\">print</span> <span class=\"s\">'loss without regularization:'</span><span class=\"p\">,</span> <span class=\"n\">svm_loss_naive</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"k\">print</span> <span class=\"s\">'loss with regularization:'</span><span class=\"n\">svm_loss_naive</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"p\">.</span><span class=\"mi\">1</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n</code></pre></div></div><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>loss without regularization: 4.68441457903\nloss with regularization: 6.25136675351\n</code></pre></div></div><p>Cách tính với hai vòng for lồng nhau như trên mô tả lại chính xác <em>loss</em> trong <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-86-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1250\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1251\"><span class=\"mjx-mo\" id=\"MJXc-Node-1252\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1253\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">4</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1254\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>4</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-86\" type=\"math/tex\">(4)</script> nên sai sót, nếu có, ở đây có thể được kiểm tra và sửa lại dễ dàng. Việc kiểm tra ở cuối cho cái nhìn ban đầu về hàm mất mát: dương và không có <em>regularization</em> sẽ có <em>loss</em> tổng cộng nhỏ hơn.</p><p>Về cách tính <em>gradient</em> cho phần <em>data loss</em>, mặc dù <a href=\"https://machinelearningcoban.com/2017/03/12/convexity/#-cac-tinh-chat-co-ban\">hàm <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-87-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1255\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1256\"><span class=\"mjx-mo\" id=\"MJXc-Node-1257\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo form=\"prefix\" movablelimits=\"true\">max</mo></math></span></span><script id=\"MathJax-Element-87\" type=\"math/tex\">\\max</script> là <em>convex</em></a> nhưng nó không có đạo hàm tại mọi nơi. Cụ thể:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtable columnalign=\"right center left\" rowspacing=\"3pt\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable rowspacing=\"4pt\" columnspacing=\"1em\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow&gt;&lt;mi mathvariant=\"normal\"&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable rowspacing=\"4pt\" columnspacing=\"1em\"&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd /&gt;&lt;mtd&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mtext&gt;&amp;#xA0;&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;' id=\"MathJax-Element-88-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1258\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1259\"><span class=\"mjx-mtable\" id=\"MJXc-Node-1260\" style=\"vertical-align: -2.982em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-1261\" style=\"height: 3.232em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1262\" style=\"padding: 0px; text-align: right; width: 14.274em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1263\" style=\"margin-top: 0.375em;\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1264\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 2.304em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 2.304em; top: -1.417em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1265\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span></span><span class=\"mjx-denominator\" style=\"width: 2.304em; bottom: -1.03em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1266\"><span class=\"mjx-mi\" id=\"MJXc-Node-1267\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1268\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1269\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1270\"><span class=\"mjx-mi\" id=\"MJXc-Node-1271\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1272\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1273\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1274\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1275\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1276\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 2.304em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.446em; vertical-align: -1.03em;\"></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1277\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1278\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1279\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1280\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1281\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1282\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1283\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1284\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1285\"><span class=\"mjx-mi\" id=\"MJXc-Node-1286\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1292\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1287\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1288\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1289\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1290\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1291\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1293\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1294\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1295\"><span class=\"mjx-mi\" id=\"MJXc-Node-1296\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1297\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1298\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1299\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1300\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1301\"><span class=\"mjx-mi\" id=\"MJXc-Node-1302\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1304\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1303\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1305\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1306\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1307\"><span class=\"mjx-mi\" id=\"MJXc-Node-1308\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1309\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1310\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1311\" style=\"padding: 0px 0.139em 0px 0px; width: 1.056em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1312\" style=\"margin-top: 0.791em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1313\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1314\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1315\" style=\"padding: 0px 0.139em; text-align: left; width: 15.382em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1316\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1317\"><span class=\"mjx-mo\" id=\"MJXc-Node-1318\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">{</span></span><span class=\"mjx-mtable\" id=\"MJXc-Node-1319\" style=\"vertical-align: -1.291em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-1320\" style=\"height: 1.541em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1321\" style=\"padding: 0px 0.5em 0px 0px; width: 1.845em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1322\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1323\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1324\" style=\"padding: 0px 0.5em; width: 0.584em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1325\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1326\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">if</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1327\" style=\"padding: 0px 0px 0px 0.5em; width: 9.814em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1328\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1329\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1330\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1331\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1332\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1333\"><span class=\"mjx-mi\" id=\"MJXc-Node-1334\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1340\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1335\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1336\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1337\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1338\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1339\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1341\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1342\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1343\"><span class=\"mjx-mi\" id=\"MJXc-Node-1344\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1345\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1346\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1347\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1348\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1349\"><span class=\"mjx-mi\" id=\"MJXc-Node-1350\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1352\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1351\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1353\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1354\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1355\"><span class=\"mjx-mi\" id=\"MJXc-Node-1356\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1357\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1358\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">&lt;</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1359\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1360\" style=\"height: 1.541em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1361\" style=\"padding: 0.2em 0.5em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1362\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-1363\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1364\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1365\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1366\"><span class=\"mjx-mi\" id=\"MJXc-Node-1367\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1368\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1369\" style=\"padding: 0.2em 0.5em 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1370\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1371\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">if</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1372\" style=\"padding: 0.2em 0px 0px 0.5em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1373\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1374\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1375\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1376\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1377\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1378\"><span class=\"mjx-mi\" id=\"MJXc-Node-1379\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1385\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1380\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1381\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1382\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1383\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1384\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1386\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1387\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1388\"><span class=\"mjx-mi\" id=\"MJXc-Node-1389\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1390\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1391\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1392\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1393\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1394\"><span class=\"mjx-mi\" id=\"MJXc-Node-1395\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1397\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1396\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1398\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1399\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1400\"><span class=\"mjx-mi\" id=\"MJXc-Node-1401\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1402\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1403\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">&gt;</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1404\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-strut\"></span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1405\" style=\"width: 0.12em;\"></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1406\" style=\"padding: 0px 0.139em; text-align: left; width: 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1407\" style=\"margin-top: 0.791em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1408\" style=\"padding: 0px 0px 0px 0.139em; text-align: left; width: 2.278em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1409\" style=\"margin-top: 0.791em;\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1410\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1411\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1412\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1413\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1414\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1415\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">5</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1416\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1417\" style=\"height: 3.232em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1418\" style=\"padding: 0.15em 0px 0px; text-align: right;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1419\" style=\"margin-top: 0.375em;\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1420\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 1.924em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"width: 1.924em; top: -1.417em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1421\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span></span><span class=\"mjx-denominator\" style=\"width: 1.924em; bottom: -1.029em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1422\"><span class=\"mjx-mi\" id=\"MJXc-Node-1423\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em; padding-right: 0.035em;\">∂</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1424\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1425\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1426\"><span class=\"mjx-mi\" id=\"MJXc-Node-1427\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1428\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1429\"><span class=\"mjx-mi\" id=\"MJXc-Node-1430\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 1.924em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 2.445em; vertical-align: -1.029em;\"></span></span><span class=\"mjx-mo MJXc-space1\" id=\"MJXc-Node-1431\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1432\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1433\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1434\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1435\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1436\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1437\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1438\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1439\"><span class=\"mjx-mi\" id=\"MJXc-Node-1440\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1446\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1441\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1442\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1443\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1444\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1445\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1447\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1448\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1449\"><span class=\"mjx-mi\" id=\"MJXc-Node-1450\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1451\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1452\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1453\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1454\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1455\"><span class=\"mjx-mi\" id=\"MJXc-Node-1456\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1458\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1457\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1459\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1460\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1461\"><span class=\"mjx-mi\" id=\"MJXc-Node-1462\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1463\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1464\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1465\" style=\"padding: 0.15em 0.139em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1466\" style=\"margin-top: 0.791em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1467\"></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1468\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1469\" style=\"padding: 0.15em 0.139em 0px; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1470\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1471\"><span class=\"mjx-mo\" id=\"MJXc-Node-1472\"><span class=\"mjx-char MJXc-TeX-size4-R\" style=\"padding-top: 1.552em; padding-bottom: 1.552em;\">{</span></span><span class=\"mjx-mtable\" id=\"MJXc-Node-1473\" style=\"vertical-align: -1.291em; padding: 0px 0.167em;\"><span class=\"mjx-table\"><span class=\"mjx-mtr\" id=\"MJXc-Node-1474\" style=\"height: 1.541em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1475\" style=\"padding: 0px 0.5em 0px 0px; width: 1.067em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1476\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1477\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1478\" style=\"padding: 0px 0.5em; width: 0.584em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1479\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1480\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">if</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1481\" style=\"padding: 0px 0px 0px 0.5em; width: 9.814em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1482\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1483\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1484\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1485\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1486\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1487\"><span class=\"mjx-mi\" id=\"MJXc-Node-1488\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1494\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1489\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1490\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1491\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1492\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1493\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1495\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1496\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1497\"><span class=\"mjx-mi\" id=\"MJXc-Node-1498\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1499\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1500\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1501\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1502\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1503\"><span class=\"mjx-mi\" id=\"MJXc-Node-1504\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1506\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1505\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1507\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1508\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1509\"><span class=\"mjx-mi\" id=\"MJXc-Node-1510\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1511\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1512\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">&lt;</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1513\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-strut\"></span></span></span></span><span class=\"mjx-mtr\" id=\"MJXc-Node-1514\" style=\"height: 1.541em;\"><span class=\"mjx-mtd\" id=\"MJXc-Node-1515\" style=\"padding: 0.2em 0.5em 0px 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1516\" style=\"margin-top: -0.132em;\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1517\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1518\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1519\"><span class=\"mjx-mi\" id=\"MJXc-Node-1520\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1521\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1522\" style=\"padding: 0.2em 0.5em 0px;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1523\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1524\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.323em;\">if</span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1525\" style=\"padding: 0.2em 0px 0px 0.5em;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1526\" style=\"margin-top: -0.132em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1527\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1528\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1529\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1530\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1531\"><span class=\"mjx-mi\" id=\"MJXc-Node-1532\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1538\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1533\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1534\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1535\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1536\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1537\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1539\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1540\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1541\"><span class=\"mjx-mi\" id=\"MJXc-Node-1542\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1543\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1544\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1545\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1546\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1547\"><span class=\"mjx-mi\" id=\"MJXc-Node-1548\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1550\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1549\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1551\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1552\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1553\"><span class=\"mjx-mi\" id=\"MJXc-Node-1554\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1555\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1556\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.27em; padding-bottom: 0.377em;\">&gt;</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1557\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-strut\"></span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1558\" style=\"width: 0.12em;\"></span></span><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1559\" style=\"padding: 0.15em 0.139em 0px; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1560\" style=\"margin-top: 0.791em;\"><span class=\"mjx-strut\"></span></span></span><span class=\"mjx-mtd\" id=\"MJXc-Node-1561\" style=\"padding: 0.15em 0px 0px 0.139em; text-align: left;\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1562\" style=\"margin-top: 0.791em;\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1563\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1564\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1565\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mtext\" id=\"MJXc-Node-1566\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.264em; padding-bottom: 0.323em;\"> </span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1567\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1568\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">6</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1569\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-strut\"></span></span></span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtable columnalign=\"right center left\" columnspacing=\"0 thickmathspace\" displaystyle=\"true\" rowspacing=\"3pt\"><mtr><mtd><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow></msub></mrow></mfrac><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mrow><mo>{</mo><mtable columnspacing=\"1em\" rowspacing=\"4pt\"><mtr><mtd><mn>0</mn></mtd><mtd><mtext>if</mtext></mtd><mtd><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>&lt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><mo>−</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub></mtd><mtd><mtext>if</mtext></mtd><mtd><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>&gt;</mo><mn>0</mn></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></mtd><mtd></mtd><mtd><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo></mtd></mtr><mtr><mtd><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi></mrow></msub></mrow></mfrac><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mtd><mtd><mi></mi><mo>=</mo></mtd><mtd><mrow><mo>{</mo><mtable columnspacing=\"1em\" rowspacing=\"4pt\"><mtr><mtd><mn>0</mn></mtd><mtd><mtext>if</mtext></mtd><mtd><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>&lt;</mo><mn>0</mn></mtd></mtr><mtr><mtd><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub></mtd><mtd><mtext>if</mtext></mtd><mtd><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>&gt;</mo><mn>0</mn></mtd></mtr></mtable><mo fence=\"true\" stretchy=\"true\" symmetric=\"true\"></mo></mrow></mtd><mtd></mtd><mtd><mtext> </mtext><mtext> </mtext><mtext> </mtext><mtext> </mtext><mo stretchy=\"false\">(</mo><mn>6</mn><mo stretchy=\"false\">)</mo></mtd></mtr></mtable></math></span></span></span><script id=\"MathJax-Element-88\" type=\"math/tex; mode=display\">\n\\begin{eqnarray}\n\\frac{\\partial }{\\partial \\mathbf{w}_{y_n}}\\max(0, 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n) &=& \n\\left\\{\n\\begin{matrix}\n0 & \\text{if}& 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n < 0 \\newline\n-\\mathbf{x}_n & \\text{if} &1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n > 0\n\\end{matrix}\n\\right. && ~~~~(5)\\newline\n\\frac{\\partial }{\\partial \\mathbf{w}_{j}}\\max(0, 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n) &=& \n\\left\\{\n\\begin{matrix}\n0 & \\text{if}& 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n < 0 \\newline\n\\mathbf{x}_n & \\text{if} &1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n > 0\n\\end{matrix}\n\\right. && ~~~~(6)\n\\end{eqnarray}\n</script></p><p>Rõ ràng là các đạo hàm này không xác định tại các điểm mà <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-89-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1570\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1571\"><span class=\"mjx-mn\" id=\"MJXc-Node-1572\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1573\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1574\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1575\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1576\"><span class=\"mjx-mi\" id=\"MJXc-Node-1577\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1583\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1578\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1579\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1580\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1581\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1582\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1584\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1585\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1586\"><span class=\"mjx-mi\" id=\"MJXc-Node-1587\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1588\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1589\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1590\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1591\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1592\"><span class=\"mjx-mi\" id=\"MJXc-Node-1593\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1595\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1594\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1596\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1597\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1598\"><span class=\"mjx-mi\" id=\"MJXc-Node-1599\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1600\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1601\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn MJXc-space3\" id=\"MJXc-Node-1602\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>=</mo><mn>0</mn></math></span></span><script id=\"MathJax-Element-89\" type=\"math/tex\">1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n = 0</script>. Tuy nhiên, khi thực hành, ta có thể giả sử rằng tại 0, các đạo hàm này cũng bằng 0.</p><p>Để kiểm tra lại cách tính đạo hàm như trên dựa vào <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-90-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1603\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1604\"><span class=\"mjx-mo\" id=\"MJXc-Node-1605\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1606\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">5</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1607\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-90\" type=\"math/tex\">(5)</script> và <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-91-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1608\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1609\"><span class=\"mjx-mo\" id=\"MJXc-Node-1610\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1611\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">6</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1612\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>6</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-91\" type=\"math/tex\">(6)</script> có chính xác không, chúng ta sẽ làm một bước quen thuộc là so sánh nó với <a href=\"https://machinelearningcoban.com/2017/01/12/gradientdescent/#kiem-tra-dao-ham\"><em>numerical gradient</em></a>. Nếu sự sai khác là nhỏ, nhỏ hơn <code class=\"language-plaintext highlighter-rouge\">1e-7</code> thì ta có thể coi là <em>gradient</em> tính được là chính xác:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">f</span> <span class=\"o\">=</span> <span class=\"k\">lambda</span> <span class=\"n\">W</span><span class=\"p\">:</span> <span class=\"n\">svm_loss_naive</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"p\">.</span><span class=\"mi\">1</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n\n<span class=\"c1\"># for checking if calculated grad is correct\n</span><span class=\"k\">def</span> <span class=\"nf\">numerical_grad_general</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">f</span><span class=\"p\">):</span>\n    <span class=\"n\">eps</span> <span class=\"o\">=</span> <span class=\"mf\">1e-6</span>\n    <span class=\"n\">g</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">)</span>\n    <span class=\"c1\"># flatening variable -&gt; 1d. Then we need \n</span>    <span class=\"c1\"># only one for loop\n</span>    <span class=\"n\">W_flattened</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">flatten</span><span class=\"p\">()</span>\n    <span class=\"n\">g_flattened</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"n\">W_flattened</span><span class=\"p\">)</span>\n    \n    <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">xrange</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">size</span><span class=\"p\">):</span>\n        <span class=\"n\">W_p</span> <span class=\"o\">=</span> <span class=\"n\">W_flattened</span><span class=\"p\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n        <span class=\"n\">W_n</span> <span class=\"o\">=</span> <span class=\"n\">W_flattened</span><span class=\"p\">.</span><span class=\"n\">copy</span><span class=\"p\">()</span>\n        <span class=\"n\">W_p</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">+=</span> <span class=\"n\">eps</span> \n        <span class=\"n\">W_n</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">-=</span> <span class=\"n\">eps</span> \n        \n        <span class=\"c1\"># back to shape of W \n</span>        <span class=\"n\">W_p</span> <span class=\"o\">=</span> <span class=\"n\">W_p</span><span class=\"p\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n        <span class=\"n\">W_n</span> <span class=\"o\">=</span> <span class=\"n\">W_n</span><span class=\"p\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n        <span class=\"n\">g_flattened</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">f</span><span class=\"p\">(</span><span class=\"n\">W_p</span><span class=\"p\">)</span> <span class=\"o\">-</span> <span class=\"n\">f</span><span class=\"p\">(</span><span class=\"n\">W_n</span><span class=\"p\">))</span><span class=\"o\">/</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"o\">*</span><span class=\"n\">eps</span><span class=\"p\">)</span>\n        \n    <span class=\"c1\"># convert back to original shape\n</span>    <span class=\"k\">return</span> <span class=\"n\">g_flattened</span><span class=\"p\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span> \n\n<span class=\"c1\"># compare two ways of computing gradient\n</span><span class=\"n\">g1</span> <span class=\"o\">=</span> <span class=\"n\">svm_loss_naive</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"p\">.</span><span class=\"mi\">1</span><span class=\"p\">)[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n<span class=\"n\">g2</span> <span class=\"o\">=</span> <span class=\"n\">numerical_grad_general</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">f</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"s\">'gradient difference: %f'</span> <span class=\"o\">%</span><span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">linalg</span><span class=\"p\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">g1</span> <span class=\"o\">-</span> <span class=\"n\">g2</span><span class=\"p\">)</span> \n<span class=\"c1\"># this should be very small\n</span></code></pre></div></div><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>gradient difference: 0.000000\n</code></pre></div></div><p>Sự sai khác là xấp xỉ 0, vậy chúng ta có thể yên tâm khi nói rằng cách tính <em>gradient</em> đã thỏa mãn sự <em>chính xác</em>, chúng ta cần tính nó một cách <em>hiệu quả</em> nữa.</p><p>Các cách tính hiệu quả thường không chứa các vòng <code class=\"language-plaintext highlighter-rouge\">for</code> mà được viết gọn lại dưới dạng ma trận và vector, việc này đòi hỏi các kỹ năng về Đại số tuyến tính và <code class=\"language-plaintext highlighter-rouge\">numpy</code> một chút. Cách tính này thường được gọi là <em>vectorized</em>.</p><p><a name=\"-tinh-ham-mat-mat-va-dao-ham-cua-no-bang-cach-vectorized\"></a></p><h3 id=\"32-tính-hàm-mất-mát-và-đạo-hàm-của-nó-bằng-cách-vectorized\">3.2. Tính hàm mất mát và đạo hàm của nó bằng cách <em>vectorized</em></h3><p>Để giúp các bạn dễ hình dung hơn, tôi đã chuẩn bị Hình dưới đây:</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/vectorized_loss.png\" width=\"800\"/>\n<div align=\"justify\" class=\"thecap\">Hình 7: Mô phỏng cách tính <em>loss</em> và <em>gradient</em> của Multi-class SVM.</div>\n</div><hr/><p>Ở đây, chúng ta tạm quên phần <em>regularization loss</em> đi vì cả <em>loss</em> và <em>gradient</em> của phần này đều có cách tính đơn giản. Với phần <em>data loss</em>, chúng ta cũng bỏ qua hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mfrac&gt;&lt;/math&gt;' id=\"MathJax-Element-92-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1613\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1614\"><span class=\"mjx-mfrac\" id=\"MJXc-Node-1615\"><span class=\"mjx-box MJXc-stacked\" style=\"width: 0.769em; padding: 0px 0.12em;\"><span class=\"mjx-numerator\" style=\"font-size: 70.7%; width: 1.088em; top: -1.301em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1616\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span><span class=\"mjx-denominator\" style=\"font-size: 70.7%; width: 1.088em; bottom: -0.611em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1617\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.27em; padding-right: 0.085em;\">N</span></span></span><span class=\"mjx-line\" style=\"border-bottom: 1.3px solid; top: -0.283em; width: 0.769em;\"></span></span><span class=\"mjx-vsize\" style=\"height: 1.352em; vertical-align: -0.432em;\"></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mfrac><mn>1</mn><mi>N</mi></mfrac></math></span></span><script id=\"MathJax-Element-92\" type=\"math/tex\">\\frac{1}{N}</script> đi cho dễ hình dung.</p><p>Giả sử rằng có 4 classes và mini-batch gồm có 3 điểm dữ liệu <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-93-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1618\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1619\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1620\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1621\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1622\"><span class=\"mjx-mi\" id=\"MJXc-Node-1623\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1624\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1625\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1626\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1627\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1628\"><span class=\"mjx-mi\" id=\"MJXc-Node-1629\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1630\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1631\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1632\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1633\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1634\"><span class=\"mjx-mi\" id=\"MJXc-Node-1635\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1636\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>1</mn></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>2</mn></msub><mo>,</mo><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>3</mn></msub></math></span></span><script id=\"MathJax-Element-93\" type=\"math/tex\">\\mathbf{x}_1, \\mathbf{x}_2, \\mathbf{x}_3</script>. 3 điểm này lần lượt thuộc vào các class 1, 3, 2. Các ô có nền màu đỏ nhạt ở mỗi cột tương ứng với <em>correct class</em> của điểm dữ liệu của cột đó. Các bước tính <em>loss</em> và <em>gradient</em> có thể được hình dung như sau:</p><ul>\n<li>\n<p><strong>Bước 1:</strong> Tính <em>score matrix</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-94-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1637\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1638\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1639\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1640\"><span class=\"mjx-mi\" id=\"MJXc-Node-1641\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">Z</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1642\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-msubsup MJXc-space3\" id=\"MJXc-Node-1643\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1644\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1645\"><span class=\"mjx-mi\" id=\"MJXc-Node-1646\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.619em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1647\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1648\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1649\"><span class=\"mjx-mi\" id=\"MJXc-Node-1650\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">Z</mi></mrow><mo>=</mo><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow></math></span></span><script id=\"MathJax-Element-94\" type=\"math/tex\">\\mathbf{Z} = \\mathbf{W}^T\\mathbf{X}</script>.</p>\n</li>\n<li>\n<p><strong>Bước 2:</strong> Với mỗi ô, tính <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-95-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1651\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1652\"><span class=\"mjx-mo\" id=\"MJXc-Node-1653\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1654\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1655\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1656\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1657\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1658\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1659\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1660\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1661\"><span class=\"mjx-mi\" id=\"MJXc-Node-1662\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1668\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1663\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1664\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1665\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1666\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1667\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1669\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1670\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1671\"><span class=\"mjx-mi\" id=\"MJXc-Node-1672\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1673\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1674\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1675\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1676\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1677\"><span class=\"mjx-mi\" id=\"MJXc-Node-1678\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1680\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1679\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1681\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1682\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1683\"><span class=\"mjx-mi\" id=\"MJXc-Node-1684\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1685\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1686\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>j</mi><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-95\" type=\"math/tex\">\\max(0, 1 - \\mathbf{w}_{y_n}^T \\mathbf{x}_n + \\mathbf{w}_j^T\\mathbf{x}_n)</script>. Chú ý rằng ta không cần tính các ô có nền màu đỏ nhạt vì có thể coi chúng bằng 0 do trong biểu thức <em>data loss</em>. Sau khi tính được giá trị của từng ô, ta chỉ quan tâm tới các ô có giá trị lớn hơn 0 - là các ô được tô nền màu xanh lục. Lấy tổng của tất cả các phần tử ở các ô xanh lục, ta sẽ được <em>data loss</em>. (<em>Có thể bạn sẽ phải dừng lại một chút để hiểu. Không sao, take your time</em>).</p>\n</li>\n<li>\n<p><strong>Bước 3:</strong> Theo công thức <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-96-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1687\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1688\"><span class=\"mjx-mo\" id=\"MJXc-Node-1689\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1690\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">6</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1691\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>6</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-96\" type=\"math/tex\">(6)</script>, với ô màu xanh lục ở hàng 2, cột 1, thì đạo hàm theo vector hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-97-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1692\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1693\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1694\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1695\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1696\"><span class=\"mjx-mi\" id=\"MJXc-Node-1697\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1698\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>2</mn></msub></math></span></span><script id=\"MathJax-Element-97\" type=\"math/tex\">\\mathbf{w}_2</script> sẽ được cộng thêm một lượng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-98-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1699\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1700\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1701\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1702\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1703\"><span class=\"mjx-mi\" id=\"MJXc-Node-1704\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1705\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-98\" type=\"math/tex\">\\mathbf{x}_1</script> và đạo hàm theo vector hệ số <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-99-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1706\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1707\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1708\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1709\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1710\"><span class=\"mjx-mi\" id=\"MJXc-Node-1711\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1712\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-99\" type=\"math/tex\">\\mathbf{w}_1</script> sẽ được trừ đi một lượng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-100-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1713\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1714\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1715\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1716\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1717\"><span class=\"mjx-mi\" id=\"MJXc-Node-1718\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1719\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-100\" type=\"math/tex\">\\mathbf{x}_1</script>. Tương tự với các ô màu xanh lục còn lại. Với các ô màu đỏ ở hàng 1 cột 1, chúng ta chú ý rằng trong cùng cột 1, có bao nhiêu ô màu xanh lục thì có bấy nhiêu lần đạo hàm của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-101-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1720\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1721\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1722\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1723\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1724\"><span class=\"mjx-mi\" id=\"MJXc-Node-1725\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1726\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-101\" type=\"math/tex\">\\mathbf{w}_1</script> bị trừ đi một lượng <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-102-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1727\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1728\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1729\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1730\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1731\"><span class=\"mjx-mi\" id=\"MJXc-Node-1732\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mn\" id=\"MJXc-Node-1733\" style=\"\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mn>1</mn></msub></math></span></span><script id=\"MathJax-Element-102\" type=\"math/tex\">\\mathbf{x}_1</script>. Điều này được suy ra từ <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-103-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1734\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1735\"><span class=\"mjx-mo\" id=\"MJXc-Node-1736\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1737\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">5</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1738\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo stretchy=\"false\">(</mo><mn>5</mn><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-103\" type=\"math/tex\">(5)</script>. Từ đó suy ra trong khối ô vuông thứ 3, giá trị của ô màu đỏ sẽ bằng đối số của tổng số lượng các ô màu xanh lục. Vậy nên ô màu đỏ ở hàng 1 cột 1 phải bằng -2.</p>\n</li>\n<li>\n<p><strong>Bước 4:</strong> Bây giờ cộng theo các hàng, ta sẽ được đạo hàm theo hệ số của class tương ứng.</p>\n</li>\n</ul><p>Trong đoạn code dưới đây, <code class=\"language-plaintext highlighter-rouge\">correct_class_score</code> chính là tập hợp các giá trị trong các ô màu đỏ ở khối thứ nhất.</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># more efficient way to compute loss and grad\n</span><span class=\"k\">def</span> <span class=\"nf\">svm_loss_vectorized</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">):</span>\n    <span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">shape</span> \n    <span class=\"n\">_</span><span class=\"p\">,</span> <span class=\"n\">N</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span> \n    <span class=\"n\">loss</span> <span class=\"o\">=</span> <span class=\"mi\">0</span> \n    <span class=\"n\">dW</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">)</span>\n    \n    <span class=\"n\">Z</span> <span class=\"o\">=</span> <span class=\"n\">W</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">)</span>     \n    \n    <span class=\"n\">correct_class_score</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">choose</span><span class=\"p\">(</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">Z</span><span class=\"p\">).</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">N</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"n\">T</span>     \n    <span class=\"n\">margins</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">maximum</span><span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">Z</span> <span class=\"o\">-</span> <span class=\"n\">correct_class_score</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">)</span> \n    <span class=\"n\">margins</span><span class=\"p\">[</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"n\">margins</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n    <span class=\"n\">loss</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">margins</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">))</span>\n    <span class=\"n\">loss</span> <span class=\"o\">/=</span> <span class=\"n\">N</span> \n    <span class=\"n\">loss</span> <span class=\"o\">+=</span> <span class=\"mf\">0.5</span> <span class=\"o\">*</span> <span class=\"n\">reg</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"n\">W</span> <span class=\"o\">*</span> <span class=\"n\">W</span><span class=\"p\">)</span>\n    \n    <span class=\"n\">F</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"n\">margins</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">).</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n    <span class=\"n\">F</span><span class=\"p\">[</span><span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"n\">F</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">])]</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"nb\">sum</span><span class=\"p\">(</span><span class=\"o\">-</span><span class=\"n\">F</span><span class=\"p\">,</span> <span class=\"n\">axis</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n    <span class=\"n\">dW</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">dot</span><span class=\"p\">(</span><span class=\"n\">F</span><span class=\"p\">.</span><span class=\"n\">T</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"n\">N</span> <span class=\"o\">+</span> <span class=\"n\">reg</span><span class=\"o\">*</span><span class=\"n\">W</span>\n    <span class=\"k\">return</span> <span class=\"n\">loss</span><span class=\"p\">,</span> <span class=\"n\">dW</span>\n</code></pre></div></div><p>Sau khi đã viết đoạn code mà chúng ta <em>cho rằng</em> đã hiệu quả (không còn vòng <code class=\"language-plaintext highlighter-rouge\">for</code> nào) này, chúng ta cần phải kiểm chứng hai điều:</p><ol>\n<li>Quy trình 4 bước tôi nêu ở trên có chính xác không. Việc này được kiểm chứng bằng cách so sánh đạo hàm này với đạo hàm nhận được bằng cách tính <em>naive</em>.</li>\n<li>Cách tính thứ hai này liệu có thực sự <em>hiệu quả</em>, tức có nhanh hơn cách <em>naive</em> nhiều không.</li>\n</ol><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">N</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"mi\">49000</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">3073</span>\n<span class=\"n\">reg</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">1</span> \n<span class=\"n\">W</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randint</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"n\">size</span> <span class=\"o\">=</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">time</span> \n<span class=\"n\">t1</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n<span class=\"n\">l1</span><span class=\"p\">,</span> <span class=\"n\">dW1</span> <span class=\"o\">=</span> <span class=\"n\">svm_loss_naive</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">)</span>\n<span class=\"n\">t2</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n<span class=\"k\">print</span> <span class=\"s\">'Naive     : run time:'</span><span class=\"p\">,</span> <span class=\"n\">t2</span> <span class=\"o\">-</span> <span class=\"n\">t1</span><span class=\"p\">,</span> <span class=\"s\">'(s)'</span>\n\n<span class=\"n\">t1</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n<span class=\"n\">l2</span><span class=\"p\">,</span> <span class=\"n\">dW2</span> <span class=\"o\">=</span> <span class=\"n\">svm_loss_vectorized</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">)</span>\n<span class=\"n\">t2</span> <span class=\"o\">=</span> <span class=\"n\">time</span><span class=\"p\">.</span><span class=\"n\">time</span><span class=\"p\">()</span>\n<span class=\"k\">print</span> <span class=\"s\">'Vectorized: run time:'</span><span class=\"p\">,</span> <span class=\"n\">t2</span> <span class=\"o\">-</span> <span class=\"n\">t1</span><span class=\"p\">,</span> <span class=\"s\">'(s)'</span>\n<span class=\"k\">print</span> <span class=\"s\">'loss difference:'</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">linalg</span><span class=\"p\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">l1</span> <span class=\"o\">-</span> <span class=\"n\">l2</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"s\">'gradient difference:'</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">linalg</span><span class=\"p\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">dW1</span> <span class=\"o\">-</span> <span class=\"n\">dW2</span><span class=\"p\">)</span>\n</code></pre></div></div><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Naive     : run time: 34.326472044 (s)\nVectorized: run time: 0.267823934555 (s)\nloss difference: 3.63797880709e-12\ngradient difference: 2.70855454684e-14\n</code></pre></div></div><p>Kết quả nhận được cho chúng ta thấy rằng cách tính bằng <em>vectorized</em> nhanh hơn rất nhiều (khoảng 120 lần) so với cách tính <em>naive</em>. Hơn nữa, sự chênh lệch giữa kết quả của hai cách tính là rất nhỏ, đều nhỏ hơn <code class=\"language-plaintext highlighter-rouge\">1e-10</code> (tức <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-104-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1739\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1740\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1741\"><span class=\"mjx-base\"><span class=\"mjx-mn\" id=\"MJXc-Node-1742\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">10</span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.591em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1743\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1744\"><span class=\"mjx-mo\" id=\"MJXc-Node-1745\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1746\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">10</span></span></span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1747\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mn>10</mn><mrow class=\"MJX-TeXAtom-ORD\"><mo>−</mo><mn>10</mn></mrow></msup><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-104\" type=\"math/tex\">10^{-10})</script>. Vậy thì chúng ta có thể <em>yên tâm</em> sử dụng cách <em>vectorized</em> này để cập nhật nghiệm.</p><p><a name=\"-gradient-descent-cho-multi-class-svm\"></a></p><h3 id=\"33-gradient-descent-cho-multi-class-svm\">3.3. Gradient Descent cho Multi-class SVM</h3><p>Mọi việc giờ thật là đơn giản, giống như mọi phương pháp giải bằng Gradient Descent tôi đã nêu trước đây:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># Mini-batch gradient descent\n</span><span class=\"k\">def</span> <span class=\"nf\">multiclass_svm_GD</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">Winit</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">,</span> <span class=\"n\">lr</span><span class=\"o\">=</span><span class=\"p\">.</span><span class=\"mi\">1</span><span class=\"p\">,</span> \\\n        <span class=\"n\">batch_size</span> <span class=\"o\">=</span> <span class=\"mi\">100</span><span class=\"p\">,</span> <span class=\"n\">num_iters</span> <span class=\"o\">=</span> <span class=\"mi\">1000</span><span class=\"p\">,</span> <span class=\"n\">print_every</span> <span class=\"o\">=</span> <span class=\"mi\">100</span><span class=\"p\">):</span>\n    <span class=\"n\">W</span> <span class=\"o\">=</span> <span class=\"n\">Winit</span> \n    <span class=\"n\">loss_history</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">zeros</span><span class=\"p\">((</span><span class=\"n\">num_iters</span><span class=\"p\">))</span>\n    <span class=\"k\">for</span> <span class=\"n\">it</span> <span class=\"ow\">in</span> <span class=\"nb\">xrange</span><span class=\"p\">(</span><span class=\"n\">num_iters</span><span class=\"p\">):</span>\n        <span class=\"c1\"># randomly pick a batch of X\n</span>        <span class=\"n\">idx</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">choice</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">],</span> <span class=\"n\">batch_size</span><span class=\"p\">)</span>\n        <span class=\"n\">X_batch</span> <span class=\"o\">=</span> <span class=\"n\">X</span><span class=\"p\">[:,</span> <span class=\"n\">idx</span><span class=\"p\">]</span>\n        <span class=\"n\">y_batch</span> <span class=\"o\">=</span> <span class=\"n\">y</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span>\n\n        <span class=\"n\">loss_history</span><span class=\"p\">[</span><span class=\"n\">it</span><span class=\"p\">],</span> <span class=\"n\">dW</span> <span class=\"o\">=</span> \\\n            <span class=\"n\">svm_loss_vectorized</span><span class=\"p\">(</span><span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">X_batch</span><span class=\"p\">,</span> <span class=\"n\">y_batch</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">)</span>\n\n        <span class=\"n\">W</span> <span class=\"o\">-=</span> <span class=\"n\">lr</span><span class=\"o\">*</span><span class=\"n\">dW</span> \n        <span class=\"k\">if</span> <span class=\"n\">it</span> <span class=\"o\">%</span> <span class=\"n\">print_every</span> <span class=\"o\">==</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n            <span class=\"k\">print</span> <span class=\"s\">'it %d/%d, loss = %f'</span> \\\n                <span class=\"o\">%</span><span class=\"p\">(</span><span class=\"n\">it</span><span class=\"p\">,</span> <span class=\"n\">num_iters</span><span class=\"p\">,</span> <span class=\"n\">loss_history</span><span class=\"p\">[</span><span class=\"n\">it</span><span class=\"p\">])</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">loss_history</span> \n\n<span class=\"n\">N</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"n\">d</span> <span class=\"o\">=</span> <span class=\"mi\">49000</span><span class=\"p\">,</span> <span class=\"mi\">10</span><span class=\"p\">,</span> <span class=\"mi\">3073</span>\n<span class=\"n\">reg</span> <span class=\"o\">=</span> <span class=\"p\">.</span><span class=\"mi\">1</span> \n<span class=\"n\">W</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">C</span><span class=\"p\">)</span>\n<span class=\"n\">X</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randn</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n<span class=\"n\">y</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"p\">.</span><span class=\"n\">random</span><span class=\"p\">.</span><span class=\"n\">randint</span><span class=\"p\">(</span><span class=\"n\">C</span><span class=\"p\">,</span> <span class=\"n\">size</span> <span class=\"o\">=</span> <span class=\"n\">N</span><span class=\"p\">)</span>\n\n<span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">loss_history</span> <span class=\"o\">=</span> <span class=\"n\">multiclass_svm_GD</span><span class=\"p\">(</span><span class=\"n\">X</span><span class=\"p\">,</span> <span class=\"n\">y</span><span class=\"p\">,</span> <span class=\"n\">W</span><span class=\"p\">,</span> <span class=\"n\">reg</span><span class=\"p\">)</span>\n</code></pre></div></div><div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>it 1/1000, loss = 1802.750975\nit 101/1000, loss = 251.495825\nit 201/1000, loss = 62.021015\nit 301/1000, loss = 45.626031\nit 401/1000, loss = 38.334262\nit 501/1000, loss = 43.666638\nit 601/1000, loss = 45.649841\nit 701/1000, loss = 35.401936\nit 801/1000, loss = 36.211475\nit 901/1000, loss = 41.676211\n</code></pre></div></div><p>Chúng ta thử <em>visisualize</em> giá trị của <em>loss</em> sau mỗi vòng lặp:</p><div class=\"language-python highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"kn\">import</span> <span class=\"nn\">matplotlib.pyplot</span> <span class=\"k\">as</span> <span class=\"n\">plt</span>\n<span class=\"c1\"># plot loss as a function of iteration\n</span><span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">loss_history</span><span class=\"p\">)</span>\n<span class=\"n\">plt</span><span class=\"p\">.</span><span class=\"n\">show</span><span class=\"p\">()</span>\n</code></pre></div></div><hr/><div>\n<table style=\"border: 0px solid white\" width=\"100%\">\n<tbody><tr>\n<td align=\"center\" style=\"border: 0px solid white\" width=\"40%\">\n<img src=\"./ex11_files/loss_history.png\" style=\"display:block;\" width=\"100%\"/>\n</td>\n<td align=\"justify\" style=\"border: 0px solid white\" width=\"40%\">\n        Hình 8: <em>Lịch sử loss</em> qua các vòng lặp. Ta thấy rằng <em>loss</em> có xu hướng giảm và hội tụ.\n        </td>\n</tr>\n</tbody></table>\n</div><hr/><p>Từ <em>lịch sử loss</em> này ta thấy rằng giá trị của <em>loss</em> sau mỗi vòng lặp có xu hướng giảm và hội tụ, đây chính là điều mà chúng ta mong muốn.</p><p>Phần code còn lại để giải quyết bài toán phân loại cho cơ sở dữ liệu CIFAR-10 có thể tìm thấy trong <a href=\"https://github.com/tiepvupsu/CS231n_2016/blob/master/assignment1/svm.ipynb\">ipython notebook này</a></p><p>(<em>đây chính là lời giải của tôi cho Assignment #1 của CS231n, WInter 2016, Stanford.</em>)</p><p>Kết quả đạt được cho CIFAR-10 là khoảng 40%. Như thế là đã rất tốt với một bài toán khó với 10 classes như thế này, nhất là khi chúng ta chưa phải làm thêm bước feature engineering phức tạp nào. Kết quả của Softmax Regression là khoảng 35%, các bạn cũng có thể tìm thấy <a href=\"https://github.com/tiepvupsu/CS231n_2016/blob/master/assignment1/softmax.ipynb\">tại đây</a>.</p><p><strong>Chú ý:</strong> Trong các bài tập này, dữ liệu được tính toán theo dạng hàng, tức mỗi hàng của <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-105-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1748\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1749\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1750\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1751\"><span class=\"mjx-mi\" id=\"MJXc-Node-1752\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi></mrow></math></span></span><script id=\"MathJax-Element-105\" type=\"math/tex\">\\mathbf{X}</script> là một điểm dữ liệu. Khi đó, <em>score</em> được tính theo công thức: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;Z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;X&lt;/mi&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-106-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1753\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1754\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1755\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1756\"><span class=\"mjx-mi\" id=\"MJXc-Node-1757\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">Z</span></span></span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1758\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-texatom MJXc-space3\" id=\"MJXc-Node-1759\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1760\"><span class=\"mjx-mi\" id=\"MJXc-Node-1761\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">X</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1762\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">Z</mi></mrow><mo>=</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">X</mi><mi mathvariant=\"bold\">W</mi></mrow></math></span></span><script id=\"MathJax-Element-106\" type=\"math/tex\">\\mathbf{Z} = \\mathbf{XW}</script>. Các phép biến đổi có khác một chút so với trường hợp dữ liệu ở dạng cột. Hy vọng các bạn không gặp khó khăn nhiều.</p><p><a name=\"-minh-hoa-nghiem-tim-duoc\"></a></p><h3 id=\"34-minh-họa-nghiệm-tìm-được\">3.4. Minh họa nghiệm tìm được</h3><p>Để ý rằng mỗi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-107-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1763\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1764\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1765\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1766\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1767\"><span class=\"mjx-mi\" id=\"MJXc-Node-1768\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1769\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-107\" type=\"math/tex\">\\mathbf{w}_i</script> có chiều giống như chiều của dữ liệu, trong trường hợp này, chúng là các bức ảnh. Bằng cách <em>sắp xếp</em> lại các điểm trong mỗi trong 10 vector hệ số tìm được, chúng ta sẽ thu được <em>bức ảnh</em> cũng có kích thước <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mn&gt;32&lt;/mn&gt;&lt;/math&gt;' id=\"MathJax-Element-108-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1770\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1771\"><span class=\"mjx-mn\" id=\"MJXc-Node-1772\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">3</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1773\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-1774\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1775\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.216em; padding-bottom: 0.323em;\">×</span></span><span class=\"mjx-mn MJXc-space2\" id=\"MJXc-Node-1776\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">32</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mn>3</mn><mo>×</mo><mn>32</mn><mo>×</mo><mn>32</mn></math></span></span><script id=\"MathJax-Element-108\" type=\"math/tex\">3\\times 32\\times32</script> như mỗi ảnh nhỏ trong cơ sở dữ liệu. Dưới đây là hình thù của mỗi <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;' id=\"MathJax-Element-109-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1777\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1778\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1779\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1780\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1781\"><span class=\"mjx-mi\" id=\"MJXc-Node-1782\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1783\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>i</mi></msub></math></span></span><script id=\"MathJax-Element-109\" type=\"math/tex\">\\mathbf{w}_i</script>:</p><hr/><div class=\"imgcap\">\n<img align=\"center\" src=\"./ex11_files/learned_ws_2.png\" width=\"800\"/>\n<div align=\"justify\" class=\"thecap\">Hình 9: Minh họa hệ số tìm được dưới dạng các bức ảnh.</div>\n</div><hr/><p>Từ đây chúng ta sẽ thấy một điều thú vị.</p><p>Hệ số tương ứng với mỗi class đều mang những tính chất giống với các bức ảnh trong class đó, ví dụ như <em>car</em> và <em>truck</em> trông khá giống với các bức ảnh trong class <em>car</em> và <em>truck</em>. Hệ số của <em>ship</em> và <em>plane</em> có mang màu xanh của nước biển và bầu trời. Trong khi <em>horse</em> trông giống như 1 con ngựa 2 đầu; điều này dễ hiểu vì trong tập training, các con ngựa có thể quay đầu về hai phía. Có thể nói theo một cách khác rằng các hệ số tìm được được coi như là các <em>ảnh đại diện</em> cho mỗi class. Vì sao chúng ta có thể nói như vậy?</p><p>Nếu chúng ta cùng xem lại cách xác định class cho một dữ liệu mới được thực hiện bằng cách tìm vị trí của giá trị lớn nhất trong <em>score vector</em> <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;W&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-110-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1784\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1785\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1786\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1787\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1788\"><span class=\"mjx-mi\" id=\"MJXc-Node-1789\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">W</span></span></span></span></span><span class=\"mjx-sup\" style=\"font-size: 70.7%; vertical-align: 0.619em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1790\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1791\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1792\"><span class=\"mjx-mi\" id=\"MJXc-Node-1793\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">W</mi></mrow><mi>T</mi></msup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span><script id=\"MathJax-Element-110\" type=\"math/tex\">\\mathbf{W}^T\\mathbf{x}</script>, tức:</p><p><span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MJXc-display\" style=\"text-align: center;\"><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"&gt;&lt;mtext&gt;class&lt;/mtext&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;arg&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;' id=\"MathJax-Element-111-Frame\" role=\"presentation\" style=\"font-size: 117%; text-align: center; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1794\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1795\"><span class=\"mjx-mtext\" id=\"MJXc-Node-1796\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.377em;\">class</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1797\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1798\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1799\"><span class=\"mjx-mi\" id=\"MJXc-Node-1800\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1801\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span><span class=\"mjx-mo MJXc-space3\" id=\"MJXc-Node-1802\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mi MJXc-space3\" id=\"MJXc-Node-1803\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.537em;\">arg</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1804\"><span class=\"mjx-char\"></span></span><span class=\"mjx-munderover MJXc-space1\" id=\"MJXc-Node-1805\"><span class=\"mjx-itable\"><span class=\"mjx-row\"><span class=\"mjx-cell\"><span class=\"mjx-op\" style=\"padding-left: 0.798em;\"><span class=\"mjx-mo\" id=\"MJXc-Node-1806\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span></span></span></span><span class=\"mjx-row\"><span class=\"mjx-under\" style=\"font-size: 70.7%; padding-top: 0.236em; padding-bottom: 0.141em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1807\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1808\"><span class=\"mjx-mi\" id=\"MJXc-Node-1809\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1810\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.056em; padding-bottom: 0.323em;\">=</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1811\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1812\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1813\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">2</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1814\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1815\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.323em;\">…</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1816\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mi\" id=\"MJXc-Node-1817\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.483em; padding-bottom: 0.323em; padding-right: 0.045em;\">C</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1818\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1819\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1820\"><span class=\"mjx-mi\" id=\"MJXc-Node-1821\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1823\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1822\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em;\">i</span></span></span></span></span><span class=\"mjx-texatom\" id=\"MJXc-Node-1824\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1825\"><span class=\"mjx-mi\" id=\"MJXc-Node-1826\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span></span><span class=\"MJX_Assistive_MathML MJX_Assistive_MathML_Block\" role=\"presentation\"><math display=\"block\" xmlns=\"http://www.w3.org/1998/Math/MathML\"><mtext>class</mtext><mo stretchy=\"false\">(</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mo stretchy=\"false\">)</mo><mo>=</mo><mi>arg</mi><mo>⁡</mo><munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>C</mi></mrow></munder><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mi>i</mi><mi>T</mi></msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow></math></span></span></span><script id=\"MathJax-Element-111\" type=\"math/tex; mode=display\">\n\\text{class}(\\mathbf{x}) = \\arg\\max_{i = 1, 2, \\dots, C} \\mathbf{w}_i^T\\mathbf{x}\n</script></p><p>Nếu bạn để ý chút nữa thì tích vô hướng chính là đại lượng đo sự tương quan giữa hai vector. Đại lượng này càng lớn thì sự tương quan càng cao, tức hai vector càng giống nhau. Như vậy, việc đi tìm class của một bức ảnh mới chính là việc đi tìm xem hệ số tìm được nào gần với bức ảnh đó nhất. Nói thêm một cách khác nữa, đây chính là <a href=\"https://machinelearningcoban.com/2017/01/08/knn/\">K-nearest neighbors</a>, nhưng thay vì thực hiện KNN trên toàn bộ training data, chúng ta chỉ thực hiện trên 10 <em>bức ảnh</em> đại diện tìm được bằng Multi-class SVM (hoặc Softmax Regression). Chính vì vậy, hai phương pháp này có thể coi là cách đi tìm mỗi điểm dữ liệu đại diện cho mỗi class!</p><p><a name=\"-thao-luan\"></a></p>"}, "examples": {"title": "<h2 id=\"4-thảo-luận\">4. Thảo luận</h2>", "content": "<ul>\n<li>\n<p><a href=\"https://machinelearningcoban.com/2017/02/17/softmax/#-boundary-tao-boi-softmax-regression-la-linear\">Giống như Softmax Regression</a>,  Multi-class SVM vẫn được coi là một bộ phân lớp tuyến tính vì đường phân chia giữa các class là các đường tuyến tính.</p>\n</li>\n<li>\n<p>Kernel SVM cũng hoạt động khá tốt, nhưng việc tính toán ma trận kernel có thể tốn nhiều thời gian và bộ nhớ. Hơn nữa, việc mở rộng nó ra cho bài toán multi-class classification thường không hiệu quả bằng Multi-class SVM. Một ưu điểm nữa của Multi-class SVM là nó có thể được tối ưu bằng (Stochastic) Gradient Descnet, tức là nó phù hợp với các bài toán large-scale. Việc boundary giữa các class là tuyến tính có thể được giải quyết bằng cách kết hợp nó với Deep Neurel Networks. Bạn đọc có thể so sánh hiệu quả của hai phương pháp này bằng cách giải quyết bài toán CIFAR-10 bằng thư viện sklearn như tôi đã trình bày trong bài trước. Tôi đã thử, Kernel cho kết quả thấp và tốn hơn 1 giờ để huấn luyện, so với vài phút của Multi-class SVM. Có thể tôi chưa lựa chọn các tham số hợp lý, nhưng chắc chắn một điều rằng, Kernel SVM tốn nhiều thời gian huấn luyện hơn.</p>\n</li>\n<li>\n<p>Có một cách nữa mở rộng <em>hinge loss</em> cho bài toán multi-class classification là dùng <em>loss</em>: <span class=\"MathJax_Preview\" style=\"color: inherit; display: none;\"></span><span class=\"mjx-chtml MathJax_CHTML\" data-mathml='&lt;math xmlns=\"http://www.w3.org/1998/Math/MathML\"&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mo stretchy=\"false\"&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;munder&gt;&lt;mo movablelimits=\"true\" form=\"prefix\"&gt;max&lt;/mo&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msubsup&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=\"MJX-TeXAtom-ORD\"&gt;&lt;mi mathvariant=\"bold\"&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=\"false\"&gt;)&lt;/mo&gt;&lt;/math&gt;' id=\"MathJax-Element-112-Frame\" role=\"presentation\" style=\"font-size: 117%; position: relative;\" tabindex=\"0\"><span aria-hidden=\"true\" class=\"mjx-math\" id=\"MJXc-Node-1827\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1828\"><span class=\"mjx-mo\" id=\"MJXc-Node-1829\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1830\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">(</span></span><span class=\"mjx-mn\" id=\"MJXc-Node-1831\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.377em;\">0</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1832\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"margin-top: -0.158em; padding-bottom: 0.537em;\">,</span></span><span class=\"mjx-mn MJXc-space1\" id=\"MJXc-Node-1833\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.377em; padding-bottom: 0.323em;\">1</span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1834\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">−</span></span><span class=\"mjx-msubsup MJXc-space2\" id=\"MJXc-Node-1835\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1836\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1837\"><span class=\"mjx-mi\" id=\"MJXc-Node-1838\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.157em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1844\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1839\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1840\"><span class=\"mjx-msubsup\" id=\"MJXc-Node-1841\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1842\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1843\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1845\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1846\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1847\"><span class=\"mjx-mi\" id=\"MJXc-Node-1848\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1849\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo MJXc-space2\" id=\"MJXc-Node-1850\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.323em; padding-bottom: 0.43em;\">+</span></span><span class=\"mjx-munderover MJXc-space2\" id=\"MJXc-Node-1851\"><span class=\"mjx-base\"><span class=\"mjx-mo\" id=\"MJXc-Node-1852\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.163em; padding-bottom: 0.377em;\">max</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.241em; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1853\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1854\"><span class=\"mjx-mi\" id=\"MJXc-Node-1855\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1856\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.43em; padding-bottom: 0.537em;\">≠</span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1857\"><span class=\"mjx-base\" style=\"margin-right: -0.006em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1858\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.483em; padding-right: 0.006em;\">y</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1859\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span></span></span></span></span><span class=\"mjx-msubsup MJXc-space1\" id=\"MJXc-Node-1860\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1861\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1862\"><span class=\"mjx-mi\" id=\"MJXc-Node-1863\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">w</span></span></span></span></span><span class=\"mjx-stack\" style=\"vertical-align: -0.311em;\"><span class=\"mjx-sup\" style=\"font-size: 70.7%; padding-bottom: 0.255em; padding-left: 0px; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1867\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.27em; padding-right: 0.12em;\">T</span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; padding-right: 0.071em;\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1864\" style=\"\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1865\"><span class=\"mjx-mi\" id=\"MJXc-Node-1866\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.43em; padding-bottom: 0.483em;\">j</span></span></span></span></span></span></span><span class=\"mjx-msubsup\" id=\"MJXc-Node-1868\"><span class=\"mjx-base\"><span class=\"mjx-texatom\" id=\"MJXc-Node-1869\"><span class=\"mjx-mrow\" id=\"MJXc-Node-1870\"><span class=\"mjx-mi\" id=\"MJXc-Node-1871\"><span class=\"mjx-char MJXc-TeX-main-B\" style=\"padding-top: 0.11em; padding-bottom: 0.377em;\">x</span></span></span></span></span><span class=\"mjx-sub\" style=\"font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;\"><span class=\"mjx-mi\" id=\"MJXc-Node-1872\" style=\"\"><span class=\"mjx-char MJXc-TeX-math-I\" style=\"padding-top: 0.216em; padding-bottom: 0.27em;\">n</span></span></span></span><span class=\"mjx-mo\" id=\"MJXc-Node-1873\"><span class=\"mjx-char MJXc-TeX-main-R\" style=\"padding-top: 0.483em; padding-bottom: 0.59em;\">)</span></span></span></span><span class=\"MJX_Assistive_MathML\" role=\"presentation\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><mo form=\"prefix\" movablelimits=\"true\">max</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>−</mo><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><msub><mi>y</mi><mi>n</mi></msub></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo>+</mo><munder><mo form=\"prefix\" movablelimits=\"true\">max</mo><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi><mo>≠</mo><msub><mi>y</mi><mi>n</mi></msub></mrow></munder><msubsup><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">w</mi></mrow><mrow class=\"MJX-TeXAtom-ORD\"><mi>j</mi></mrow><mi>T</mi></msubsup><msub><mrow class=\"MJX-TeXAtom-ORD\"><mi mathvariant=\"bold\">x</mi></mrow><mi>n</mi></msub><mo stretchy=\"false\">)</mo></math></span></span><script id=\"MathJax-Element-112\" type=\"math/tex\">\\max(0, 1 - \\mathbf{w}_{y_n}^T\\mathbf{x}_n + \\max_{j \\neq y_n}\\mathbf{w}_{j}^T\\mathbf{x}_n)</script>. Đây chính là <em>vi phạm lớn nhất</em>, so với <em>tổng vi pham</em> mà chúng ta sử dụng trong bài này.</p>\n</li>\n<li>\n<p>Trên thực tế, <a href=\"http://cs231n.github.io/linear-classify/#svmvssoftmax\"><strong>Multi-class SVM và Softmax Regression có hiệu quả tương đương nhau</strong></a>. Có thể trong một bài toán cụ thể, phương pháp này tốt hơn phương pháp kia, nhưng điều ngược lại xảy ra trong các bài toán khác.</p>\n</li>\n</ul><p><a name=\"-tai-lieu-tham-khao\"></a></p>"}}